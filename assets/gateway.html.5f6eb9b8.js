import{_ as e}from"./_plugin-vue_export-helper.cdc0426e.js";import{o as a,c as t,f as i}from"./app.4d667c68.js";const r="/assets/0629e33aeb9e472aaa824ab4f7befc38.cf15f80f.png",n={},l=i(`<h1 id="gateway" tabindex="-1"><a class="header-anchor" href="#gateway" aria-hidden="true">#</a> gateway</h1><h2 id="\u57FA\u672C\u539F\u7406" tabindex="-1"><a class="header-anchor" href="#\u57FA\u672C\u539F\u7406" aria-hidden="true">#</a> \u57FA\u672C\u539F\u7406</h2><h3 id="gateway\u542F\u52A8\u65F6" tabindex="-1"><a class="header-anchor" href="#gateway\u542F\u52A8\u65F6" aria-hidden="true">#</a> Gateway\u542F\u52A8\u65F6\uFF0C</h3><ol><li>spring\u4F1A\u626B\u63CF\u5230GatewayAutoConfiguration\u81EA\u52A8\u914D\u7F6E\u7C7B\uFF0C\u52A0\u8F7D\u5FC5\u8981\u7684bean\u7EC4\u4EF6\uFF1A <ul><li>GatewayProperties</li><li>RouteDefinitionLocator-&gt;\u83B7\u53D6RouteDefinition</li><li>RouteLocator-&gt;\u83B7\u53D6route\u5BF9\u8C61</li><li>GlobalFilter</li><li>RoutePredicateHandlerMapping</li><li>org.springframework.cloud.gateway.handler.FilteringWebHandler</li></ul></li><li>\u542F\u52A8Netty Server\uFF0C \u8D1F\u8D23\u76D1\u542C\u8BF7\u6C42</li></ol><h3 id="gateway\u63A5\u53D7\u8BF7\u6C42\u65F6" tabindex="-1"><a class="header-anchor" href="#gateway\u63A5\u53D7\u8BF7\u6C42\u65F6" aria-hidden="true">#</a> gateway\u63A5\u53D7\u8BF7\u6C42\u65F6:</h3><ol><li>\u5BA2\u6237\u7AEF\u53D1\u9001\u8BF7\u6C42\u5230nettyServer</li><li>nettyServer\u5C06\u8BF7\u6C42\u4EA4\u7ED9ReactiveHttpHandleApply\u5904\u7406</li><li>ReactiveHttpHandleApply\u7ECF\u8FC7\u4E00\u7CFB\u5217\u7684\u5904\u7406(DelayedInitializationHttpHandler-&gt;HttpWebHandlerAdapter-&gt;ExceptionHandlingWebHandler)\u5C06\u8BF7\u6C42\u4EA4\u7ED9FilteringWebHandler(webFlux\u4E2D\u7684\u5904\u7406\u7C7B)</li><li>FilteringWebHandler\u6784\u5EFA\u8FC7\u6EE4\u5668\u94FEDefaultWebFilterChain\u8FDB\u884C\u8FC7\u6EE4\u5668\u5904\u7406\uFF0C\u6700\u540E\u5C06\u8BF7\u6C42\u4EA4\u7ED9DispatcherHandler\u5904\u7406</li><li>DispatcherHandler\u5148\u901A\u8FC7AbstractHandlerMapping(\u6269\u5C55\u5B9E\u73B0\u7C7B\u662FRoutePredicateHandlerMapping)\u83B7\u53D6\u5230FilteringWebHandler(gateway\u63D0\u4F9B\u7684\u5B9E\u73B0\u7C7B)</li><li>FilteringWebHandler\u6784\u5EFA\u7F51\u5173\u8FC7\u6EE4\u5668\u94FEDefaultGatewayFilterChain\u8FDB\u884C\u8FC7\u6EE4\u5668\u5904\u7406</li></ol><h3 id="filter" tabindex="-1"><a class="header-anchor" href="#filter" aria-hidden="true">#</a> Filter</h3><p>DefaultGatewayFilterChain\u6709\u4E24\u7C7B\uFF1A1\u3001\u5C40\u90E8\u8FC7\u6EE4\u5668 2\u3001\u5168\u5C40\u8FC7\u6EE4\u5668\uFF0C\u90FD\u53EF\u4EE5\u81EA\u5B9A\u4E49</p><p>\u5C40\u90E8\u8FC7\u6EE4\u5668\u5E94\u7528\u5728\u5177\u4F53\u7684Route\u4E2D\uFF0C\u7F51\u5173\u4E5F\u63D0\u4F9B\u4E86\u5185\u7F6E\u7684\u8FC7\u6EE4\u5668</p><p>\u5168\u5C40\u8FC7\u6EE4\u5668\u7684\u5E94\u7528\u5728\u6240\u6709\u8DEF\u7531\u5BF9\u8C61\u4E2D\uFF0C\u90E8\u5206\u5185\u7F6E\u7684globalFilter\u662F\u5FC5\u987B\u4F7F\u7528\u7684</p><p>\u6700\u540E\u6240\u6709\u7684Filter\u5C06\u6309\u7167Order\u4F18\u5148\u7EA7\u8FDB\u884C\u6392\u5E8F\uFF0C\u6309\u987A\u5E8F\u6267\u884C</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public Mono&lt;Void&gt; handle(ServerWebExchange exchange) {
		Route route = exchange.getRequiredAttribute(GATEWAY_ROUTE_ATTR);
		List&lt;GatewayFilter&gt; gatewayFilters = route.getFilters();

		List&lt;GatewayFilter&gt; combined = new ArrayList&lt;&gt;(this.globalFilters);
		combined.addAll(gatewayFilters);
		// TODO: needed or cached?
		AnnotationAwareOrderComparator.sort(combined);

		if (logger.isDebugEnabled()) {
			logger.debug(&quot;Sorted gatewayFilterFactories: &quot; + combined);
		}

		return new DefaultGatewayFilterChain(combined).filter(exchange);
	}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0B\u9762\u662FGateway\u5185\u7F6E\u7684\u5168\u5C40\u8FC7\u6EE4\u5668\uFF0C\u5DF2\u7ECF\u5728\u6240\u6709\u8DEF\u7531\u751F\u6548 <img src="`+r+'" alt=""></p><h3 id="routedefinitionlocator" tabindex="-1"><a class="header-anchor" href="#routedefinitionlocator" aria-hidden="true">#</a> RouteDefinitionLocator</h3><p>\u8BFB\u53D6xml\u914D\u7F6E\u6587\u4EF6\uFF0C\u6784\u5EFA\u8DEF\u7531\u5B9A\u4E49\u5BF9\u8C61RouteDefinition</p><h3 id="routelocator" tabindex="-1"><a class="header-anchor" href="#routelocator" aria-hidden="true">#</a> RouteLocator</h3><p>\u6839\u636ERouteDefinition\uFF0C\u6784\u5EFARoute\u5BF9\u8C61</p>',17),d=[l];function o(s,c){return a(),t("div",null,d)}const g=e(n,[["render",o],["__file","gateway.html.vue"]]);export{g as default};
