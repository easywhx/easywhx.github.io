import{_ as e}from"./_plugin-vue_export-helper.cdc0426e.js";import{o,c,a as n,b as s,d as t,f as p,r as l}from"./app.4d667c68.js";const i="/assets/4112b3c1.6d50ed3f.png",u="/assets/8da0ed71.7bf88aa2.png",r="/assets/d34c94c7.c0c12793.png",d="/assets/0bc3ebcd.6c630f46.png",k="/assets/3787b61a.9fadfbb8.png",m="/assets/265896b3.34b648f0.png",v="/assets/bcbe62ac.a6f3caf7.png",g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwUAAAC4CAIAAAA9u9cYAAAPPUlEQVR4Xu3dsW7jSJoHcL+CMI/gdEK9g6PDbeb0cJeMXsHRJB00/AAt4DY3MMFmegJnC+zCgKIdwJ3vQu+gq1OhazlFiaJtUv4o/n5oGBJZpAsUvuK/i6R8swcAmLebegEAwMzIQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3E0mD/3222/1IgBgIoKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg5/Gx8tBvI6h/BwAwEfVJfQj17/iAsfIQAMBUyEMAwNzJQwDA3MlDAMDcTT4P7Xa79PP+/n61WtXrGr5+/Xp3wu3tbd36YLFYvL6+lrdPT08PDw/pxWazSb/u3+1+eH5+Xi6X9dIf0laph7m3AEAoE8tDOaC8vLyk8JEjzs3NTXqbokZ6mxaeyhxfD+qlB2kP9aKDannZQ/otORhV0vLUn/I2tcl5K4WkFK3Si9zDxhYAQAjHo0BYKQ+lbLE8uL293Ww2Of2UsJLyUFrVjkQfyUPpRZ5GSnK+yS+y0r7KQ+n1er1OWa0sOev7Qb0UABjZ8SgQXxU+mnEnzxWVVVla0gwxTWfzUFZ+Rb7y1VyV91PmgZIUg9LPt84G/eWgXgoAjOx4FIivIw8d1dGgyj1pzzk55WmhFHGaazvkC2Tl7dk8tNvtvn371pzKkocA4FNMKQ+VpFJNxtw1LmYV1S3P/fNQttlsmsuPzi2t1+vGFv/fJnXp6ekpv707dLLZPjUol89yGNput//eXh4CgE9yJApczP++RbVtNT/UfNt8KKz4+sbrZavVKi0v18XuGr8rqwJW6kC+sSn9lhyJ0ib5ZqbcIAWgMtV0NAzt5SEA+CRHosDFtFPOKe2WzQCU4kXKQLeHx+bT65RjNpvNH1q/UdpJ2lvOQzkSVRHq7jDZ08xDaUm+Xvby8pI2TP1Jr/MkU74i1nxKP4WhX0+QhwDg8mLlob/97e//9d//k35Wy9stnw9f9vP09HT347rVYrFIySNllOaVso5poUq+tlW2yvNDaYf5Af6yqmjOD+ULeSWi5Qmq/PVFafPcvfSiXErbbrePj4/t+SEA4FMEykP//Ne/Uhj6j//8U/r5j99/b65qtkwhI8egFDhS1ChXx1IMSm9TLjl6vayputZWyY/0p5/N62jNe5Wy5vxQvm2oumaXr47lqFSmrwqRCADiCJSH9odIlPJQFYb2jZYp9KRgkXJPjkTNNmlJSjDVPc7F8+GrGnNU6s5D5auuj95XlK+FVQvbu80zTPl12mHzPusiRyJfOAQAn+7IKf9iSsppBqCUh8rrFI/yi9KyPJ3ezjT5CtfziUfcHx4eSkDJ9z6XmZ7lclk9epZ/S85DaVXzMbH8EH7RvDZXupRvnS49Sb+6eWt2kzAEABF8fh7K9wyVSFTyUL58lu8las8kVfdT50mdzWZTnucqs0G5QX74q71th/b80P1BdeWrKLtNbcr+V4dHzFJP0s+0vPltQwBAEPUp/5Jyysn3DJ36l9aWllmKFCl5rNfrnDmenp7yjUR5bcofd4cHu8rD7fvDHM/d4en3nEjel4dystkf5nuOJpu827Q2336UOpaSU2mZQ9vRC2cAwOf6/DyU54fKpbGz80P5Tuf8cFl6nbJO9TfC8vWpcgksB6Y8V5RW5YzSzkMvB80lOQ+lDfNt2vlBs7wq7Tzts/rVOQ/tDg//50fS2jczpSXtIAUAfK7Pz0P7xn1C+3P3D73V6+F7gJqp5fXwDHz+eqFKdYvPzSEP5ZTTvi0pLzfZAwBXIEQeKv7x++8pDzXjUdZuCQAwlEB5KIWh8v1DVSSShwCA8QTKQ/u3fD81AMBQYuWhU/q3BAB4q0/OQ/3VGwMADOQz89Cb1A+DAQDTUZ/Xg4nevyL+oQQ+Qo3DFYtf4NH7V8Q/lMBHqHG4YvELPHr/iviHEvgINQ5XLH6BR+9fEf9QAh+hxuGKxS/w6P0rhjqUaT/V3ykDIhikxhU4xDRIgY8qev+Ks4cy/5XWttvb22azs/s5a7fb/fUHf5wVhtJdmwocJu1UbTYrrl53Wcf7F9CpQ9m2Wq3af1g+DZp5aOvez2azyX+4vl7RsN1uvx18+fLl0z8/uBrdtVm8u8BTXec/5Jx+dtS4AocxnKrNZsXV6y7reP8COnUo29Jg154wL5uf2k8aTFcHy+WyY6xsSp+f4RKGcqo2K+8r8FTUqbRfX1/T67R5et0OVRUFDgM6VZtFqrh60WWd6V8cZw9llka61LLMpS8Wi7z87HCZBsenp6f0Im3VzkMpLaWPqpo8N1zCgE7VZtO7CzylqM1mU96m12nz8laBw9iatXmq4ppvL+/42BHQqWGucn9/n2NN1h4lz+6nnYfyJ7fdbpsL94ZLGNTZ2twPUeDZ8/NzyUMKHC6g1GZHxVVLLqzX2BFBn2Eu/Z9vuVyWt6+vr/3/+1hUeejUJ7c3XMKgztbmIAWePRzsFThcSq7N7oqrF11Wr7EjgrPDXBor840F6b+PeRauOSXef7is8lD6hH49zXAJQ+muzaEKfH+46JaCVN6JAofLyLXZXXH1Npd1fuwIonuYy/9TLDcApf9EpsEu/f+vJJv+w2WVh1KMfXx8PBpmgQF11OaABZ7CUPOObAUOl5FrM3LFnRk74jg7zDXvzMqPiTVHvf7DZfv+ocifH1yN7tocpMCfn5/bj6cpcLiAUpthK65r7Aile5hry4+flLc9h8v9sTy0//H5ff/+vVoODOVsbTa9o8BTGFosFu1n9fcKHMbXrM2YFXdy7IimY5hry7PrafgrS9r3GZxyNA8l0T45uDJna7N4R4GnTdozQ00KHEZV1WbAijs+dgR0aphr2+12y+UyPzzSdnY/p/IQMKqztZm9r8BTXZ/9AkZgPKdqM47o/St6Hsp8f8BqtapX/HBqP2m4vGmpGwGj6VNx7y7wurYP6kbAaOJXXPT+FWcPZX74NjU7+h/H19fX1ODp6ensfoBP0V2bChwmLX5tRu9fcfZQpqEwDZfNWwqadrvdzeHvOJozh5i6a1yBw6R1F3gE0ftXxD+UwEeocbhi8Qs8ev+K+IcS+Ag1DlcsfoFH718R/1ACH6HG4YrFL/Do/SviH0rgI9Q4XLH4BR69f0X8Qwl8hBqHKxa/wKP3r7gBACarPq8HE71/RfxDCXyEGocrFr/Ao/eviH8ogY9Q43DF4hd49P4V8Q8l8BFqHK5Y/AKP3r8i/qEEPkKNwxWLX+DR+1f0P5SbzWa1Wu12u3oFEFj/GgcmJ36BR+9f0fNQphi0WCzW63V68fXr19vb27s/6rmfDmnPf/1B6oKhvKk2lSFMy6kCb9Zyve6yjvcvoFOHsikd1uVyuVqt6hW9bTabFKdSkKpXNGy3228HX758+fTPD65GnxovlCFMy6kCb9Zyve6yjvcvoFOHsnh5eflIGEpZanWQdtKdh4r0+RmIYShna/woZQiTcLbAUy3Xiy7rTP/iOHsoU4hZr9f5dXrx/Pz8x/VnpE2enp7Si7u7u3YeSmkpfVTVtLyBGAZ0tsaVIUxXs8BP1XLz7eWdGYDiODtWFq+vr4vFYrPZ1Cv6aeeh/Mltt9vmwr2BGAbVXePKECatFHhHLVdLLqxrAAqle6xsSoFmvV6nSFTdSV3c3t62Z4CKuz/moVOf3N5ADIPqqHFlCFOXC7y7lutFl3VyAIqmY6xsyjcA1UsPnp+fU9apl7ZUeSh9Qr+eZiCGoXTUuDKEqcsF3l3L9TaXdXIAiqZjrCxSjsnTQvWKg/floRRjHx8fj4ZZYEAdNa4MYepygUeu5ZMDUDQdY2V2f3+/XC43m82p0PO+PLSP/fnB1eiucWUIk1YKPGwtdw1AoXSPlftD3Nntdh2hp2NVUzsP7X98ft+/f6+WA0M5W+PKEKarWeAxa/nMABTH2bEy6wg9HauajuahJNonB1emT40rQ5ioqsAD1vL5ASiIPmPlvjP0dKxqOpWHgFH1rHFgiuIXePT+FT0PZUfo6Vi1P8Sgm5a6ETAaFQdXLH6BR+9f0fNQHg09zwfr9frdf80DGFvPGgemKH6BR+9f0fNQptzT/v6hh4eHxWJxf3//8vJSrQKC6FnjwBTFL/Do/SviH0rgI9Q4XLH4BR69f0X8Qwl8hBqHKxa/wKP3r4h/KIGPUONwxeIXePT+FfEPJfARahyuWPwCj96/4gYAmKz6vB5M9P4BAFfgz29Rbzy+KeWh+OkSADiqf8rp33JAU0oY8hAATFT/lNO/5YCmlDDkIQCYqP4pp3/LAU0pYchDADBR/VNO/5YDmlLCkIcAYKL6p5z+LQc0pYRxKg99P6iXAgBh9E85/VsO6HjCiOlUHvrLQb0UAAijf8rp33JAxxNGTDkP7Xa7b9++pZ9luTwEAMH1Tzn9Ww5oYnkoh6HtdttcLg8BQHD9U07/lgOaUh766aef2mFoLw8BQHj9U07/lgOaUh765Zdffj1BHgKAyPqnnP4tBzSlPPTzzz8/Pj6254cAgOD6p5z+LQc0pTx0c3OTwpBIBACT0z/l9G85oInlofQzRyJfOAQAE/Lnt6g3Ht/08tD+8AWMf1wDAPB+k8xDAAADmlLCkIcAgDFMKWHIQwDAGKaUMOQhAGAMU0oY8hAAMIYpJQx5CAAYw5QShjwEAIxhSglDHgIAxiBhAABzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBz93+bZb9AsQ33lwAAAABJRU5ErkJggg==",b="/assets/f8312906.e27f61c3.png",f="/assets/413a28e3.f257ea89.png",x="/assets/b88b4b92.7717729f.png",y="/assets/57c0f2b9.46f5cea9.png",w="/assets/35a9a182.f4ea9dfb.png",h="/assets/05c4738c.1b3e5c77.png",q="/assets/d0939ac9.5078855b.png",F="/assets/3e91e1f5.c46f2471.png",I="/assets/a4d254ac.0308787b.png",P="/assets/ac53524c.5842a0ec.png",A="/assets/e9ad4479.55d0e0d3.png",S="/assets/7113c146.b1eb1051.png",D="/assets/00f7537d.3d264aeb.png",M="/assets/4b306ed3.d7a906d4.png",j="/assets/ccf93266.80317597.png",T="/assets/779aceb2.44432080.png",C="/assets/17553719.a1096c62.png",E="/assets/7be8de9e.a99023f3.png",L="/assets/e3d9b961.493d9c28.png",W="/assets/992873fe.097f08b8.png",H="/assets/de3a5407.fb0b51db.png",R="/assets/93e2db3f.b3c81302.png",X="/assets/ab3bee0d.23769e55.png",O="/assets/0f9c4618.3d88c1e8.png",_="/assets/6df8b41c.481675a0.png",B="/assets/da12427e.9d165b1e.png",N="/assets/c7756d0c.37ac0e1e.png",z="/assets/d8537bb3.9f45231a.png",U="/assets/8711d414.94bafaf6.png",J="/assets/bd56e760.db8a8d32.png",Q="/assets/c9fa7e24.a8347be1.png",K="/assets/6a2c9661.e3612376.png",V={},G=n("h1",{id:"\u751F\u6210word",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u751F\u6210word","aria-hidden":"true"},"#"),s(" \u751F\u6210word")],-1),Z=n("h3",{id:"\u65B9\u68481-\u5229\u7528html\u683C\u5F0F\u7684\u6A21\u677F\u5B9E\u73B0",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u65B9\u68481-\u5229\u7528html\u683C\u5F0F\u7684\u6A21\u677F\u5B9E\u73B0","aria-hidden":"true"},"#"),s(" \u65B9\u68481. \u5229\u7528html\u683C\u5F0F\u7684\u6A21\u677F\u5B9E\u73B0")],-1),Y=n("ol",null,[n("li",null,"\u521B\u5EFAword\u6A21\u677F\uFF0C\u53E6\u5B58\u4E3Ahtml\u683C\u5F0F\u7684\u6587\u4EF6"),n("li",null,"\u8BBE\u7F6Eftl\u6A21\u677F\u7684\u6307\u4EE4\uFF0C\u4FDD\u5B58\u4E3Afreemarker\u683C\u5F0F\u7684\u6587\u4EF6"),n("li",null,"\u5229\u7528\u6A21\u677F\u5F15\u64CE\u8FDB\u884C\u6570\u636E\u586B\u5145\u6E32\u67D3\uFF0C\u8FD4\u56DE\u6587\u4EF6\u6D41"),n("li",null,"\u5C06\u586B\u5145\u597D\u6570\u636E\u7684html\u683C\u5F0F\u7684\u6587\u4EF6\u6D41\u5904\u7406\u8F6C\u6362\u4E3Aword\u6587\u4EF6")],-1),$={href:"https://blog.csdn.net/gaojie_csdn/article/details/122244262",target:"_blank",rel:"noopener noreferrer"},nn=p(`<h4 id="\u5B9E\u73B0\u65B9\u5F0F1-\u4F7F\u7528apache-poi\u7684poifs-api\u6765\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0\u65B9\u5F0F1-\u4F7F\u7528apache-poi\u7684poifs-api\u6765\u5B9E\u73B0" aria-hidden="true">#</a> \u5B9E\u73B0\u65B9\u5F0F1 \u4F7F\u7528Apache POI\u7684POIFS API\u6765\u5B9E\u73B0\uFF1A</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>common<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">Template</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">StringEscapeUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>poifs<span class="token punctuation">.</span>filesystem<span class="token punctuation">.</span></span><span class="token class-name">DirectoryEntry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>poifs<span class="token punctuation">.</span>filesystem<span class="token punctuation">.</span></span><span class="token class-name">POIFSFileSystem</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ClassPathResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HtmlUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordUtils</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * html\u5B57\u7B26\u4E32\u751F\u6210word
     * <span class="token keyword">@param</span> <span class="token parameter">content</span> html\u5B57\u7B26\u4E32
     * <span class="token keyword">@param</span> <span class="token parameter">filePath</span> \u751F\u6210\u6587\u4EF6\u7684\u8DEF\u5F84
     * <span class="token keyword">@param</span> <span class="token parameter">fileName</span> \u6587\u4EF6\u540D\u79F0
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span> filePath<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ClassPathResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u8F93\u51FA\u6587\u4EF6</span>
            <span class="token class-name">String</span> dir <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fileAbsolutePath <span class="token operator">=</span> dir <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> fileName <span class="token operator">+</span> <span class="token string">&quot;_&quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileAbsolutePath<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                fileAbsolutePath <span class="token operator">+=</span> <span class="token string">&quot;.docx&quot;</span><span class="token punctuation">;</span>
            <span class="token class-name">File</span> outFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>fileAbsolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u5982\u679C\u8F93\u51FA\u76EE\u6807\u6587\u4EF6\u5939\u4E0D\u5B58\u5728\uFF0C\u5219\u521B\u5EFA</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>outFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                outFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            content <span class="token operator">=</span> <span class="token class-name">HtmlUtils</span><span class="token punctuation">.</span><span class="token function">htmlUnescape</span><span class="token punctuation">(</span><span class="token class-name">StringEscapeUtils</span><span class="token punctuation">.</span><span class="token function">unescapeHtml</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u683C\u5F0F\u5316html</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> by <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteArrayInputStream</span> byteArrayInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">POIFSFileSystem</span> poifsFileSystem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">POIFSFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">DirectoryEntry</span> directory <span class="token operator">=</span> poifsFileSystem<span class="token punctuation">.</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            directory<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token string">&quot;WordDocument&quot;</span><span class="token punctuation">,</span> byteArrayInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fileAbsolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            poifsFileSystem<span class="token punctuation">.</span><span class="token function">writeFilesystem</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            byteArrayInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> fileAbsolutePath<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u751F\u6210html\u5B57\u7B26\u4E32
     * <span class="token keyword">@param</span> <span class="token parameter">dataMap</span> \u6570\u636E\u96C6
     * <span class="token keyword">@param</span> <span class="token parameter">templateName</span> \u6A21\u677F\u540D\u79F0
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createHtml</span><span class="token punctuation">(</span><span class="token class-name">Map</span> dataMap<span class="token punctuation">,</span> <span class="token class-name">String</span> templatePath<span class="token punctuation">,</span> <span class="token class-name">String</span> templateName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TemplateException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>templateName<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.ftl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                templateName <span class="token operator">+=</span> <span class="token string">&quot;.ftl&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">//\u521B\u5EFA\u914D\u7F6E\u5B9E\u4F8B </span>
            <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u8BBE\u7F6E\u7F16\u7801</span>
            configuration<span class="token punctuation">.</span><span class="token function">setDefaultEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            configuration<span class="token punctuation">.</span><span class="token function">setClassForTemplateLoading</span><span class="token punctuation">(</span><span class="token class-name">WordUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> templatePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u83B7\u53D6\u6A21\u677F </span>
            <span class="token class-name">Template</span> template <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>templateName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u5C06\u6A21\u677F\u548C\u6570\u636E\u6A21\u578B\u5408\u5E76\u751F\u6210\u6587\u4EF6</span>
            <span class="token class-name">StringWriter</span> stringWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//\u751F\u6210html</span>
            template<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> stringWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> stringWriter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> ie<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TemplateException</span> te<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> te<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span> dataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u540D\u79F0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> dataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span> dataItem1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7B2C\u4E00\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;13&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span> dataItem2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7B2C\u4E8C\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;21&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;22&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;23&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span> dataItem3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u7B2C\u4E09\u884C&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;31&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;32&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;33&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;dataList&quot;</span><span class="token punctuation">,</span> dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> html <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            html <span class="token operator">=</span> <span class="token function">createHtml</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> <span class="token string">&quot;/word-templates&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test.ftl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">createWord</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">&quot;/word-templates&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5B9E\u73B0\u65B9\u5F0F2-docx4j\u5B9E\u73B0html\u8F6Cword" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0\u65B9\u5F0F2-docx4j\u5B9E\u73B0html\u8F6Cword" aria-hidden="true">#</a> \u5B9E\u73B0\u65B9\u5F0F2\uFF1Adocx4j\u5B9E\u73B0html\u8F6Cword</h4><p><strong>\u53C2\u8003\u4EE3\u78011\uFF1A</strong></p><p>\u5728pom.xml\u91CC\uFF0C\u6DFB\u52A0docx4j\u7684maven\u4F9D\u8D56</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-JAXB-ReferenceImpl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-ImportXHTML<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>bind<span class="token punctuation">.</span></span><span class="token class-name">JAXBException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>in<span class="token punctuation">.</span>xhtml<span class="token punctuation">.</span></span><span class="token class-name">XHTMLImporterImpl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>jaxb<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">Docx4JException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>packages<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingMLPackage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">DocumentSettingsPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">FooterPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">HeaderPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">MainDocumentPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">NumberingDefinitionsPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>relationships<span class="token punctuation">.</span></span><span class="token class-name">Relationship</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">CTCompat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">FldChar</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">FooterReference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Ftr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Hdr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">HdrFtrRef</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">HeaderReference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Jc</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">JcEnumeration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">ObjectFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">P</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">PPr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">STFldCharType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">SectPr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Text</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Html2DocxService</span> <span class="token punctuation">{</span>

    <span class="token comment">// Factory for creating WML Object.</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ObjectFactory</span> factory <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token function">getWmlObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * Convert HTML to DOCX(OPENXML).
     * 
     * <span class="token keyword">@param</span> <span class="token parameter">html</span> the source, a HTML file
     * <span class="token keyword">@param</span> <span class="token parameter">docx</span> the target, a DOCX file
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">File</span> html<span class="token punctuation">,</span> <span class="token class-name">File</span> docx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Creates a WordprocessingMLPackage, using default page size and orientation,</span>
            <span class="token comment">// default to A4 portrait.</span>
            <span class="token class-name">WordprocessingMLPackage</span> pack <span class="token operator">=</span> <span class="token class-name">WordprocessingMLPackage</span><span class="token punctuation">.</span><span class="token function">createPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">NumberingDefinitionsPart</span> numDefPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NumberingDefinitionsPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pack<span class="token punctuation">.</span><span class="token function">getMainDocumentPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>numDefPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            numDefPart<span class="token punctuation">.</span><span class="token function">unmarshalDefaultNumbering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Convert XHTML + CSS to WordML content.</span>
            <span class="token comment">// XHTML must be well formed XML.</span>
            <span class="token class-name">XHTMLImporterImpl</span> importer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XHTMLImporterImpl</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Convert the well formed XHTML contained in file to a list of WML objects.</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> importer<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">MainDocumentPart</span> mainPart <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">getMainDocumentPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Add all WML objects to MainDocumentPart.</span>
            mainPart<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// create footer</span>
            <span class="token class-name">Ftr</span> footer <span class="token operator">=</span> <span class="token function">createFooterWithPageNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FooterPart</span> footerPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FooterPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerPart<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerPart<span class="token punctuation">.</span><span class="token function">setJaxbElement</span><span class="token punctuation">(</span>footer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Relationship</span> footerRelation <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>footerPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FooterReference</span> footerRef <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFooterReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerRef<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>footerRelation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerRef<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">HdrFtrRef</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SectPr</span> sectPr <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">getDocumentModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSectPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sectPr<span class="token punctuation">.</span><span class="token function">getEGHdrFtrReferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>footerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// create header</span>
            <span class="token class-name">Hdr</span> header <span class="token operator">=</span> <span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token string">&quot;\u5317\u4EAC****\u79D1\u6280\u6709\u9650\u516C\u53F8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HeaderPart</span> headerPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HeaderPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerPart<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerPart<span class="token punctuation">.</span><span class="token function">setJaxbElement</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Relationship</span> headerRelation <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>headerPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HeaderReference</span> headerRef <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createHeaderReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerRef<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>headerRelation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerRef<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">HdrFtrRef</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sectPr<span class="token punctuation">.</span><span class="token function">getEGHdrFtrReferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>headerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// set compatibilityMode to 15</span>
            <span class="token comment">// to avoid Word 365/2016 saying &quot;Compatibility Mode&quot;</span>
            <span class="token class-name">DocumentSettingsPart</span> settingsPart <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">getDocumentSettingsPart</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CTCompat</span> compat <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token function">getWmlObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createCTCompat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            compat<span class="token punctuation">.</span><span class="token function">setCompatSetting</span><span class="token punctuation">(</span><span class="token string">&quot;compatibilityMode&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://schemas.microsoft.com/office/word&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            settingsPart<span class="token punctuation">.</span><span class="token function">getContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCompat</span><span class="token punctuation">(</span>compat<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// save to a file</span>
            pack<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>docx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Docx4JException</span> <span class="token operator">|</span> <span class="token class-name">JAXBException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token string">&quot;covert html to docx error.&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// create a header</span>
    <span class="token keyword">private</span> <span class="token class-name">Hdr</span> <span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Hdr</span> header <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createHdr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">P</span> paragraph <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PPr</span> ppr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createPPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jc</span> jc <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createJc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jc<span class="token punctuation">.</span><span class="token function">setVal</span><span class="token punctuation">(</span><span class="token class-name">JcEnumeration</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ppr<span class="token punctuation">.</span><span class="token function">setJc</span><span class="token punctuation">(</span>jc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">setPPr</span><span class="token punctuation">(</span>ppr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Text</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
        header<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> header<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// create a header with page number</span>
    <span class="token keyword">private</span> <span class="token class-name">Ftr</span> <span class="token function">createFooterWithPageNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ftr</span> ftr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">P</span> paragraph <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PPr</span> ppr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createPPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jc</span> jc <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createJc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jc<span class="token punctuation">.</span><span class="token function">setVal</span><span class="token punctuation">(</span><span class="token class-name">JcEnumeration</span><span class="token punctuation">.</span><span class="token constant">RIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ppr<span class="token punctuation">.</span><span class="token function">setJc</span><span class="token punctuation">(</span>jc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">setPPr</span><span class="token punctuation">(</span>ppr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addFieldBegin</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addPageNumberField</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addFieldEnd</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ftr<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ftr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addPageNumberField</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Text</span> txt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        txt<span class="token punctuation">.</span><span class="token function">setSpace</span><span class="token punctuation">(</span><span class="token string">&quot;preserve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        txt<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot; PAGE   \\* ArabicDash &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span><span class="token function">createRInstrText</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFieldBegin</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FldChar</span> fldChar <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFldChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fldChar<span class="token punctuation">.</span><span class="token function">setFldCharType</span><span class="token punctuation">(</span><span class="token class-name">STFldCharType</span><span class="token punctuation">.</span><span class="token constant">BEGIN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fldChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFieldEnd</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FldChar</span> fldChar <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFldChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fldChar<span class="token punctuation">.</span><span class="token function">setFldCharType</span><span class="token punctuation">(</span><span class="token class-name">STFldCharType</span><span class="token punctuation">.</span><span class="token constant">END</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fldChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HTML2DocxException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">436242367279880231L</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">,</span> <span class="token keyword">boolean</span> enableSuppression<span class="token punctuation">,</span>
                <span class="token keyword">boolean</span> writableStackTrace<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">,</span> enableSuppression<span class="token punctuation">,</span> writableStackTrace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6D4B\u8BD5\u4EE3\u7801\uFF1A</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">HTML_FILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;/xxx/test.html&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DOCX_FILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;/xxx/test.docx&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Html2DocxService</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Html2DocxService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        service<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token constant">HTML_FILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token constant">DOCX_FILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F85\u8F6C\u6362\u7684\u793A\u4F8B\u7684HTML\uFF0C\u6CE8\u610F\u8BE5HTML\u4E00\u5B9A\u8981\u6EE1\u8DB3XHTML\u683C\u5F0F\uFF0C\u5373\u6807\u7B7E\u5FC5\u987B\u6B63\u786E\u5D4C\u5957\uFF0C\u4E14\u6807\u7B7E\u5FC5\u987B\u88AB\u5173\u95ED</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Strict//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
&lt;html lang=&quot;zh&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;title&gt;HTML\u8F6CDOCX\u6D4B\u8BD5\u793A\u4F8B&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
h1 {
	text-align: center;
}
table {
	border-collapse: collapse;
	width: 100%;
}
table th {
	text-align: center;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div&gt;
		&lt;h1&gt;HTML\u8F6CDOCX\u6D4B\u8BD5\u793A\u4F8B&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;table border=&quot;1&quot;&gt;
			&lt;tr&gt;
				&lt;th width=&quot;20%&quot;&gt;\u7F16\u53F7\uFF1A&lt;/th&gt;
				&lt;td&gt;E125800&lt;/td&gt;
				&lt;th width=&quot;20%&quot;&gt;\u65E5\u671F\uFF1A&lt;/th&gt;
				&lt;td&gt;2020-01-10&lt;/td&gt;
			&lt;/tr&gt;
			&lt;tr&gt;
				&lt;th width=&quot;20%&quot;&gt;\u5BA1\u6838\uFF1A&lt;/th&gt;
				&lt;td&gt;\u5BA1\u6838\u4EBA&lt;/td&gt;
				&lt;th width=&quot;20%&quot;&gt;\u90E8\u95E8\uFF1A&lt;/th&gt;
				&lt;td&gt;\u6280\u672F\u90E8&lt;/td&gt;
			&lt;/tr&gt;
		&lt;/table&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;\u4EE5\u4E0B\u4E3A\u793A\u4F8B\u5185\u5BB9\u3002&lt;/p&gt;
		&lt;h2&gt;\u9189\u82B1\u9634\xB7\u8584\u96FE\u6D53\u4E91\u6101\u6C38\u663C&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;\u674E\u6E05\u7167&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;\u8584\u96FE\u6D53\u4E91\u6101\u6C38\u663C\uFF0C\u745E\u8111\u9500\u91D1\u517D\u3002\u4F73\u8282\u53C8\u91CD\u9633\uFF0C\u7389\u6795\u7EB1\u53A8\uFF0C\u534A\u591C\u51C9\u521D\u900F\u3002&lt;br /&gt;\u4E1C\u7BF1\u628A\u9152\u9EC4\u660F\u540E\uFF0C\u6709\u6697\u9999\u76C8\u8896\u3002\u83AB\u9053\u4E0D\u9500\u9B42\uFF0C\u5E18\u5377\u897F\u98CE\uFF0C\u4EBA\u6BD4\u9EC4\u82B1\u7626\u3002&lt;/p&gt;
		&lt;h2&gt;\u5FF5\u5974\u5A07\xB7\u8D64\u58C1\u6000\u53E4&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;\u82CF\u8F7C&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;\u5927\u6C5F\u4E1C\u53BB\uFF0C\u6D6A\u6DD8\u5C3D\uFF0C\u5343\u53E4\u98CE\u6D41\u4EBA\u7269\u3002&lt;br /&gt;\u6545\u5792\u897F\u8FB9\uFF0C\u4EBA\u9053\u662F\uFF0C\u4E09\u56FD\u5468\u90CE\u8D64\u58C1\u3002&lt;br /&gt;\u4E71\u77F3\u7A7F\u7A7A\uFF0C\u60CA\u6D9B\u62CD\u5CB8\uFF0C\u5377\u8D77\u5343\u5806\u96EA\u3002&lt;br /&gt;\u6C5F\u5C71\u5982\u753B\uFF0C\u4E00\u65F6\u591A\u5C11\u8C6A\u6770\u3002&lt;br /&gt;\u9065\u60F3\u516C\u747E\u5F53\u5E74\uFF0C\u5C0F\u4E54\u521D\u5AC1\u4E86\uFF0C\u96C4\u59FF\u82F1\u53D1\u3002&lt;br /&gt;\u7FBD\u6247\u7EB6\u5DFE\uFF0C\u8C08\u7B11\u95F4\uFF0C\u6A2F\u6A79\u7070\u98DE\u70DF\u706D\u3002&lt;br /&gt;\u6545\u56FD\u795E\u6E38\uFF0C\u591A\u60C5\u5E94\u7B11\u6211\uFF0C\u65E9\u751F\u534E\u53D1\u3002&lt;br /&gt;\u4EBA\u751F\u5982\u68A6\uFF0C\u4E00\u5C0A\u8FD8\u9179\u6C5F\u6708\u3002&lt;/p&gt;
		&lt;h2&gt;\u767B\u98DE\u6765\u5CF0&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;\u738B\u5B89\u77F3&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;\u98DE\u6765\u5C71\u4E0A\u5343\u5BFB\u5854\uFF0C\u95FB\u8BF4\u9E21\u9E23\u89C1\u65E5\u5347\u3002&lt;br /&gt;\u4E0D\u754F\u6D6E\u4E91\u906E\u671B\u773C\uFF0C\u53EA\u7F18\u8EAB\u5728\u6700\u9AD8\u5C42\u3002&lt;/p&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;\u7F51\u7EDC\u56FE\u7247&lt;/p&gt;
		&lt;img src=&quot;https://www.baidu.com/img/flexible/logo/pc/result.png&quot; alt=&quot;\u767E\u5EA6LOGO&quot; /&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;\u4EE5\u4E0B\u4E3A\u5217\u8868\u3002&lt;/p&gt;
		&lt;p&gt;&lt;strong&gt;\u65E0\u5E8F\u5217\u8868\uFF1A&lt;/strong&gt;&lt;/p&gt;
		&lt;ul&gt;
			&lt;li&gt;\u65E0\u5E8F\u5217\u8868\u9879\u4E00&lt;/li&gt;
			&lt;li&gt;\u65E0\u5E8F\u5217\u8868\u9879\u4E8C&lt;/li&gt;
			&lt;li&gt;\u65E0\u5E8F\u5217\u8868\u9879\u4E09&lt;/li&gt;
			&lt;li&gt;\u65E0\u5E8F\u5217\u8868\u9879\u56DB&lt;/li&gt;
			&lt;li&gt;\u65E0\u5E8F\u5217\u8868\u9879\u4E94&lt;/li&gt;
		&lt;/ul&gt;
		&lt;p&gt;&lt;strong&gt;\u6709\u5E8F\u5217\u8868\uFF1A&lt;/strong&gt;&lt;/p&gt;
		&lt;ol&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E00&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E8C&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E09&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u56DB&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E94&lt;/li&gt;
		&lt;/ol&gt;
		&lt;p&gt;&lt;strong&gt;\u5D4C\u5957\u5217\u8868\uFF1A&lt;/strong&gt;&lt;/p&gt;
		&lt;ol&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E00&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E8C&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E09
				&lt;ol style=&quot;list-style: lower-alpha;&quot;&gt;
					&lt;li&gt;\u5217\u8868\u9879\u4E09\u7684\u5B50\u98791&lt;/li&gt;
					&lt;li&gt;\u5217\u8868\u9879\u4E09\u7684\u5B50\u98792&lt;/li&gt;
					&lt;li&gt;\u5217\u8868\u9879\u4E09\u7684\u5B50\u98793&lt;/li&gt;
					&lt;li&gt;\u5217\u8868\u9879\u4E09\u7684\u5B50\u98794&lt;/li&gt;
					&lt;li&gt;\u5217\u8868\u9879\u4E09\u7684\u5B50\u98795&lt;/li&gt;
				&lt;/ol&gt;
			&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u56DB&lt;/li&gt;
			&lt;li&gt;\u6709\u5E8F\u5217\u8868\u9879\u4E94&lt;/li&gt;
		&lt;/ol&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8F6C\u5316\u540E\u7684Word\u6587\u6863\u5982\u4E0B\uFF1A</p><p><img src="`+i+'" alt=""><img src="'+u+'" alt=""><img src="'+r+`" alt=""></p><p><strong>\u53C2\u8003\u4EE3\u78012\uFF1A</strong></p><p>\u5F15\u5165\u4F9D\u8D56</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-ImportXHTML&lt;/artifactId&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE3\u7801\u5B9E\u73B0\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>StopWatch stopWatch = new StopWatch();
stopWatch.start(&quot;task1&quot;);
WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.createPackage();
MainDocumentPart mdp = wordMLPackage.getMainDocumentPart();
String xhtml = &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;task1&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;\u957F\u5927\u4E0A\u8BFE\u4E86!&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;;
mdp.addAltChunk(AltChunkType.Xhtml, xhtml.getBytes());
WordprocessingMLPackage pkgOut = mdp.convertAltChunks();
XmlUtils.marshaltoString(pkgOut.getMainDocumentPart().getJaxbElement(), true, true)
pkgOut.save(new java.io.File(System.getProperty(&quot;user.dir&quot;) + &quot;/test.docx&quot;));
System.out.println(stopWatch.currentTaskName());
stopWatch.stop();
System.out.println(stopWatch.getLastTaskTimeMillis());
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="\u5B9E\u73B0\u65B9\u5F0F3-\u4F7F\u7528openhtmltopdf\u5F00\u6E90\u6846\u67B6-https-github-com-danfickle-openhtmltopdf" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0\u65B9\u5F0F3-\u4F7F\u7528openhtmltopdf\u5F00\u6E90\u6846\u67B6-https-github-com-danfickle-openhtmltopdf" aria-hidden="true">#</a> \u5B9E\u73B0\u65B9\u5F0F3\uFF1A\u4F7F\u7528openhtmltopdf\u5F00\u6E90\u6846\u67B6\uFF08https://github.com/danfickle/openhtmltopdf\uFF09</h4><p>pom.xml\u5F15\u5165</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- ALWAYS required. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Required for PDF output. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-pdfbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Required for image output only. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-java2d<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need right-to-left or bi-directional text support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-rtl-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need HTML5 parsing support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-jsoup-dom-converter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need logging via slf4j. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need logging via log4j. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need SVG support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-svg-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need MathML support. --&gt;</span>
    <span class="token comment">&lt;!-- Introduced in RC-13. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-mathml-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE3\u7801\u4F7F\u7528</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class OpenHtmlToPDF {
    public static void main(String[] args) {
        try (OutputStream os = new FileOutputStream(&quot;F://pdf//pdfbox//out3.pdf&quot;)) { // \u8F93\u51FA\u7684pdf
            PdfRendererBuilder builder = new PdfRendererBuilder();
            builder.useFastMode();
            //\u4E0B\u9762\u8FD9\u4E2A\u65B9\u6CD5\u662F\u8981\u81EA\u5DF1\u6307\u5B9A \u5B57\u4F53\u6587\u4EF6   \u4E0D\u7136\u8F6C\u51FA\u7684pdf\u6587\u4EF6\u4E2D \u4E2D\u6587\u4F1A\u53D8\u6210####
            builder.useFont(new FSSupplier&lt;InputStream&gt;() {
                @Override
                public InputStream supply() {
                    try {
                        //\u6307\u5B9A \u5B57\u4F53\u6587\u4EF6
                        return new FileInputStream(&quot;F://pdf//pdfbox//simhei.ttf&quot;);
                    } catch (FileNotFoundException e) {
                        e.printStackTrace();
                    }
                    return null;
                }
            }, &quot;simhei&quot;, 400, BaseRendererBuilder.FontStyle.NORMAL, true); //\u7B2C\u4E8C\u4E2A\u53C2\u6570 \u4E00\u5B9A\u8981\u548C\u6587\u4EF6\u540D\u4E00\u6837\uFF01\uFF01\u4F5C\u7528\u5728html\u9875\u9762\u4E0A  
            builder.withHtmlContent(readTxt(&quot;F://pdf//pdfbox//pdf-css3.html&quot;),                              
 
            Surrogate.Generator.class.getResource(&quot;/root.htm&quot;).toExternalForm());
            //\u7B2C\u4E00\u4E2A\u53C2\u6570\u662Fhtml\u9875\u9762  \u7B2C\u4E8C\u4E2A\u53C2\u6570 \u662F\u4E00\u4E2A\u5168\u7A7A\u7684\u6587\u4EF6 \u91CC\u9762\u4EC0\u4E48\u90FD\u6CA1\u6709 \u4F46\u662F\u540E\u7F00\u4E00\u5B9A\u8981\u662F\u3002htm  \u4F5C\u7528\u7C7B\u4F3C\u4E8E\u4E00\u4E2A\u753B\u677F \u5982\u679C\u4E0D\u6DFB\u52A0\u8FD9\u4E2A\u53C2\u6570\u6216\u8005\u7F6E\u4E3Anull \u5219html\u6587\u4EF6\u4E2D\u7684\u56FE\u7247 \u4E0D\u4F1A\u8F6C\u5316 \u6240\u4EE5\u4E00\u5B9A\u9700\u8981\u52A0 
 
 
            builder.toStream(os);
            builder.run();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>html\u9875\u9762\u6CE8\u610F\u4E8B\u9879</p><p>1.\u5173\u4E8E\u5B57\u4F53 \u3002</p><p>\u5982\u679C\u81EA\u5DF1\u6307\u5B9A\u5B57\u4F53\u6587\u4EF6\uFF0C\u90A3\u4E48\u8981\u5728html\u9875\u9762\u4E0A \u52A0\u5165</p><pre><code>&lt;style&gt;
* {
  font-family: &#39;simhei&#39;;   //value\u662F\u6307\u5B9A\u5B57\u4F53\u65F6 \u7B2C\u4E8C\u4E2A\u53C2\u6570
}
&lt;/style&gt;
</code></pre><p>2.\u6807\u7B7E\u4E00\u5B9A\u8981\u6709\u95ED\u5408 \u4E0D\u7136\u4F1A\u89E3\u6790\u5931\u8D25</p><h4 id="\u5B9E\u73B0\u65B9\u5F0F4-\u4F7F\u7528spire-doc-jar" tabindex="-1"><a class="header-anchor" href="#\u5B9E\u73B0\u65B9\u5F0F4-\u4F7F\u7528spire-doc-jar" aria-hidden="true">#</a> \u5B9E\u73B0\u65B9\u5F0F4\uFF1A\u4F7F\u7528Spire.Doc.jar</h4><p>\u5728\u7F16\u8F91\u4EE3\u7801\u524D\uFF0C\u8BF7\u5148\u5728\u7A0B\u5E8F\u4E2D\u5BFC\u5165Spire.Doc.jar\uFF0C\u5BFC\u5165\u65B9\u6CD5\u5982\u4E0B\uFF1A</p><p>\u65B9\u6CD51\uFF1A\u5C06Free Spire.Doc for Java\u5305 \u4E0B\u8F7D \u5230\u672C\u5730\uFF0C\u89E3\u538B\uFF0C\u627E\u5230lib\u6587\u4EF6\u5939\u4E0B\u7684Spire.Doc.jar\u6587\u4EF6\u3002\u7136\u540E\u5728IDEA\u4E2D\u6253\u5F00\u201CProject Structure\u201D\u754C\u9762\uFF0C\u7136\u540E\u6267\u884C\u5982\u56FE\u6B65\u9AA4\u6765\u624B\u52A8\u5BFC\u5165\u672C\u5730\u8DEF\u5F84\u4E0B\u7684jar\u6587\u4EF6\uFF1A</p><p><img src="`+d+`" alt=""></p><p>\u65B9\u6CD52\uFF1A\u901A\u8FC7 Maven\u4ED3\u5E93 \u4E0B\u8F7D\u5BFC\u5165\uFF0C\u5982\u4E0B\u914D\u7F6Epom.xml\uFF1A</p><pre><code>&lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;com.e-iceblue&lt;/id&gt;
            &lt;name&gt;e-iceblue&lt;/name&gt;
            &lt;url&gt;https://repo.e-iceblue.cn/repository/maven-public/&lt;/url&gt;
        &lt;/repository&gt;
&lt;/repositories&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;e-iceblue&lt;/groupId&gt;
        &lt;artifactId&gt;spire.doc.free&lt;/artifactId&gt;
        &lt;version&gt;5.2.0&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><p>\u5B8C\u6210\u5BFC\u5165\u540E\uFF0C\u6267\u884C\u5982\u4E0B\u4EE3\u7801\u6765\u8F6C\u6362\uFF1A</p><p>Java</p><pre><code>import com.spire.doc.*;
import com.spire.doc.documents.XHTMLValidationType;

public class HTMLtoWord {
public static void main(String[] args) {
//\u52A0\u8F7Dhtml\u6587\u4EF6
Document doc = new Document();
doc.loadFromFile(&quot;F:\\\\IDEAProject\\\\Conversion_Doc\\\\\u66B4\u96E8\u907F\u9669\u6307\u5357.html&quot;, FileFormat.Html, XHTMLValidationType.None);

        //\u4FDD\u5B58\u4E3AWord\u683C\u5F0F\u5230\u6307\u5B9A\u8DEF\u5F84
        doc.saveToFile(&quot;htmltoWord.docx&quot;,FileFormat.Docx_2013);
    }
}
</code></pre><p><img src="`+k+'" alt=""><img src="'+m+`" alt=""></p><h3 id="\u65B9\u68482-\u5229\u7528xml\u683C\u5F0F\u7684\u6A21\u677F\u5B9E\u73B0-\u751F\u6210\u7684\u662F\u8F6C\u6362\u8FC7\u7684xml\u683C\u5F0F\u7684word\u6587\u6863-\u4E0D\u662F\u539F\u751F\u7684" tabindex="-1"><a class="header-anchor" href="#\u65B9\u68482-\u5229\u7528xml\u683C\u5F0F\u7684\u6A21\u677F\u5B9E\u73B0-\u751F\u6210\u7684\u662F\u8F6C\u6362\u8FC7\u7684xml\u683C\u5F0F\u7684word\u6587\u6863-\u4E0D\u662F\u539F\u751F\u7684" aria-hidden="true">#</a> \u65B9\u68482. \u5229\u7528xml\u683C\u5F0F\u7684\u6A21\u677F\u5B9E\u73B0(\u751F\u6210\u7684\u662F\u8F6C\u6362\u8FC7\u7684xml\u683C\u5F0F\u7684word\u6587\u6863\uFF0C\u4E0D\u662F\u539F\u751F\u7684)</h3><ol><li>\u521B\u5EFAword\u6A21\u677F\uFF0C\u53E6\u5B58\u4E3Axml\u683C\u5F0F</li><li>\u5728\u586B\u5145\u7684\u5730\u65B9\u8BBE\u7F6Eftl\u6307\u4EE4\uFF0C\u4FDD\u5B58\u4E3Afreemarker\u683C\u5F0F\u7684\u6587\u4EF6</li><li>\u5229\u7528\u6A21\u677F\u5F15\u64CE\u8FDB\u884C\u6570\u636E\u586B\u5145\u6E32\u67D3\uFF0C\u8FD4\u56DE\u6587\u4EF6\u6D41</li><li>\u5C06\u6587\u4EF6\u6D41\u76F4\u63A5\u4FDD\u5B58\u4E3Adoc\u6216\u8005docx</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>        //\u52A0\u8F7DFTL\u6A21\u677F\u6240\u7528\u5230\u7684APi
        Configuration configuration = new Configuration(new Version(&quot;2.3.23&quot;));
        configuration.setDefaultEncoding(&quot;utf-8&quot;);
        configuration.setClassForTemplateLoading(this.getClass(), &quot;/&quot;);
 
 
        //\u4EE5utf-8\u7684\u7F16\u7801\u8BFB\u53D6ftl\u6587\u4EF6
        Template template = null;
 
        try {
            template = configuration.getTemplate(&quot;\u5B66\u751F\u4FE1\u606F.ftl&quot;, &quot;utf-8&quot;);
        } catch (IOException ex) {
            throw new Exception(&quot;\u8BFB\u53D6ftl\u6587\u4EF6\u5931\u8D25!&quot;, ex);
        }
        Writer writer  = null;
 
 
        // 4.\u751F\u6210 Word\u6587\u6863\u7684\u5168\u8DEF\u5F84\u540D\u79F0
        File outFile = new File(&quot;\u5B66\u751F\u4FE1\u606F.docx&quot;);
        writer = new OutputStreamWriter(new FileOutputStream(outFile), &quot;utf-8&quot;);
        // 6.\u88C5\u8F7D\u6570\u636E
        template.process(map, writer);
        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;);
        response.setHeader(&quot;Content-Dispostion&quot;,&quot;attachment;filename=&quot;+&quot;\u5B66\u751F\u4FE1\u606F.docx&quot;);
        // 7.\u8BFB\u53D6\u751F\u6210\u597D\u7684 Word\u6587\u6863
        File file = new File(&quot;\u5B66\u751F\u4FE1\u606F.docx&quot;);
        FileInputStream is = new FileInputStream(file);
        OutputStream os = response.getOutputStream();
        byte[] b = new byte[1024];
        int length;
        while ((length = is.read(b)) &gt; 0) {
            os.write(b, 0, length);
        }
 
        os.flush();
        os.close();
        writer.flush();
        writer.close();
        return null;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5206\u9875\u7B26</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;#--Word\u5206\u9875\u7B26--&gt;
&lt;w:p &gt;&lt;w:r&gt;&lt;w:br w:type=&quot;page&quot; /&gt;&lt;/w:r&gt;&lt;/w:p&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u65B9\u68483-\u5229\u7528xml\u683C\u5F0F\u7684\u6587\u4EF6\u4F5C\u4E3A\u6A21\u677F-\u65B0\u5EFAdocx\u683C\u5F0F\u7684\u6A21\u677F-\u53E6\u5B58\u4E3Azip-\u4EE5\u538B\u7F29\u6587\u4EF6\u4E2D\u7684document-xml\u6587\u4EF6\u5236\u4F5C\u6A21\u677F-\u751F\u6210\u7684\u6587\u4EF6\u662F\u539F\u751F\u7684word" tabindex="-1"><a class="header-anchor" href="#\u65B9\u68483-\u5229\u7528xml\u683C\u5F0F\u7684\u6587\u4EF6\u4F5C\u4E3A\u6A21\u677F-\u65B0\u5EFAdocx\u683C\u5F0F\u7684\u6A21\u677F-\u53E6\u5B58\u4E3Azip-\u4EE5\u538B\u7F29\u6587\u4EF6\u4E2D\u7684document-xml\u6587\u4EF6\u5236\u4F5C\u6A21\u677F-\u751F\u6210\u7684\u6587\u4EF6\u662F\u539F\u751F\u7684word" aria-hidden="true">#</a> \u65B9\u68483\uFF0C\u5229\u7528xml\u683C\u5F0F\u7684\u6587\u4EF6\u4F5C\u4E3A\u6A21\u677F(\u65B0\u5EFAdocx\u683C\u5F0F\u7684\u6A21\u677F\uFF0C\u53E6\u5B58\u4E3Azip,\u4EE5\u538B\u7F29\u6587\u4EF6\u4E2D\u7684document.xml\u6587\u4EF6\u5236\u4F5C\u6A21\u677F\uFF0C\u751F\u6210\u7684\u6587\u4EF6\u662F\u539F\u751F\u7684word)</h3><p>docx\u6587\u4EF6\u6A21\u677F\u521B\u5EFA \u9996\u5148\uFF0C\u6211\u4EEC\u5728\u684C\u9762\u6B63\u5E38\u521B\u5EFA\u4E00\u4E2Adocx\u6587\u4EF6 <img src="`+v+'" alt=""> \u7136\u540E\u6253\u5F00\u8FD9\u4E2Adocx\u6587\u4EF6\uFF0C\u5C06\u4F60\u9700\u8981\u7684\u57FA\u7840\u6A21\u677F\u586B\u5165\u8FD9\u4E2A\u6587\u6863 <img src="'+g+'" alt=""> \u4FDD\u5B58\u6587\u4EF6\uFF0C\u5E76\u9000\u51FAword\uFF0C\u5C06\u521A\u624D\u7684docx\u6587\u4EF6\u540E\u7F00\u4FEE\u6539\u4E3Azip <img src="'+b+'" alt=""> \u6253\u5F00\u8FD9\u4E2A\u538B\u7F29\u5305\uFF0C\u627E\u5230\u4E0B\u9762word\u6587\u4EF6\u5939\u4E0B\u7684document.xml\uFF0C\u5E76\u5C06\u5B83\u590D\u5236\u51FA\u6765 <img src="'+f+'" alt=""> \u6253\u5F00\u8FD9\u4E2A\u6587\u4EF6\uFF0C\u5F3A\u70C8\u63A8\u8350\u4F7F\u7528Notepad\u6253\u5F00</p><p>\u73B0\u5728\u6211\u4EEC\u9700\u8981\u505A\u7684\u5C31\u662F\u8981\u5B66\u7740\u8BFB\u61C2DocML\u4E86\uFF08\u5E94\u8BE5\u6CA1\u6709DocML\u8FD9\u4E2A\u4E1C\u897F\uFF0C\u6211\u8DDF\u7740HTML\u7F16\u7684\uFF0C\u8FD8\u6709\u8FD9\u4E2A\u4E1C\u897F\u4E5F\u8BB8\u5FAE\u8F6F\u5F00\u53D1\u8005\u8054\u76DF\u4E4B\u7C7B\u7684\u5730\u65B9\u6709\u6587\u6863\u5427\uFF0C\u53CD\u6B63\u76EE\u524D\u6211\u662F\u6CA1\u6709\u627E\u5230\u6807\u7B7E\u6587\u6863\uFF0C\u5168\u9760\u731C\uFF09\uFF0C\u6BD4\u5982\u5C06\u539F\u6765\u7684w:tr\u6807\u7B7E\u8FDB\u884C\u590D\u5236\uFF0C\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u884C\uFF0C\u628A\u4ED6\u7684\u7B2C\u4E00\u4E2A\u5217\u6539\u6210\u884C2\uFF0C\u7136\u540E\u6211\u4EEC\u628A\u8FD9\u4E2Axml\u4E22\u56DE\u5230\u539F\u6765\u7684\u6A21\u677Fzip\u4E2D\uFF0C\u518D\u628A\u5B83\u6539\u56DEdocx\u7528word\u6253\u5F00\uFF0C\u770B\u4E00\u4E0B\uFF08\u540C\u6837\u63A8\u8350\u4E00\u4E0B\u89E3\u538B\u5DE5\u5177\u4F7F\u7528winrar\uFF0C\u514D\u8D39\u9664\u4E86\u6709\u5E7F\u544A\u706B\u7ED2\u80FD\u62E6\u622A\u5916\uFF0C\u90FD\u80FD\u89E3\u538B\uFF0C\u4E3A\u4EC0\u4E48\u63A8\u8350\u7528winrar\u5462\uFF1F\u56E0\u4E3A\u51FA\u73B0\u8FC7\u540C\u4E8B\u7535\u8111\u4E0A\u7684\u6742\u724C\u5B50\u89E3\u538B\u8F6F\u4EF6\u4E0D\u80FD\u628A\u8FD9\u4E2Axml\u4E22\u56DE\u53BB\u66FF\u6362\u7684\u95EE\u9898\uFF0C\u6211\u5C31\u53EA\u80FD\u63A8\u8350\u4E00\u4E2A\u6211\u7528\u7740\u80FD\u6210\u529F\u7684\u8F6F\u4EF6\u4E86\uFF09 <img src="'+x+'" alt=""><img src="'+y+`" alt=""> \u770B\uFF0C\u8FD9\u65F6\u4ED6\u5C31\u6123\u751F\u751F\u7684\u591A\u51FA\u6765\u4E86\u4E00\u884C\uFF0C\u540C\u65F6\u6211\u4EEC\u4E5F\u9A8C\u8BC1\u4E86\uFF0C\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\u6211\u4EEC\u53EA\u9700\u8981\u5229\u7528Freemarker\u4FEE\u6539\u8FD9\u4E2AXML\uFF0C\u5E76\u66FF\u6362zip\u4E2Dxml\u4FEE\u6539\u540E\u7F00\u4E3Adocx\uFF0C\u5C31\u80FD\u5F97\u5230\u81EA\u5DF1\u60F3\u8981\u7684Word\u6587\u4EF6\u4E86</p><p>Freemarker\u6539\u9020\u6A21\u677F \u6539\u9020\u6A21\u677F\u65F6\u9887\u6709\u4E00\u79CD\u5199JSP\u7684\u65E2\u89C6\u611F\uFF0C\u9996\u5148\u6211\u5148\u8D34\u4E0AFreemarker\u7684\u6587\u6863\u8FDE\u63A5\uFF0C\u5148\u521D\u6B65\u4E86\u89E3\u4E00\u4E0BFreemarker\u5982\u4F55\u7F16\u8F91\u6A21\u677F\uFF0C\u5F53\u7136\uFF0C\u8FD9\u91CC\u4E5F\u4F1A\u5148\u63D0\u4F9B\u6700\u7B80\u5355\u7684\uFF0C\u4E5F\u662F\u6211\u5728\u505A\u6A21\u677F\u65F6\u6700\u5E38\u7528\u7684Freemarker\u6807\u7B7E\uFF1A</p><pre><code>\u666E\u901A\u63D2\u503C\uFF1A\u4F7F\u7528\${xxxxxx}
\u5FAA\u73AF\u63D2\u503C\uFF1A\u4F7F\u7528\u6807\u7B7E &lt;#list xxxxList as xxxx&gt;\${xxxx}&lt;/#list&gt;\u5176\u4E2DxxxxList\u4E3AList\u6216Array\u5BF9\u8C61
\u7A7A\u503C\u5224\u65AD\uFF1A\${xxxxx!&quot;&quot;}\u5176\u8868\u793A\u7684\u610F\u601D\u5C31\u662F\u5982\u679Cxxxxx\u4E3A\u7A7A\uFF0C\u5219\u4F7F\u7528\u201D\u201C,\u4ECE\u6211\u4F7F\u7528\u7684\u7ECF\u9A8C\u800C\u8A00\uFF0C\u505AWord\u7684\u6A21\u677F\u6700\u597D\u6240\u6709\u7684\u53D8\u91CF\u90FD\u5E26\u4E0A\u8FD9\u4E2A\u7A7A\u503C\u9ED8\u8BA4\u586B\u5145\u7A7A\uFF0C\u5426\u5219\u4F1A\u62A5\u9519\u7684
\u5176\u4ED6\u66F4\u8BE6\u5C3D\u7684Freemarker\u73A9\u6CD5\uFF0C\u5C31\u8981\u53BB\u770B\u5B98\u7F51\u7684\u4ECB\u7ECD\u4E86Freemarker\u6587\u6863
</code></pre><p>\u6700\u7EC8\u6539\u9020\u597D\u540E\uFF0C\u6211\u4EEC\u5C06\u5F97\u5230\u4E00\u4E0B\u4E24\u4E2A\u6587\u4EF6\uFF1A <img src="`+w+'" alt=""> \u524D\u8005\u4E3AFreemarker\u6A21\u677F\uFF0C\u540E\u8005\u4E3Adocx\u6E90\u6587\u4EF6\u66F4\u6539\u4E86\u6587\u4EF6\u540E\u7F00</p><p>\u8FD9\u9762\u5206\u4EAB\u4E00\u4E9B\u7ECF\u9A8C\uFF0C\u867D\u7136\u6211\u4EEC\u4E5F\u53EF\u4EE5\u5728word\u4E2D\u5C06\u6240\u6709\u7684${}\u63D0\u524D\u9884\u5236\u5728\u6587\u6863\u7F16\u8F91\u9875\u9762\uFF0C\u4ECE\u800C\u51CF\u5C11\u5728\u7F16\u8F91XML\u65F6\u66FF\u6362\u53D8\u91CF\u65F6\u7684\u5DE5\u4F5C\u91CF\uFF0C\u4F46\u662F\u4ECE\u6211\u662F\u7528\u7684\u7ECF\u9A8C\u89D2\u5EA6\u8BB2\uFF0C\u5C31\u7B97\u8FD9\u6837\u586B\u5145\u597D\u4E86\u6A21\u677F\uFF0C\u4E5F\u4E0D\u8981\u76F4\u63A5\u628AXML\u62FF\u51FA\u6765\u5C31\u7528\uFF0C\u56E0\u4E3Aword\u5728\u4E00\u4E9B\u60C5\u51B5\u4E0B\u4F1A\u5C06\u6211\u4EEC\u7684${}\u6807\u7B7E\u5206\u6210\u591A\u4E2AXml\u6807\u7B7E\uFF0C\u4ECE\u800C\u5728Freemarker\u5904\u7406\u6587\u6863\u65F6\uFF0C\u627E\u4E0D\u5230\u4F60\u60F3\u8981\u7684\u90A3\u4E2A\u53D8\u91CF\uFF0C\u4E5F\u5C31\u65E0\u6CD5\u6B63\u5E38\u66FF\u6362\u5982\uFF1A <img src="'+h+`" alt=""></p><p><strong>\u7531\u521B\u5EFA\u597D\u7684docx\u6587\u4EF6\u6A21\u677F\u4E0EFreemarker XML\u6A21\u677F\u521B\u5EFADocx\u6587\u4EF6</strong></p><p>\u597D\u7684\uFF0C\u5404\u4F4D\u901A\u8FC7\u524D\u9762\u7684\u5C0F\u8282\uFF0C\u5DF2\u7ECF\u53EF\u4EE5\u4E86\u89E3\u5230\u57FA\u672C\u7684\u539F\u7406\u4E86\uFF0C\u4ECE\u8FD9\u5F00\u59CB\uFF0C\u5C31\u8981\u5F00\u59CB\u6709\u4EE3\u7801\u5C42\u9762\u7684\u4E1C\u897F\u4E86\uFF0C\u9996\u5148\uFF0C\u6211\u4EEC\u8981\u4E3A\u9879\u76EE\u5F15\u5165Freemarker\u7684maven\uFF0C\u6211\u4E2A\u4EBA\u4F7F\u7528\u7684\u662F\u8FD9\u4E2AMaven\u7248\u672C</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7136\u540E\uFF0C\u9700\u8981\u521B\u5EFA\u4E00\u4E2A\u83B7\u53D6Freemarker\u6587\u4EF6\u8F93\u5165\u6D41\u7684\u5DE5\u5177\u7C7B\uFF0C\u628A\u6211\u4EEC\u7684xml\u6587\u4EF6\u586B\u5145\u4E0A\u6211\u4EEC\u7684\u6570\u636E\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>import cn.hutool.core.io.resource.ClassPathResource;
import freemarker.template.Configuration;
import freemarker.template.Template;
import freemarker.template.TemplateException;

import java.io.*;

public class FreemarkUtils {

    /**
     * \u6839\u636E\u6307\u5B9Axml\u751F\u6210\u6587\u4EF6(\u9ED8\u8BA4\u5C06\u6587\u6863\u653E\u5728resource/static\u4E0B)
     * @param orgData \u6A21\u677F\u6240\u9700\u6570\u636E
     * @param buildXml \u521B\u5EFA\u7684\u6A21\u677F\u540D
     * @param outFilePath \u6A21\u677F\u8F93\u51FA\u6587\u4EF6\u76EE\u5F55\u4E0E
     * @param outFileName \u6A21\u677F\u8F93\u51FA\u6587\u4EF6\u6587\u4EF6\u540D
     * @throws IOException
     * @throws TemplateException
     */
    public static void createFreemarkFile(Object orgData,String buildXml,String outFilePath,String outFileName) throws IOException, TemplateException {
        Configuration configuration = new Configuration();
        configuration.setDefaultEncoding(&quot;utf-8&quot;);
        configuration.setDirectoryForTemplateLoading(new ClassPathResource(&quot;static/&quot;).getFile());
        //\u4EE5utf-8\u7684\u7F16\u7801\u8BFB\u53D6ftl\u6587\u4EF6
        Template template =  configuration.getTemplate(buildXml,&quot;utf-8&quot;);
        Writer out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(outFilePath + outFileName), &quot;utf-8&quot;),10240);
        template.process(orgData, out);
        out.close();
    }

    /**
     * \u83B7\u53D6\u6A21\u677F\u8F93\u5165\u6D41
     * @param dataMap   \u53C2\u6570
     * @param templateName  \u6A21\u677F\u540D\u79F0
     * @param tempPath  \u6A21\u677F\u8DEF\u5F84 classes\u4E0B\u7684\u8DEF\u5F84 \u5982\u679C\u662Fclasses/static\u4E0B\u7684\u6A21\u677F  \u4F20\u5165 /static\u5373\u53EF
     * @return
     */
    public static ByteArrayInputStream getFreemarkerContentInputStream(Object dataMap, String templateName, String tempPath) {
        ByteArrayInputStream in = null;

        try {
            //\u521B\u5EFA\u914D\u7F6E\u5B9E\u4F8B
            Configuration configuration = new Configuration();

            //\u8BBE\u7F6E\u7F16\u7801
            configuration.setDefaultEncoding(&quot;UTF-8&quot;);

            //ftl\u6A21\u677F\u6587\u4EF6\u7EDF\u4E00\u653E\u81F3 com.lun.template \u5305\u4E0B\u9762
            configuration.setClassForTemplateLoading(FreemarkUtils.class, tempPath);
            //\u83B7\u53D6\u6A21\u677F
            Template template = configuration.getTemplate(templateName);

            StringWriter swriter = new StringWriter();
            //\u751F\u6210\u6587\u4EF6
            template.process(dataMap, swriter);
//            String result = swriter.toString();
in = new ByteArrayInputStream(swriter.toString().getBytes());

        } catch (Exception e) {
            e.printStackTrace();
        }
        return in;
    }

}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u4E2A\u7C7B\u4E2D\u8FD8\u9644\u5E26\u4E86\u4E00\u4E2AcreateFreemarkFile\u65B9\u6CD5\uFF0C\u8FD9\u4E2A\u65B9\u6CD5\u5C31\u662F\u76F4\u63A5\u751F\u6210\u4E00\u4E2A\u666E\u901A\u7684\u8F6C\u6362\u8FC7\u7684xml\u6587\u6863\uFF0C\u53EF\u4EE5\u5728\u6D4B\u8BD5\u8FC7\u7A0B\u4E2D\u4F7F\u7528\u8FD9\u4E2A\u65B9\u6CD5\u5148\u770B\u4E00\u4E0B\u6A21\u677F\u662F\u5426\u5236\u4F5C\u6B63\u5E38</p><p>\u6211\u4EEC\u5C06\u6A21\u677F\u653E\u5728\u9879\u76EE\u7684resources\u4E0B\u7684/static\u4E2D\uFF0C\u8FD9\u4E24\u4E2A\u6587\u4EF6\u5C31\u662F\u6211\u4EEC\u6240\u9700\u8981\u7684\u6A21\u677F\uFF08\u4E0D\u8981\u614C\u5F20\uFF0C\u6211\u53EA\u662F\u5728\u8FD9\u6539\u4E2A\u540D\uFF0C\u7528\u4E86\u4E2A\u5DF2\u7ECF\u505A\u597D\u7684\u66F4\u590D\u6742\u7684\u6A21\u677F\u800C\u5DF2\uFF09 <img src="`+q+`" alt=""> \u8FD9\u4E2A\u65B9\u6CD5\u5C31\u662F\u4F7F\u7528\u8C03\u7528\u4E0A\u9762\u5DE5\u5177\u7C7B\u4E2D\u6839\u636EFreemarker\u6A21\u677F\u751F\u6210\u597D\u7684\u6570\u636E\uFF0C\u5E76\u5C06\u5176\u66FF\u6362\u5230zip\u6587\u4EF6\u4E2D\uFF0C\u6587\u4EF6\u8F93\u51FA\u540D\u662F\u53EF\u6839\u636E\u540E\u671F\u4E2A\u4EBA\u9700\u8981\u8FDB\u884C\u4FEE\u6539</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**
* freemark\u751F\u6210word----docx\u683C\u5F0F(\u6570\u636E\u6E90\u9ED8\u8BA4\u653E\u5728resources/static)
* @param data \u6570\u636E\u6E90
* @param documentXmlName  document.xml\u6A21\u677F\u7684\u6587\u4EF6\u540D(\u751F\u6210\u7684\u6587\u672C\u6570\u636E)
* @param docxTempName   docx\u6A21\u677F\u7684\u6587\u4EF6\u540D\uFF08docx zip\u6587\u4EF6\uFF09
* @return \u751F\u6210\u7684\u6587\u4EF6\u8DEF\u5F84
*/
public static File createApplyDocx(Object data,
String documentXmlName,
String docxTempName,
String outFilePath) {
ZipOutputStream zipout = null;//word\u8F93\u51FA\u6D41
File tempPath = null;//docx\u683C\u5F0F\u7684word\u6587\u4EF6\u8DEF\u5F84
try {
//freemark\u6839\u636E\u6A21\u677F\u751F\u6210\u5185\u5BB9xml
//================================\u83B7\u53D6 document.xml \u8F93\u5165\u6D41================================
ByteArrayInputStream documentInput = FreemarkUtils.getFreemarkerContentInputStream(data, documentXmlName, File.separator + &quot;static&quot; + File.separator);
//================================\u83B7\u53D6 document.xml \u8F93\u5165\u6D41================================
//\u83B7\u53D6\u4E3B\u6A21\u677Fdocx
ClassPathResource resource = new ClassPathResource(&quot;static&quot; + File.separator + docxTempName);
File docxFile = resource.getFile();

            ZipFile zipFile = new ZipFile(docxFile);
            Enumeration&lt;? extends ZipEntry&gt; zipEntrys = zipFile.entries();

            //\u8F93\u51FAword\u6587\u4EF6\u8DEF\u5F84\u548C\u540D\u79F0
            String fileName = &quot;applyWord_&quot; + System.currentTimeMillis() + &quot;.docx&quot;;
            String outPutWordPath = outFilePath + fileName;

            tempPath = new File(outPutWordPath);
            //\u5982\u679C\u8F93\u51FA\u76EE\u6807\u6587\u4EF6\u5939\u4E0D\u5B58\u5728\uFF0C\u5219\u521B\u5EFA
            if (!tempPath.getParentFile().exists()) {
                tempPath.mkdirs();
            }
            //docx\u6587\u4EF6\u8F93\u51FA\u6D41
            zipout = new ZipOutputStream(new FileOutputStream(tempPath));

            //\u5FAA\u73AF\u904D\u5386\u4E3B\u6A21\u677Fdocx\u6587\u4EF6,\u66FF\u6362\u6389\u4E3B\u5185\u5BB9\u533A\uFF0C\u4E5F\u5C31\u662F\u4E0A\u9762\u83B7\u53D6\u7684document.xml\u7684\u5185\u5BB9
            //------------------\u8986\u76D6\u6587\u6863------------------
            int len = -1;
            byte[] buffer = new byte[1024];
            while (zipEntrys.hasMoreElements()) {
                ZipEntry next = zipEntrys.nextElement();
                InputStream is = zipFile.getInputStream(next);
                if (next.toString().indexOf(&quot;media&quot;) &lt; 0) {
                    zipout.putNextEntry(new ZipEntry(next.getName()));
                    if (&quot;word/document.xml&quot;.equals(next.getName())) {
                        //\u5199\u5165\u586B\u5145\u6570\u636E\u540E\u7684\u4E3B\u6570\u636E\u4FE1\u606F
                        if (documentInput != null) {
                            while ((len = documentInput.read(buffer)) != -1) {
                                zipout.write(buffer, 0, len);
                            }
                            documentInput.close();
                        }
                    }else {//\u4E0D\u662F\u4E3B\u6570\u636E\u533A\u7684\u90FD\u7528\u4E3B\u6A21\u677F\u7684
                        while ((len = is.read(buffer)) != -1) {
                            zipout.write(buffer, 0, len);
                        }
                        is.close();
                    }
                }
            }
            //------------------\u8986\u76D6\u6587\u6863------------------
            zipout.close();//\u5173\u95ED

        } catch (Exception e) {
            e.printStackTrace();
            try {
                if(zipout!=null){
                    zipout.close();
                }
            }catch (Exception ex){
                ex.printStackTrace();
            }
        }
        return tempPath;
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>File docxFile = DOC2PDFUtils.createApplyDocx(vo,
&quot;\u9879\u76EE\u5EFA\u8BAE\u4E66docx\u7248\u672C.xml&quot;,
&quot;\u9879\u76EE\u5EFA\u8BAE\u4E66.zip&quot;,
&quot;D:/&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5F53\u8C03\u7528\u8FD9\u4E2A\u65B9\u6CD5\u65F6\uFF0C\u6211\u4EEC\u7684docx\u6587\u4EF6\u5C31\u88AB\u751F\u6210\u4E86</p><p><strong>\u6253\u5305Windows\u4E0B\u7684ttf\u5B57\u4F53\u6587\u4EF6\u751F\u6210ttc\u5B57\u4F53\u6587\u4EF6\u5305</strong></p><p>\u5728\u6B63\u5F0F\u8D34\u5165docx\u8F6Cpdf\u7684\u529F\u80FD\u524D\uFF0C\u9996\u5148\u6211\u8981\u5148\u4ECB\u7ECD\u4E00\u4E0B\u5B57\u4F53\u5305\u7684\u6253\u5305\uFF0C\u5728\u6211\u4EEC\u4F7F\u7528\u5DE5\u5177\u7C7B\uFF0C\u5C06\u8FDB\u884C\u6587\u4EF6\u64CD\u4F5C\u7684\u65F6\u5019\uFF0C\u6700\u62C5\u5FC3\u7684\u5C31\u662FLinux\u7684\u517C\u5BB9\u95EE\u9898\uFF0C\u4EE5\u524D\u4E86\u89E3\u8FC7\u4E00\u4E9B\u7C7B\u4F3C\u7684\u5DE5\u5177\u7C7B\uFF0C\u4F46\u662F\u5F88\u591A\u90FD\u662F\u4F7F\u7528office\u7684dll\u6587\u4EF6\u505A\u7684\u4E2D\u95F4\u4EF6\uFF0C\u5230\u4E86Linux\u4E0A\u3002\u3002\u3002\u3002\u4E00\u8A00\u96BE\u5C3D\u3002</p><p>\u8FD9\u4E2A\u5C0F\u8282\u5C31\u662F\u4E3A\u4E0B\u9762docx\u8F6Cpdf\u65F6\u7684\u6700\u540E\u4E00\u5173\uFF0C\u5B57\u4F53\uFF0C\u6253\u4E0B\u57FA\u7840\u3002</p><p>\u6211\u5DF2\u5C06\u6253\u5305\u5DE5\u5177\u4E0A\u4F20\u5230CSDN\u7684\u6587\u4EF6\u5171\u4EAB\u4E2D\uFF0C\u5BA1\u6838\u8FC7\u540E\uFF0C\u5C06\u4F1A\u9644\u5E26\u94FE\u63A5\uFF0C\u4E0D\u7528\u62C5\u5FC3\uFF0C\u6211\u8BBE\u7F6E\u7684\u662F0\u5E01\u4E0B\u8F7D\u3002 fontforge\u5DE5\u5177\u4E0B\u8F7D</p><p>\u6253\u5F00\u5DE5\u5177\u76EE\u5F55\u540E\uFF0C\u6211\u4EEC\u5C06\u770B\u5230\u8FD9\u6837\u7684\u76EE\u5F55\u7ED3\u6784 <img src="`+F+'" alt=""> \u6211\u4EEC\u9009\u62E9\u6253\u5F00fontforge.bat\u8FD9\u4E2A\u6587\u4EF6\uFF0C\u5C06\u4F1A\u770B\u5230\u8FD9\u6837\u7684\u89C6\u7A97 <img src="'+I+`" alt=""> \u5F53\u7136\uFF0C\u8FD9\u4E2A\u4E1C\u897F\u6211\u4EEC\u5148\u4E0D\u8981\u7BA1\u4ED6\uFF0C\u4E3B\u8981\u7684\u662F\u8981\u5148\u627E\u5230\u6211\u4EEC\u6240\u9700\u8981\u7684\u5B57\u4F53\u6587\u4EF6\uFF0C\u8FDB\u5165\u8FD9\u4E2A\u76EE\u5F55</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>C:\\Windows\\Fonts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6211\u4EEC\u5C06\u770B\u5230\u5F53\u524D\u7CFB\u7EDF\u4E0B\u6240\u6709\u7684\u5B57\u4F53\u6587\u4EF6\uFF0C\u8FD9\u91CC\u6211\u4EEC\u4F7F\u7528\u7B49\u7EBF\u5B57\u4F53\u4F5C\u4E3A\u8303\u4F8B <img src="`+P+'" alt=""> \u641C\u7D22\u540E\uFF0C\u627E\u5230\u6240\u9700\u7684\u5B57\u4F53\uFF0C\u9009\u4E2D\u540ECTRL+C\u8FDB\u884C\u590D\u5236\uFF0C\u5728fontforge\u5DE5\u5177\u6587\u4EF6\u5939\u540C\u7EA7\u76EE\u5F55\u8FDB\u884C\u7C98\u8D34 <img src="'+A+'" alt=""> \u8FD9\u65F6\u6211\u4EEC\u53D1\u73B0\uFF0C\u867D\u7136\u53EA\u590D\u5236\u4E86\u4E00\u4E2A\u7B49\u7EBF\u5B57\u4F53\uFF0C\u4F46\u662F\u5B9E\u9645\u4E0A\u5374\u590D\u5236\u51FA\u4E86\u591A\u4E2A\u6587\u4EF6\uFF0C\u4E0D\u8FC7\u6CA1\u95EE\u9898\uFF0C\u6211\u4EEC\u628A\u4ED6\u4EEC\u8FDB\u884C\u5408\u5E76\u751F\u6210\u6240\u9700\u8981\u7684ttc\u5B57\u4F53\u96C6\u5408\u5373\u53EF\uFF0C\u56DE\u5230\u521A\u624D\u6253\u5F00\u7684\u7A97\u53E3\u4E2D\uFF0C\u9009\u62E9\u4E0A\u9762\u7684..\u8FD4\u56DE\u4E0A\u4E00\u5C42\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u770B\u5230\u5DE5\u5177\u5DF2\u7ECF\u8BC6\u522B\u5230\u4E86\u8FD9\u4E09\u4E2A\u5C0F\u5BB6\u4F19\u4E86\uFF0CCTRL\u591A\u9009\u4ED6\u4EEC\u540E\uFF0C\u70B9\u51FB\u5DE6\u4E0B\u89D2\u7684\u6253\u5F00 <img src="'+S+'" alt=""> \u7B80\u5355\u7B49\u5F85\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\u8FD9\u4E09\u4E2A\u5B57\u4F53\u6587\u4EF6\u5C31\u88AB\u89E3\u6790\u6253\u5F00\u4E86 <img src="'+D+'" alt=""> \u8FD9\u65F6\u6211\u4EEC\u968F\u4FBF\u5728\u4E00\u4E2A\u7A97\u53E3\u7684 \u6587\u4EF6-&gt;\u751F\u6210ttc <img src="'+M+'" alt=""> \u4E3A\u4ED6\u8D77\u4E00\u4E2A\u540D\u5B57\uFF0C\u7136\u540E\u70B9\u51FBGenerate\u9759\u9759\u5F00\u59CB\u7B49\u5F85 <img src="'+j+'" alt=""> \u5F53\u7A97\u53E3\u6D88\u5931\uFF0C\u5373\u53EF\u627E\u5230\u521A\u521A\u751F\u6210\u7684ttc\u6587\u4EF6 <img src="'+T+'" alt=""> \u4ECE\u5C5E\u6027\u6587\u4EF6\u7684\u5927\u5C0F\u4EE5\u53CA\u53CC\u51FB\u6253\u5F00ttc\u6587\u4EF6\u7684\u63CF\u8FF0\u4E0A\uFF0C\u6211\u4EEC\u53EF\u4EE5\u77E5\u9053\uFF0C\u6240\u9700\u8981\u7684\u5B57\u4F53\u5DF2\u7ECF\u88AB\u6574\u5408\u5230\u4E00\u8D77\u4E86\uFF0C\u4E0A\u9762\u6709\u7EC6\u5FC3\u7684\u5C0F\u4F19\u4F34\u5E94\u8BE5\u80FD\u770B\u5230\uFF0C\u5728\u6211\u9879\u76EE\u4E2D\u4E0E\u6A21\u677F\u540C\u7EA7\u7684\u4F4D\u7F6E\uFF0C\u5C31\u653E\u7740\u7B49\u7EBF\uFF08dengxian.ttc\uFF09\u5B8B\u4F53\uFF08simsun.ttc\uFF09\u8FD9\u4E24\u4E2A\u5B57\u4F53\u7684ttc\u6574\u5408\u5305\u4E86 <img src="'+C+'" alt=""><img src="'+E+`" alt=""></p><p><strong>\u5C06docx\u6587\u4EF6\u8F6C\u6362\u4E3APdf</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>\u7ECF\u8FC7\u524D\u9762\u7684\u94FA\u57AB\uFF0C\u6211\u4EEC\u6700\u7EC8\u6765\u5230\u4E86docx\u6587\u4EF6\u8F6Cpdf\u6587\u4EF6\u7684\u73AF\u8282\uFF0C\u9996\u5148\u6211\u4EEC\u5148\u5F15\u5165Maven\u914D\u7F6E

&lt;dependency&gt;
   &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
    &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
    &lt;version&gt;5.4.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/org.docx4j/docx4j --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j&lt;/artifactId&gt;
    &lt;version&gt;6.0.1&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-export-fo&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-core&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0B\u9762\u662F\u5B9E\u73B0\u4EE3\u7801\uFF0C\u901A\u8FC7PhysicalFonts.addPhysicalFonts\u5F15\u5165\u6211\u4EEC\u6240\u5BFC\u597D\u7684\u5B57\u4F53\u6587\u4EF6\uFF0C\u5E76\u4F7F\u7528fontMapper.put\u521B\u5EFAWord\u4E2D\u4F7F\u7528\u7684\u5B57\u4F53\u7C7B\u578B\u4E0E\u5B57\u4F53\u6587\u4EF6\u4E4B\u95F4\u7684\u5BF9\u7167\u5173\u7CFB</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**
* word\uFF08docx\uFF09\u8F6Cpdf
* @param wordPath  docx\u6587\u4EF6\u8DEF\u5F84
* @return  \u751F\u6210\u7684\u5E26\u6C34\u5370\u7684pdf\u8DEF\u5F84
*/
public static File convertDocx2Pdf(String wordPath,String pdfOutPath) {
String regex=&quot;.*(Courier New|Arial|Times New Roman|Comic Sans|Georgia|Impact|Lucida Console|Lucida Sans Unicode|Palatino Linotype|Tahoma|Trebuchet|Verdana|Symbol|Webdings|Wingdings|Wingdings 2|MS Sans Serif|MS Serif).*&quot;;
Date startDate = new Date();
PhysicalFonts.setRegex(regex);
String pdfNoMarkPath = null;

        OutputStream os = null;
        InputStream is = null;
        try {
            is = new FileInputStream(new File(wordPath));
            WordprocessingMLPackage mlPackage = WordprocessingMLPackage.load(is);
            Mapper fontMapper = new IdentityPlusMapper();

            PhysicalFonts.addPhysicalFonts(&quot;SimSun&quot;, FreemarkUtils.class.getResource(&quot;/static/simsun.ttc&quot;));
            PhysicalFonts.addPhysicalFonts(&quot;DengXian&quot;, FreemarkUtils.class.getResource(&quot;/static/dengxian.ttc&quot;));
            // fontMapper.put(&quot;Helvetica&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;\u5B8B\u4F53&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;\u5B8B\u4F53 (\u4E2D\u6587\u6B63\u6587)&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;\u7B49\u7EBF&quot;, PhysicalFonts.get(&quot;DengXian&quot;));
            mlPackage.setFontMapper(fontMapper);
            //\u8F93\u51FApdf\u6587\u4EF6\u8DEF\u5F84\u548C\u540D\u79F0
            String fileName = &quot;pdfNoMark_&quot; + System.currentTimeMillis() + &quot;.pdf&quot;;
            // String pdfNoMarkPath = System.getProperty(&quot;java.io.tmpdir&quot;).replaceAll(separator + &quot;$&quot;, &quot;&quot;) + separator + fileName;
            pdfNoMarkPath = pdfOutPath + fileName;

            os = new java.io.FileOutputStream(pdfNoMarkPath);
            //docx4j  docx\u8F6Cpdf
            FOSettings foSettings = Docx4J.createFOSettings();

            foSettings.setWmlPackage(mlPackage);
            Docx4J.toFO(foSettings, os, Docx4J.FLAG_EXPORT_PREFER_XSL);

            is.close();//\u5173\u95ED\u8F93\u5165\u6D41
            os.close();//\u5173\u95ED\u8F93\u51FA\u6D41

            return new File(pdfNoMarkPath);
        } catch (Exception e) {
            e.printStackTrace();
            try {
                if(is != null){
                    is.close();
                }
                if(os != null){
                    os.close();
                }
            }catch (Exception ex){
                ex.printStackTrace();
            }
        }finally {
        // \u8FD9\u91CC\u539F\u672C\u662F\u5C06word\u6587\u4EF6\u8FDB\u884C\u5220\u9664\uFF0C\u7531\u4E8E\u6211\u7684\u4E1A\u52A1\u4E0A\u4E0D\u9700\u8981\u5BF9\u8FD9\u4E2A\u6587\u4EF6\u8FDB\u884C\u5220\u9664\uFF0C\u6240\u4EE5\u5C31\u79FB\u9664\u4E86\u8FD9\u6BB5\u4EE3\u7801
//            File file = new File(wordPath);
//            if(file!=null&amp;&amp;file.isFile()&amp;&amp;file.exists()){
//                file.delete();
//            }
}
return null;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6700\u540E\u8C03\u7528\u8FD9\u4E2A\u65B9\u6CD5\u5373\u53EF</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// docxFile\u4E3A\u4E0A\u9762\u751F\u6210\u7684Docx\u6587\u4EF6
File pdfFile = DOC2PDFUtils.convertDocx2Pdf(docxFile.getAbsolutePath(),&quot;D:/&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u5B57\u4F53\u8981\u6839\u636E\u4E2A\u4EBA\u4F7F\u7528\u60C5\u51B5\u8FDB\u884C\u9002\u5F53\u8C03\u6574\uFF0C\u6240\u4F7F\u7528\u7684\u5B57\u4F53\u53EF\u4EE5\u5728XML\u6A21\u677F\u4E2D\u770B\u5230\uFF0C\u5982\uFF1A</p><p>\u5F53\u8FD9\u4E2A\u65B9\u6CD5\u8FD0\u884C\u65F6\uFF0C\u53EF\u4EE5\u6839\u636E\u63A7\u5236\u53F0\u62A5\u9519\u8FDB\u884C\u5B57\u4F53\u6587\u4EF6\u7684\u8C03\u6574</p>`,75),sn={href:"https://blog.csdn.net/weixin_33374585/article/details/114719233",target:"_blank",rel:"noopener noreferrer"},an=n("h3",{id:"\u65B9\u68484-\u5229\u7528docx4j\u5B9E\u73B0",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u65B9\u68484-\u5229\u7528docx4j\u5B9E\u73B0","aria-hidden":"true"},"#"),s(" \u65B9\u68484\uFF0C\u5229\u7528docx4j\u5B9E\u73B0")],-1),tn={href:"https://github.com/plutext/docx4j",target:"_blank",rel:"noopener noreferrer"},pn={href:"https://blog.csdn.net/qq_31905135/article/details/80431042",target:"_blank",rel:"noopener noreferrer"},en={href:"https://blog.csdn.net/weixin_34295316/article/details/86022702",target:"_blank",rel:"noopener noreferrer"},on={href:"https://blog.csdn.net/zhyh1986/article/details/8766131",target:"_blank",rel:"noopener noreferrer"},cn=p('<h3 id="\u65B9\u68484-\u901A\u8FC7xdocreport\u548Cfreemarker\u6A21\u677F\u5F15\u64CE\u751F\u6210word\u6587\u6863" tabindex="-1"><a class="header-anchor" href="#\u65B9\u68484-\u901A\u8FC7xdocreport\u548Cfreemarker\u6A21\u677F\u5F15\u64CE\u751F\u6210word\u6587\u6863" aria-hidden="true">#</a> \u65B9\u68484\uFF0C\u901A\u8FC7XDocReport\u548CFreeMarker\u6A21\u677F\u5F15\u64CE\u751F\u6210Word\u6587\u6863</h3><p>\u51C6\u5907\u73AF\u5883 \u5F00\u53D1\u8BED\u8A00\uFF1A</p><p>Java7\u53CA\u4EE5\u4E0A\u7684\u7248\u672C\u3002</p><p>\u5F00\u53D1\u5DE5\u5177\uFF1A</p><p>Eclipse/Idea\u3002</p><p>\u7B2C\u4E09\u65B9\u4F9D\u8D56\u5E93\uFF1A</p><p>XDocReport\u3001POI\u3001Freemarker\u3002</p><p>\u6A21\u677F\u8BED\u8A00\uFF1A</p><p>FreeMarker\u3002</p><p>Word\u7F16\u8F91\u5668\uFF1A</p><p>Microsoft 365\u6216\u5176\u4ED6\u7248\u672C\u8F83\u9AD8\u7684Word\u7F16\u8F91\u5668\u3002</p><p>\u793A\u4F8BWord\u6A21\u677F <img src="'+L+`" alt=""></p><p>\u5236\u4F5C\u6A21\u677F Word\u6A21\u677F\u5982\u4E0A\u56FE\uFF0C\u53EF\u4EE5\u770B\u5230\uFF0C\u7ED3\u6784\u6BD4\u8F83\u7B80\u5355\uFF0C\u5305\u62EC\u4E24\u4E2A\u90E8\u5206\uFF0C\u7B2C\u4E00\u90E8\u5206\u662F\u7EAF\u6587\u5B57\u548C\u6570\u5B57\uFF0C\u7B2C\u4E8C\u90E8\u5206\u4E3B\u8981\u662F\u8868\u683C\u3002\u6211\u4EEC\u5728\u5B9E\u9645\u7684\u5F00\u53D1\u8FC7\u7A0B\u4E2D\u751F\u6210\u7684\u62A5\u8868\u51E0\u4E4E\u90FD\u662F\u52A8\u6001\u751F\u6210\u7684\uFF0C\u6240\u4EE5\u6A21\u677F\u4E2D\u7684\u6570\u5B57\u548C\u8868\u683C\u91CC\u7684\u6570\u636E\u90FD\u8981\u66FF\u6362\u6210\u6211\u4EEC\u540E\u53F0\u7684\u5B9E\u9645\u6570\u636E\u3002</p><p>\u66FF\u6362Word\u6A21\u677F\u4E2D\u7684\u52A8\u6001\u53D8\u91CF\uFF0C\u6211\u4EEC\u9700\u8981\u638C\u63E1\u4E24\u4E2A\u77E5\u8BC6\u70B9\uFF1A</p><pre><code>1.Word\u6587\u6863\u4E2D\u7684Word\u57DF\uFF0Cword\u57DF\u662F\u5F15\u5BFCWord\u5728\u6587\u6863\u4E2D\u81EA\u52A8\u63D2\u5165\u6587\u5B57\u3001\u56FE\u5F62\u3001\u9875\u7801\u6216\u5176\u4ED6\u4FE1\u606F\u7684\u4E00\u7EC4\u4EE3\u7801\u3002\u5728\u8FD9\u91CC\u6211\u4EEC\u53EF\u4EE5\u628A         Word\u57DF\u7406\u89E3\u6210\u6807\u8BC6\u7B26\uFF0C\u8FD9\u4E2A\u6807\u8BC6\u7B26\u8868\u793AWord\u6587\u6863\u4E2D\u8981\u88AB\u66FF\u6362\u7684\u5185\u5BB9\uFF1B

2.FreeMarker\u6A21\u677F\u4E0B\u7684\u53D8\u91CF\u8868\u8FBE\u5F0F\uFF0C\u6BD4\u5982\u7528\${city}\u66FF\u6362Word\u793A\u4F8B\u6A21\u677F\u4E2D\u7684\u5317\u4EAC\u5E02\u3002
</code></pre><p>\u4E86\u89E3\u4E86\u4EE5\u4E0A\u4E24\u4E2A\u6982\u5FF5\u540E\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u52A8\u624B\u7F16\u8F91Word\u6A21\u677F\u4E86\uFF0C\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><ol><li><p>\u9996\u5148\u5728Word\u6A21\u677F\u4E2D\u9009\u4E2D\u8981\u66FF\u6362\u7684\u6587\u672C\uFF0C\u5728\u8FD9\u513F\u62FF\u6807\u9898\u4E2D\u7684&quot;\u5317\u4EAC\u5E02&quot;\u4E3A\u4F8B\uFF0C\u7136\u540E\u952E\u76D8\u4F7F\u7528 Ctrl + F9 \u7EC4\u5408\u952E\u5C06\u5176\u8BBE\u7F6E\u4E3A\u57DF\uFF0C\u6B64\u65F6\u6587\u672C\u4F1A\u88AB&quot;{}&quot;\u5305\u56F4\uFF0C\u63A5\u7740\u9F20\u6807\u53F3\u952E\u9009\u62E9\u3010\u7F16\u8F91\u57DF(E)...\u3011\uFF1A <img src="`+W+'" alt=""></p></li><li><p>\u5728\u5F39\u51FA\u7684\u5BF9\u8BDD\u6846\u4E2D\uFF0C\u7C7B\u522B\u9009\u62E9\u201C\u90AE\u4EF6\u5408\u5E76\u201D\uFF0C\u57DF\u540D\u9009\u62E9 &quot;MergeField&quot;\uFF0C\u57DF\u5C5E\u6027\u4E2D\u7684\u57DF\u540D\u586B\u5165\u6A21\u7248\u8868\u8FBE\u5F0F${city}\uFF0C\u70B9\u51FB\u3010\u786E\u5B9A\u3011\u6309\u94AE: <img src="'+H+'" alt=""></p></li><li><p>\u7F16\u8F91\u540E\u7684\u6548\u679C\u5982\u4E0B\uFF1A</p></li></ol><p><img src="'+R+'" alt=""></p><ol start="4"><li>\u638C\u63E1\u66FF\u6362\u6587\u672C\u7684\u65B9\u6CD5\u540E\uFF0C\u6211\u4EEC\u53EF\u4EE5\u628AWord\u6A21\u677F\u7B2C\u4E00\u90E8\u5206\u9700\u8981\u66FF\u6362\u7684\u5185\u5BB9\u90FD\u66FF\u6362\u6210\u6A21\u677F\u53D8\u91CF\uFF1A <img src="'+X+'" alt=""></li></ol><p>Word\u6A21\u677F\u4E2D\u8868\u683C\u6570\u636E\u7684\u5904\u7406 \u8868\u683C\u4E2D\u7684\u6570\u636E\u5B9E\u8D28\u4E0A\u5C31\u662F\u5BF9\u96C6\u5408\u7684\u904D\u5386\u3002</p><p>\u8868\u683C\u6570\u636E\u7684\u5904\u7406\u5176\u5B9E\u548C\u4E0A\u9762\u5BF9\u6587\u672C\u5185\u5BB9\u7684\u5904\u7406\u662F\u7C7B\u4F3C\u7684\uFF0C\u53EA\u4E0D\u8FC7\u8981\u5728Word\u6A21\u677F\u4E2D\u52A0\u4E0A\u96C6\u5408\u7684\u53D8\u91CF\uFF0CJava\u4EE3\u7801\u4E2D\u4E5F\u8981\u6709\u5BF9\u96C6\u5408\u8FDB\u884C\u7279\u5BF9\u7684\u5904\u7406(\u8FD9\u4E2A\u5728\u540E\u9762\u7684\u4EE3\u7801\u5C55\u793A\u90E8\u5206\u4F1A\u8BF4)\u3002</p><p>\u5177\u4F53\u64CD\u4F5C\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><ol><li><p>\u9009\u5B9A\u8868\u683C\u4E2D\u8981\u66FF\u6362\u7684\u6587\u672C\uFF0C\u7136\u540E\u952E\u76D8\u4F7F\u7528 Ctrl + F9 \u7EC4\u5408\u952E\u5C06\u5176\u8BBE\u7F6E\u4E3A\u57DF\uFF0C\u63A5\u7740\u9F20\u6807\u53F3\u952E\u9009\u62E9\u3010\u7F16\u8F91\u57DF(E)...\u3011\uFF1A <img src="'+O+'" alt=""></p></li><li><p>\u5728\u5F39\u51FA\u7684\u5BF9\u8BDD\u6846\u4E2D\uFF0C\u7C7B\u522B\u9009\u62E9\u201C\u90AE\u4EF6\u5408\u5E76\u201D\uFF0C\u57DF\u540D\u9009\u62E9 &quot;MergeField&quot;\uFF0C\u57DF\u5C5E\u6027\u4E2D\u7684\u57DF\u540D\u586B\u5165\u6A21\u7248\u8868\u8FBE\u5F0F${goods.num}\uFF0C\u70B9\u51FB\u3010\u786E\u5B9A\u3011\u6309\u94AE\uFF1B</p></li><li><p>\u91CD\u590D\u6B65\u9AA42\uFF0C\u66FF\u6362\u8868\u683C\u4E2D\u7684\u5176\u4ED6\u6587\u672C\u5185\u5BB9\uFF1A <img src="'+_+`" alt=""></p></li></ol><p><strong>\u540E\u53F0\u4EE3\u7801</strong></p><p>\u6DFB\u52A0\u4F9D\u8D56\u5230pom.xml\u6587\u4EF6</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls&lt;/artifactId&gt;
    &lt;version&gt;2.6.0&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls-poi&lt;/artifactId&gt;
    &lt;version&gt;1.2.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.core&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document.docx&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template.freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.3.23&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7F16\u5199Java\u4EE3\u7801</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>renren<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Goods</span></span><span class="token punctuation">;</span>
 
<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/word&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordTest</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//\u83B7\u53D6Word\u6A21\u677F\uFF0C\u6A21\u677F\u5B58\u653E\u8DEF\u5F84\u5728\u9879\u76EE\u7684resources\u76EE\u5F55\u4E0B</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/\u6A21\u677F.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6CE8\u518Cxdocreport\u5B9E\u4F8B\u5E76\u52A0\u8F7DFreeMarker\u6A21\u677F\u5F15\u64CE</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span>     
                               <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u521B\u5EFAxdocreport\u4E0A\u4E0B\u6587\u5BF9\u8C61</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u521B\u5EFA\u8981\u66FF\u6362\u7684\u6587\u672C\u53D8\u91CF</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;\u5317\u4EAC\u5E02&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;startDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2020-09-17&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;endDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2020-10-16&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;totCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">3638763</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;totAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;6521&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;onCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">2874036</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;onAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4768&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;offCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">764727</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;offAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1753&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;typeCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> goodsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;\u81ED\u7F8E\u6BC1\u80A4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">675512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;589&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;\u5973\u88C5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">602145</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;651&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">587737</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;866&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;\u5BB6\u5177\u5BB6\u88C5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">551193</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;783&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;\u98DF\u7269\u996E\u54C1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">528604</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;405&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> goodsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u521B\u5EFA\u5B57\u6BB5\u5143\u6570\u636E</span>
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Word\u6A21\u677F\u4E2D\u7684\u8868\u683C\u6570\u636E\u5BF9\u5E94\u7684\u96C6\u5408\u7C7B\u578B</span>
        fm<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Goods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
        <span class="token comment">//\u8F93\u51FA\u5230\u672C\u5730\u76EE\u5F55</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://\u5546\u54C1\u9500\u552E\u62A5\u8868.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Word\u6A21\u677F\u4E2D\u751F\u6210\u5E8F\u53F7 \u7ED9\u8868\u683C\u6570\u636E\u6DFB\u52A0\u5E8F\u53F7\u662F\u901A\u8FC7\u540E\u53F0\u4EE3\u7801\u751F\u6210\u7684\uFF0C\u6BD4\u5982\u4E0A\u9762\u7684&quot;goods1.setNum(1)&quot;\u8FD9\u6BB5\u4EE3\u7801\uFF0C\u5176\u5B9E\u4E5F\u53EF\u4EE5\u5728Word\u6A21\u677F\u4E2D\u8BBE\u7F6E\u5BF9\u5E94\u7684\u57DF\u53D8\u91CF\u6765\u5B9E\u73B0\u5E8F\u53F7\u7684\u586B\u5145\u3002</p><p>\u8BED\u6CD5\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@before-row[#list sequence as item]
item?index
@after-row[/#list]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u8868\u683C\u4E2D\u6DFB\u52A0\u4E0A\u9762\u7684\u8868\u8FBE\u5F0F\uFF0CXDocReport\u5C31\u4F1A\u81EA\u52A8\u89E3\u6790\u5E76\u751F\u6210\u5E8F\u53F7\uFF0C\u8868\u683C\u4E2D\u7684\u5176\u4ED6\u5B57\u6BB5\u4E5F\u9700\u8981\u8FDB\u884C\u76F8\u5E94\u7684\u6539\u52A8:</p><p><img src="`+B+'" alt=""></p><p>\u63D0\u793A\uFF1A</p><ol><li>\u5E8F\u53F7\u7684\u8868\u8FBE\u5F0F\u8981\u62C6\u6210\u4E09\u4E2A\u57DF\uFF0C\u5982\u4E0B\u56FE\uFF0C\u8981\u628A\u8FD9\u4E09\u90E8\u5206\u5206\u522B\u8BBE\u7F6E\u6210\u57DF\uFF1B</li></ol><p><img src="'+N+`" alt=""></p><pre><code> \u8BBE\u7F6E\u5B8C\u6210\u7684\u7ED3\u679C\u53C2\u8003\u4E0A\u9762\u8868\u683C\u4E2D\u7684\u5E8F\u53F7\u8868\u8FBE\u5F0F\uFF0C\u8868\u8FBE\u5F0F\u4E2D&quot;item?index+1&quot;\u662F\u56E0\u4E3A\u5E8F\u53F7\u662F\u4ECE0\u5F00\u59CB\u7684\uFF0C\u6240\u4EE5\u8981\u52A01\uFF1B
</code></pre><ol start="2"><li><p>\u8868\u683C\u4E2D\u9664\u5E8F\u53F7\u7684\u5217\u9700\u8981\u6539\u6210item.xxx\u800C\u4E0D\u662F\u4E4B\u524D\u7684goods.xxx: <img src="`+z+'" alt=""></p></li><li><p>\u751F\u6210\u6548\u679C\u5982\u4E0B: <img src="'+U+`" alt=""></p></li></ol><p>\u5EFA\u8BAE\uFF1A\u5E8F\u53F7\u6700\u597D\u5728\u540E\u53F0\u751F\u6210\uFF0C\u7528\u5E8F\u53F7\u8868\u8FBE\u5F0F\u751F\u6210\u7684\u5E8F\u53F7\u5217\u4F1A\u5360\u7528\u6BD4\u8F83\u5927\u7684\u7A7A\u95F4\uFF0C\u5BF9\u8D44\u6E90\u6709\u6240\u6D6A\u8D39\u3002</p><p>\u8865\u5145</p><ol><li>JavaWeb\u9879\u76EE\u4E2D\u901A\u5E38\u662F\u901A\u8FC7\u6D4F\u89C8\u5668\u4E0B\u8F7D\u7684\u65B9\u5F0F\u6765\u4E0B\u8F7DWord\u6587\u6863\uFF0C\u6B64\u65F6\u53EA\u9700\u8981\u628A\u4E4B\u524D\u4E0B\u8F7D\u5230\u672C\u5730\u7684\u4EE3\u7801\u6539\u6210\u6D4F\u89C8\u5668\u7AEF\u4E0B\u8F7D\u7684\u4EE3\u7801\u5373\u53EF\uFF1A</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>//\u8F93\u51FA\u5230\u672C\u5730\u76EE\u5F55
//FileOutputStream out = new FileOutputStream(new File(&quot;D://\u5546\u54C1\u9500\u552E\u62A5\u8868.docx&quot;));
//report.process(context, out);
 
//\u6D4F\u89C8\u5668\u7AEF\u4E0B\u8F7D
response.setCharacterEncoding(&quot;utf-8&quot;);  
response.setContentType(&quot;application/msword&quot;);  
String fileName = &quot;\u5546\u54C1\u9500\u552E\u62A5\u8868.docx&quot;;  
response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot;  
				    .concat(String.valueOf(URLEncoder.encode(fileName, &quot;UTF-8&quot;))));  
report.process(context, response.getOutputStream());
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Word\u6A21\u677F\u4E2D\u7684\u8868\u683C\u7684\u957F\u5EA6\u6700\u597D\u5145\u6EE1Word\u6587\u6863\u7684\u5DE6\u53F3\u4E24\u8FB9\uFF0C\u5426\u5219\u5982\u679C\u8868\u683C\u4E0B\u9762\u8FD8\u6709\u5176\u4ED6\u6587\u672C\u5185\u5BB9\uFF0C\u4E0B\u9762\u7684\u6587\u672C\u5185\u5BB9\u4F1A\u81EA\u52A8\u586B\u5145\u5230\u8868\u683C\u7684\u7F1D\u9699\u5904\uFF0C\u800C\u4E14\u4F1A\u5BF9\u4E0B\u9762\u7684\u6587\u672C\u5185\u5BB9\u8FDB\u884C\u8986\u76D6\u3002</li></ol><p><strong>\u52A0\u9910</strong> \u5176\u5B9E\uFF0C\u5BFC\u51FAWord\u6A21\u677F\uFF0C\u4E0A\u9762\u7684\u6A21\u677F\u548C\u4EE3\u7801\u5DF2\u7ECF\u591F\u7528\u4E86\uFF0C\u4F46\u4E5F\u6709\u5C11\u6570\u6A21\u677F\u9700\u8981\u6DFB\u52A0\u56FE\u7247\u548C\u56FE\u5F62(\u6BD4\u5982\u997C\u72B6\u56FE)\u3002</p><p><strong>\u5236\u4F5C\u56FE\u7247</strong></p><p>\u56FE\u7247\u7684\u751F\u6210\u4E0D\u4F7F\u7528\u7F16\u8F91\u57DF\uFF0C\u4F7F\u7528\u6A21\u677F\u56FE\u7247\u548CWord\u7684\u4E66\u7B7E\u529F\u80FD\uFF0C\u800C\u4E14\u9700\u8981\u5728\u5143\u6570\u636E\u4E2D\u52A0\u5165\u56FE\u7247\u7C7B\u578B\u7684\u4EE3\u7801\uFF0C\u4EE5\u4E0B\u4E3A\u5177\u4F53\u6B65\u9AA4\uFF1A</p><ol><li>\u5728Word\u6A21\u7248\u4E2D\u9700\u8981\u63D2\u5165\u56FE\u7247\u7684\u4F4D\u7F6E\u63D2\u5165\u4E00\u5F20\u6A21\u7248\u56FE\u7247\uFF0C\u7136\u540E\u9F20\u6807\u5355\u51FB\u6A21\u677F\u56FE\u7247\u63D2\u5165\u4E00\u4E2A\u4E66\u7B7E\uFF0C\u8BBE\u7F6E\u4E66\u7B7E\u540D\u79F0\uFF0C\u6BD4\u5982img1\uFF0C \u6700\u540E\u70B9\u51FB\u3010\u6DFB\u52A0\u3011\u6309\u94AE:</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>![](../../images/.\u751F\u6210word_images/19b0a592.png)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>\u5982\u679C\u9700\u8981\u63D2\u5165\u591A\u4E2A\u56FE\u7247\uFF0C\u5C31\u5728\u9700\u8981\u63D2\u5165\u56FE\u7247\u7684\u4F4D\u7F6E\u63D2\u5165\u591A\u4E2A\u6A21\u677F\u56FE\u7247\u5E76\u63D2\u5165\u4E66\u7B7E\u8BBE\u7F6E\u5BF9\u5E94\u7684\u4E66\u7B7E\u540D\u79F0\u5373\u53EF\uFF0C\u540E\u53F0\u4EE3\u7801\u5982\u4E0B\uFF1A</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImgTest</span> <span class="token punctuation">{</span>
 
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWordForImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWordForImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//\u83B7\u53D6Word\u6A21\u677F\uFF0C\u6A21\u677F\u5B58\u653E\u8DEF\u5F84\u5728\u9879\u76EE\u7684resources\u76EE\u5F55\u4E0B</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/\u56FE\u7247.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6CE8\u518Cxdocreport\u5B9E\u4F8B\u5E76\u52A0\u8F7DFreeMarker\u6A21\u677F\u5F15\u64CE</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> 
                               <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u521B\u5EFAxdocreport\u4E0A\u4E0B\u6587\u5BF9\u8C61</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5143\u6570\u636E\u4E2D\u52A0\u5165\u56FE\u7247</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;img1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;img2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u83B7\u53D6\u56FE\u7247</span>
        <span class="token class-name">InputStream</span> img1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/11.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> img2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/33.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u628A\u56FE\u7247\u6DFB\u52A0\u5230\u4E0A\u4E0B\u6587\u5BF9\u8C61</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;img1&quot;</span><span class="token punctuation">,</span> img1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;img2&quot;</span><span class="token punctuation">,</span> img2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u8F93\u51FA\u5230\u672C\u5730\u76EE\u5F55</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://\u56FE\u7247\u62A5\u8868.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u5BFC\u51FA\u6548\u679C\u5982\u4E0B\uFF1A</li></ol><p>\u5236\u4F5C\u56FE\u5F62 <img src="`+J+'" alt=""> \u8981\u5728Word\u6587\u6863\u4E2D\u751F\u6210\u67F1\u72B6\u56FE\u3001\u997C\u72B6\u56FE\u7B49\u56FE\u5F62\uFF0C\u9700\u8981\u5728\u9879\u76EE\u4E2D\u5F15\u5165\u7B2C\u4E09\u65B9\u7ED8\u56FE\u5DE5\u5177\uFF0C\u5728\u8FD9\u91CC\u4F7F\u7528xchart\u6765\u6F14\u793A\u5728Word\u4E2D\u751F\u6210\u997C\u72B6\u56FE\u56FE\u5F62\u3002</p><p>\u751F\u6210\u997C\u72B6\u56FE\u548C\u751F\u6210\u56FE\u7247\u7684\u65B9\u6CD5\u5F88\u7C7B\u4F3C\uFF0C\u5177\u4F53\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><ol><li><p>\u5728Word\u6A21\u7248\u4E2D\u9700\u8981\u63D2\u5165\u56FE\u7247\u7684\u4F4D\u7F6E\u63D2\u5165\u4E00\u5F20\u6A21\u7248\u56FE\u7247\uFF0C\u7136\u540E\u9F20\u6807\u5355\u51FB\u6A21\u677F\u56FE\u7247\u63D2\u5165\u4E00\u4E2A\u4E66\u7B7E\uFF0C\u8BBE\u7F6E\u4E66\u7B7E\u540D\u79F0\uFF0C\u6BD4\u5982chart\uFF0C\u6700\u540E\u70B9\u51FB\u3010\u6DFB\u52A0\u3011\u6309\u94AE: <img src="'+Q+`" alt=""></p></li><li><p>\u7F16\u5199\u4EE3\u7801:</p></li></ol><p>2.1 \u5728pom.xml\u6587\u4EF6\u4E2D\u6DFB\u52A0xchart\u7684\u4F9D\u8D56:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;org.knowm.xchart&lt;/groupId&gt;
	&lt;artifactId&gt;xchart&lt;/artifactId&gt;
	&lt;version&gt;3.5.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.2 \u540E\u53F0\u4EE3\u7801:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">BitmapEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">PieChart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">PieChartBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>images<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayImageProvider</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChartTest</span> <span class="token punctuation">{</span>
 
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWordForChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWordForChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//\u83B7\u53D6Word\u6A21\u677F\uFF0C\u6A21\u677F\u5B58\u653E\u8DEF\u5F84\u5728\u9879\u76EE\u7684resources\u76EE\u5F55\u4E0B</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/\u997C\u56FE.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u6CE8\u518Cxdocreport\u5B9E\u4F8B\u5E76\u52A0\u8F7DFreeMarker\u6A21\u677F\u5F15\u64CE</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span>                 
                                 <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u521B\u5EFAxdocreport\u4E0A\u4E0B\u6587\u5BF9\u8C61</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//\u5143\u6570\u636E\u4E2D\u52A0\u5165\u56FE\u7247</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;chart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">PieChart</span> chart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PieChartBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">620</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&quot;\u9500\u552E\u997C\u56FE&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u7ED9\u997C\u56FE\u8BBE\u7F6E\u5BF9\u5E94\u7684\u503C</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;\u81ED\u7F8E\u6BC1\u80A4&quot;</span><span class="token punctuation">,</span> <span class="token number">589</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;\u5973\u88C5&quot;</span><span class="token punctuation">,</span> <span class="token number">651</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;\u624B\u673A&quot;</span><span class="token punctuation">,</span> <span class="token number">866</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;\u5BB6\u5C45\u5BB6\u88C5&quot;</span><span class="token punctuation">,</span> <span class="token number">783</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;\u98DF\u7269\u996E\u54C1&quot;</span><span class="token punctuation">,</span> <span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u751F\u6210\u997C\u56FE</span>
        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BitmapEncoder</span><span class="token punctuation">.</span><span class="token function">saveBitmap</span><span class="token punctuation">(</span>chart<span class="token punctuation">,</span> baos<span class="token punctuation">,</span> <span class="token class-name">BitmapEncoder<span class="token punctuation">.</span>BitmapFormat</span><span class="token punctuation">.</span><span class="token constant">JPG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u628A\u997C\u56FE\u6DFB\u52A0\u5230\u4E0A\u4E0B\u6587\u5BF9\u8C61</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;chart&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayImageProvider</span><span class="token punctuation">(</span>baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//\u8F93\u51FA\u5230\u672C\u5730\u76EE\u5F55</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://\u997C\u56FE\u62A5\u8868.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>\u5BFC\u51FA\u6548\u679C\u5982\u4E0B:</li></ol><p><img src="`+K+'" alt=""></p><p>\u603B\u7ED3 \u8FD9\u5C31\u662F\u7528Java\u8BED\u8A00\u5B9E\u73B0\uFF0C\u7ED3\u5408XDocReport\u548CFreeMarker\u6A21\u677F\u5F15\u64CE\u751F\u6210Word\u6587\u6863\u7684\u65B9\u6CD5\u3002\u5E0C\u671B\u80FD\u7ED9\u81F4\u529B\u4E8E\u5F00\u53D1\u7684\u5C0F\u4F19\u4F34\u5E26\u6765\u4E00\u4E1D\u4E1D\u5E2E\u52A9\u3002</p>',61);function ln(un,rn){const a=l("ExternalLinkIcon");return o(),c("div",null,[G,Z,Y,n("p",null,[n("a",$,[s("\u53C2\u8003\u8FDE\u63A5"),t(a)])]),nn,n("p",null,[n("a",sn,[s("\u53C2\u8003\u6587\u7AE0"),t(a)])]),an,n("p",null,[n("a",tn,[s("docx4j\u5F00\u6E90\u5730\u5740"),t(a)])]),n("p",null,[n("a",pn,[s("\u53C2\u8003\u6587\u7AE0-\u5229\u7528docx4j\u5B8C\u7F8E\u5BFC\u51FAword\u6587\u6863\uFF08\u6807\u7B7E\u66FF\u6362\u3001\u63D2\u5165\u56FE\u7247\u3001\u751F\u6210\u8868\u683C\uFF09"),t(a)])]),n("p",null,[n("a",en,[s("\u53C2\u8003\u6587\u7AE0-\u3010docx4j\u3011docx4j\u64CD\u4F5Cdocx\uFF0C\u5B9E\u73B0\u66FF\u6362\u5185\u5BB9\u3001\u8F6C\u6362pdf\u3001html\u7B49\u64CD\u4F5C"),t(a)])]),n("p",null,[n("a",on,[s("docx4j -- \u4F7F\u7528Java\u5904\u7406word2007\uFF08.docx\uFF09\u6587\u6863"),t(a)])]),cn])}const mn=e(V,[["render",ln],["__file","\u751F\u6210word.html.vue"]]);export{mn as default};
