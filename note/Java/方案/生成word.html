<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title>生成word | HONGXU</title><meta name="description" content="个人博客">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.4e4a549b.css">
    <link rel="modulepreload" href="/assets/app.4d667c68.js"><link rel="modulepreload" href="/assets/生成word.html.bcdae325.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/生成word.html.95aed98d.js"><link rel="prefetch" href="/assets/index.html.a2ae31da.js"><link rel="prefetch" href="/assets/fafwfw.html.fb19f8c1.js"><link rel="prefetch" href="/assets/index.html.dced8a1d.js"><link rel="prefetch" href="/assets/FAQ.html.b3df9f36.js"><link rel="prefetch" href="/assets/【Markdown编辑器快捷键】汇总.html.ba090e64.js"><link rel="prefetch" href="/assets/test.html.ece31899.js"><link rel="prefetch" href="/assets/基本命令使用.html.9fcbb84f.js"><link rel="prefetch" href="/assets/算法题整理.html.fca170e3.js"><link rel="prefetch" href="/assets/es和kibana安装配置.html.656faf72.js"><link rel="prefetch" href="/assets/es的基本使用.html.b4c6df75.js"><link rel="prefetch" href="/assets/html知识点整理.html.83a414aa.js"><link rel="prefetch" href="/assets/maven问题整理.html.364b8f73.js"><link rel="prefetch" href="/assets/oauth2的全流程.html.f1fb6e2c.js"><link rel="prefetch" href="/assets/静态方法调用注入bean.html.19bfd7e1.js"><link rel="prefetch" href="/assets/sharding-jdbc.html.87f28d8c.js"><link rel="prefetch" href="/assets/docker搭建环境.html.6f21238d.js"><link rel="prefetch" href="/assets/使用Flyway进行数据库迁移.html.97fd1d2d.js"><link rel="prefetch" href="/assets/Maven实现一键打包部署.html.4ea59e9a.js"><link rel="prefetch" href="/assets/基于jenkins_docker的持续集成环境部署.html.00a505a8.js"><link rel="prefetch" href="/assets/Quartz任务调度框架原理.html.80dc9ee9.js"><link rel="prefetch" href="/assets/Spring MVC之RequestContextHolder和LocaleContextHolder的使用详解以及使用误区.html.d3371f6b.js"><link rel="prefetch" href="/assets/QueryWrapper常用方法.html.67081961.js"><link rel="prefetch" href="/assets/fastjson的使用——JSON字符串、JSON对象、Java对象的互转.html.6ed95081.js"><link rel="prefetch" href="/assets/格式化日期时间.html.6114dd35.js"><link rel="prefetch" href="/assets/集合stream相关操作.html.de0ba4d9.js"><link rel="prefetch" href="/assets/静态方法和泛型.html.27f3703b.js"><link rel="prefetch" href="/assets/docx和doc互转.html.4c3623e4.js"><link rel="prefetch" href="/assets/word转html.html.28971dfa.js"><link rel="prefetch" href="/assets/word转pdf.html.8acedd9b.js"><link rel="prefetch" href="/assets/如何实现定时任务调度.html.ec30ee6d.js"><link rel="prefetch" href="/assets/如何实现接口幂等性.html.b5f98a8f.js"><link rel="prefetch" href="/assets/日志配置文件.html.ab910729.js"><link rel="prefetch" href="/assets/mysql.html.00d7bf11.js"><link rel="prefetch" href="/assets/mysql8.0安装教程(解压版).html.c693637b.js"><link rel="prefetch" href="/assets/Oracle关于date类型的查询方式及效率浅析.html.e1d4b7ab.js"><link rel="prefetch" href="/assets/Oracle相关.html.6269a6be.js"><link rel="prefetch" href="/assets/id自增长方案.html.75f7ae19.js"><link rel="prefetch" href="/assets/oracle时间戳函数及相关操作.html.290edae3.js"><link rel="prefetch" href="/assets/sequence.html.01913139.js"><link rel="prefetch" href="/assets/批量插入数据.html.24a0fa38.js"><link rel="prefetch" href="/assets/dubbo.html.55360f99.js"><link rel="prefetch" href="/assets/gateway.html.f4adc050.js"><link rel="prefetch" href="/assets/nacos.html.a19ee52c.js"><link rel="prefetch" href="/assets/sentinel.html.6cfa5ca1.js"><link rel="prefetch" href="/assets/security使用.html.8c0e1d31.js"><link rel="prefetch" href="/assets/security原理.html.a3199eaa.js"><link rel="prefetch" href="/assets/整合elk.html.2f62cad0.js"><link rel="prefetch" href="/assets/整合es.html.1dc0e47d.js"><link rel="prefetch" href="/assets/整合minio实现文件上传和下载.html.1ebaa1f9.js"><link rel="prefetch" href="/assets/kafka使用.html.668032c1.js"><link rel="prefetch" href="/assets/rabbit安装.html.6245e078.js"><link rel="prefetch" href="/assets/QueryWrapper、LambdaQueryWrapper和LambdaQueryChainWrapper的用法(二).html.3126dc49.js"><link rel="prefetch" href="/assets/UpdateWrapper.html.f21aa8bd.js"><link rel="prefetch" href="/assets/分页.html.7f44a976.js"><link rel="prefetch" href="/assets/基础用法.html.53bfaf7d.js"><link rel="prefetch" href="/assets/批量插入.html.204f7f52.js"><link rel="prefetch" href="/assets/404.html.c5de7dd9.js"><link rel="prefetch" href="/assets/index.html.2f713335.js"><link rel="prefetch" href="/assets/index.html.1a811f74.js"><link rel="prefetch" href="/assets/index.html.79fe6d6e.js"><link rel="prefetch" href="/assets/index.html.dcd15e89.js"><link rel="prefetch" href="/assets/index.html.e8952663.js"><link rel="prefetch" href="/assets/index.html.5ad7ff00.js"><link rel="prefetch" href="/assets/index.html.92637d35.js"><link rel="prefetch" href="/assets/index.html.7e924de7.js"><link rel="prefetch" href="/assets/index.html.5b971275.js"><link rel="prefetch" href="/assets/index.html.a99d180d.js"><link rel="prefetch" href="/assets/index.html.fb16b232.js"><link rel="prefetch" href="/assets/index.html.0f8c6f75.js"><link rel="prefetch" href="/assets/fafwfw.html.9418a6e5.js"><link rel="prefetch" href="/assets/index.html.67148146.js"><link rel="prefetch" href="/assets/FAQ.html.be7774a6.js"><link rel="prefetch" href="/assets/【Markdown编辑器快捷键】汇总.html.a3551968.js"><link rel="prefetch" href="/assets/test.html.c0403a27.js"><link rel="prefetch" href="/assets/基本命令使用.html.403e251d.js"><link rel="prefetch" href="/assets/算法题整理.html.facf7e00.js"><link rel="prefetch" href="/assets/es和kibana安装配置.html.dfb75cf7.js"><link rel="prefetch" href="/assets/es的基本使用.html.78444edf.js"><link rel="prefetch" href="/assets/html知识点整理.html.f1b5256a.js"><link rel="prefetch" href="/assets/maven问题整理.html.30f07f85.js"><link rel="prefetch" href="/assets/oauth2的全流程.html.7e9aec60.js"><link rel="prefetch" href="/assets/静态方法调用注入bean.html.1879f8c9.js"><link rel="prefetch" href="/assets/sharding-jdbc.html.545194d8.js"><link rel="prefetch" href="/assets/docker搭建环境.html.0090b063.js"><link rel="prefetch" href="/assets/使用Flyway进行数据库迁移.html.7969cb27.js"><link rel="prefetch" href="/assets/Maven实现一键打包部署.html.d3916189.js"><link rel="prefetch" href="/assets/基于jenkins_docker的持续集成环境部署.html.4fefae77.js"><link rel="prefetch" href="/assets/Quartz任务调度框架原理.html.983d8374.js"><link rel="prefetch" href="/assets/Spring MVC之RequestContextHolder和LocaleContextHolder的使用详解以及使用误区.html.d0e7a91a.js"><link rel="prefetch" href="/assets/QueryWrapper常用方法.html.1d04aeaa.js"><link rel="prefetch" href="/assets/fastjson的使用——JSON字符串、JSON对象、Java对象的互转.html.f7aedb9d.js"><link rel="prefetch" href="/assets/格式化日期时间.html.bd9e24ed.js"><link rel="prefetch" href="/assets/集合stream相关操作.html.5d829b4f.js"><link rel="prefetch" href="/assets/静态方法和泛型.html.7d92d90f.js"><link rel="prefetch" href="/assets/docx和doc互转.html.027e2780.js"><link rel="prefetch" href="/assets/word转html.html.b8c060cf.js"><link rel="prefetch" href="/assets/word转pdf.html.208c3faa.js"><link rel="prefetch" href="/assets/如何实现定时任务调度.html.90e39dd1.js"><link rel="prefetch" href="/assets/如何实现接口幂等性.html.b4c7cc49.js"><link rel="prefetch" href="/assets/日志配置文件.html.23ba4e84.js"><link rel="prefetch" href="/assets/mysql.html.53f21f6e.js"><link rel="prefetch" href="/assets/mysql8.0安装教程(解压版).html.0b7ed189.js"><link rel="prefetch" href="/assets/Oracle关于date类型的查询方式及效率浅析.html.f034dc09.js"><link rel="prefetch" href="/assets/Oracle相关.html.21feb8c9.js"><link rel="prefetch" href="/assets/id自增长方案.html.b87477b7.js"><link rel="prefetch" href="/assets/oracle时间戳函数及相关操作.html.e3d7b56b.js"><link rel="prefetch" href="/assets/sequence.html.e2a339bc.js"><link rel="prefetch" href="/assets/批量插入数据.html.0a289a1e.js"><link rel="prefetch" href="/assets/dubbo.html.316b69fc.js"><link rel="prefetch" href="/assets/gateway.html.5f6eb9b8.js"><link rel="prefetch" href="/assets/nacos.html.81ce69c5.js"><link rel="prefetch" href="/assets/sentinel.html.a994e5f2.js"><link rel="prefetch" href="/assets/security使用.html.840423d8.js"><link rel="prefetch" href="/assets/security原理.html.2cb58ad2.js"><link rel="prefetch" href="/assets/整合elk.html.5ea6e37a.js"><link rel="prefetch" href="/assets/整合es.html.78aba307.js"><link rel="prefetch" href="/assets/整合minio实现文件上传和下载.html.90252f2b.js"><link rel="prefetch" href="/assets/kafka使用.html.7941cb77.js"><link rel="prefetch" href="/assets/rabbit安装.html.085e5255.js"><link rel="prefetch" href="/assets/QueryWrapper、LambdaQueryWrapper和LambdaQueryChainWrapper的用法(二).html.34b4322d.js"><link rel="prefetch" href="/assets/UpdateWrapper.html.92cf4e7c.js"><link rel="prefetch" href="/assets/分页.html.76fcd1e0.js"><link rel="prefetch" href="/assets/基础用法.html.3ce5c230.js"><link rel="prefetch" href="/assets/批量插入.html.895d4ad1.js"><link rel="prefetch" href="/assets/404.html.ec44aeb3.js"><link rel="prefetch" href="/assets/index.html.9191a9cd.js"><link rel="prefetch" href="/assets/index.html.c40b2015.js"><link rel="prefetch" href="/assets/index.html.2e16174c.js"><link rel="prefetch" href="/assets/index.html.e8b4d9fb.js"><link rel="prefetch" href="/assets/index.html.915b6ad9.js"><link rel="prefetch" href="/assets/index.html.195f978b.js"><link rel="prefetch" href="/assets/index.html.6fa4b8e4.js"><link rel="prefetch" href="/assets/index.html.0cce01dd.js"><link rel="prefetch" href="/assets/index.html.2ec3a18a.js"><link rel="prefetch" href="/assets/index.html.b142fe4a.js"><link rel="prefetch" href="/assets/index.html.f86f5ce1.js"><link rel="prefetch" href="/assets/mermaid.core.5ea15c44.js"><link rel="prefetch" href="/assets/photoswipe.esm.720e8656.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/images/logo.jpeg" alt="HONGXU"><!----><span class="site-name hide-in-pad">HONGXU</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="主页"><!---->主页<!----></a></div><div class="nav-item hide-in-mobile"><a href="/guide/fafwfw.html" class="nav-link" aria-label="向导"><!---->向导<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/easywhx/learning" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/note/FAQ.html" class="nav-link sidebar-link sidebar-page" aria-label="FAQ"><!---->FAQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/%E3%80%90Markdown%E7%BC%96%E8%BE%91%E5%99%A8%E5%BF%AB%E6%8D%B7%E9%94%AE%E3%80%91%E6%B1%87%E6%80%BB.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown快捷键"><!---->Markdown快捷键<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">database</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">elasticsearch</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">algorithm</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">html</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">JAVA</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">原理</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">基础知识整理</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">方案</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/docx%E5%92%8Cdoc%E4%BA%92%E8%BD%AC.html" class="nav-link sidebar-link sidebar-page" aria-label="docx和doc互转"><!---->docx和doc互转<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/word%E8%BD%AChtml.html" class="nav-link sidebar-link sidebar-page" aria-label="word转html"><!---->word转html<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/word%E8%BD%ACpdf.html" class="nav-link sidebar-link sidebar-page" aria-label="word转pdf"><!---->word转pdf<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6.html" class="nav-link sidebar-link sidebar-page" aria-label="定时任务"><!---->定时任务<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="接口幂等"><!---->接口幂等<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="生成word"><!---->生成word<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案1-利用html格式的模板实现" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="方案1. 利用html格式的模板实现"><!---->方案1. 利用html格式的模板实现<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案2-利用xml格式的模板实现-生成的是转换过的xml格式的word文档-不是原生的" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="方案2. 利用xml格式的模板实现(生成的是转换过的xml格式的word文档，不是原生的)"><!---->方案2. 利用xml格式的模板实现(生成的是转换过的xml格式的word文档，不是原生的)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案3-利用xml格式的文件作为模板-新建docx格式的模板-另存为zip-以压缩文件中的document-xml文件制作模板-生成的文件是原生的word" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="方案3，利用xml格式的文件作为模板(新建docx格式的模板，另存为zip,以压缩文件中的document.xml文件制作模板，生成的文件是原生的word)"><!---->方案3，利用xml格式的文件作为模板(新建docx格式的模板，另存为zip,以压缩文件中的document.xml文件制作模板，生成的文件是原生的word)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案4-利用docx4j实现" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="方案4，利用docx4j实现"><!---->方案4，利用docx4j实现<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案4-通过xdocreport和freemarker模板引擎生成word文档" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="方案4，通过XDocReport和FreeMarker模板引擎生成Word文档"><!---->方案4，通过XDocReport和FreeMarker模板引擎生成Word文档<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">日志</span><span class="arrow right"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Linux</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">maven</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Oauth2</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Spring</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">消息中间件</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">环境搭建</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">分库分表</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">迁移</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">项目部署</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">go</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">web</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">中间件</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">前端</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">应用方案</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">数据库</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">服务器环境</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">架构</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">网络通信</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->生成word</h1><div class="page-info"><span class="author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">HONGXU</span></span><span property="author" content="HONGXU"></span></span><!----><span class="date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022年12月25日</span><meta property="datePublished" content="2022-12-25T15:22:16.000Z"></span><!----><!----><span class="reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 29 分钟</span><meta property="timeRequired" content="PT29M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案1-利用html格式的模板实现" class="router-link-active router-link-exact-active toc-link level3">方案1. 利用html格式的模板实现</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案2-利用xml格式的模板实现-生成的是转换过的xml格式的word文档-不是原生的" class="router-link-active router-link-exact-active toc-link level3">方案2. 利用xml格式的模板实现(生成的是转换过的xml格式的word文档，不是原生的)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案3-利用xml格式的文件作为模板-新建docx格式的模板-另存为zip-以压缩文件中的document-xml文件制作模板-生成的文件是原生的word" class="router-link-active router-link-exact-active toc-link level3">方案3，利用xml格式的文件作为模板(新建docx格式的模板，另存为zip,以压缩文件中的document.xml文件制作模板，生成的文件是原生的word)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案4-利用docx4j实现" class="router-link-active router-link-exact-active toc-link level3">方案4，利用docx4j实现</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#方案4-通过xdocreport和freemarker模板引擎生成word文档" class="router-link-active router-link-exact-active toc-link level3">方案4，通过XDocReport和FreeMarker模板引擎生成Word文档</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="生成word" tabindex="-1"><a class="header-anchor" href="#生成word" aria-hidden="true">#</a> 生成word</h1><h3 id="方案1-利用html格式的模板实现" tabindex="-1"><a class="header-anchor" href="#方案1-利用html格式的模板实现" aria-hidden="true">#</a> 方案1. 利用html格式的模板实现</h3><ol><li>创建word模板，另存为html格式的文件</li><li>设置ftl模板的指令，保存为freemarker格式的文件</li><li>利用模板引擎进行数据填充渲染，返回文件流</li><li>将填充好数据的html格式的文件流处理转换为word文件</li></ol><p><a href="https://blog.csdn.net/gaojie_csdn/article/details/122244262" target="_blank" rel="noopener noreferrer">参考连接<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="实现方式1-使用apache-poi的poifs-api来实现" tabindex="-1"><a class="header-anchor" href="#实现方式1-使用apache-poi的poifs-api来实现" aria-hidden="true">#</a> 实现方式1 使用Apache POI的POIFS API来实现：</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>common<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">Template</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">StringEscapeUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>poifs<span class="token punctuation">.</span>filesystem<span class="token punctuation">.</span></span><span class="token class-name">DirectoryEntry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>poifs<span class="token punctuation">.</span>filesystem<span class="token punctuation">.</span></span><span class="token class-name">POIFSFileSystem</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ClassPathResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HtmlUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordUtils</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * html字符串生成word
     * <span class="token keyword">@param</span> <span class="token parameter">content</span> html字符串
     * <span class="token keyword">@param</span> <span class="token parameter">filePath</span> 生成文件的路径
     * <span class="token keyword">@param</span> <span class="token parameter">fileName</span> 文件名称
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span> filePath<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ClassPathResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//输出文件</span>
            <span class="token class-name">String</span> dir <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fileAbsolutePath <span class="token operator">=</span> dir <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> fileName <span class="token operator">+</span> <span class="token string">&quot;_&quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileAbsolutePath<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                fileAbsolutePath <span class="token operator">+=</span> <span class="token string">&quot;.docx&quot;</span><span class="token punctuation">;</span>
            <span class="token class-name">File</span> outFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>fileAbsolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//如果输出目标文件夹不存在，则创建</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>outFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                outFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            content <span class="token operator">=</span> <span class="token class-name">HtmlUtils</span><span class="token punctuation">.</span><span class="token function">htmlUnescape</span><span class="token punctuation">(</span><span class="token class-name">StringEscapeUtils</span><span class="token punctuation">.</span><span class="token function">unescapeHtml</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//格式化html</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> by <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteArrayInputStream</span> byteArrayInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">POIFSFileSystem</span> poifsFileSystem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">POIFSFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">DirectoryEntry</span> directory <span class="token operator">=</span> poifsFileSystem<span class="token punctuation">.</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            directory<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token string">&quot;WordDocument&quot;</span><span class="token punctuation">,</span> byteArrayInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fileAbsolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            poifsFileSystem<span class="token punctuation">.</span><span class="token function">writeFilesystem</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            byteArrayInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> fileAbsolutePath<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * 生成html字符串
     * <span class="token keyword">@param</span> <span class="token parameter">dataMap</span> 数据集
     * <span class="token keyword">@param</span> <span class="token parameter">templateName</span> 模板名称
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createHtml</span><span class="token punctuation">(</span><span class="token class-name">Map</span> dataMap<span class="token punctuation">,</span> <span class="token class-name">String</span> templatePath<span class="token punctuation">,</span> <span class="token class-name">String</span> templateName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TemplateException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>templateName<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.ftl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                templateName <span class="token operator">+=</span> <span class="token string">&quot;.ftl&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">//创建配置实例 </span>
            <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//设置编码</span>
            configuration<span class="token punctuation">.</span><span class="token function">setDefaultEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            configuration<span class="token punctuation">.</span><span class="token function">setClassForTemplateLoading</span><span class="token punctuation">(</span><span class="token class-name">WordUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> templatePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//获取模板 </span>
            <span class="token class-name">Template</span> template <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>templateName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//将模板和数据模型合并生成文件</span>
            <span class="token class-name">StringWriter</span> stringWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//生成html</span>
            template<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> stringWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> stringWriter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> ie<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TemplateException</span> te<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> te<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span> dataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;名称&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> dataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span> dataItem1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;第一行&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;13&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span> dataItem2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;第二行&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;21&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;22&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;23&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span> dataItem3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;第三行&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;31&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;32&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;33&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;dataList&quot;</span><span class="token punctuation">,</span> dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> html <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            html <span class="token operator">=</span> <span class="token function">createHtml</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> <span class="token string">&quot;/word-templates&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test.ftl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">createWord</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">&quot;/word-templates&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现方式2-docx4j实现html转word" tabindex="-1"><a class="header-anchor" href="#实现方式2-docx4j实现html转word" aria-hidden="true">#</a> 实现方式2：docx4j实现html转word</h4><p><strong>参考代码1：</strong></p><p>在pom.xml里，添加docx4j的maven依赖</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-JAXB-ReferenceImpl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-ImportXHTML<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>bind<span class="token punctuation">.</span></span><span class="token class-name">JAXBException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>in<span class="token punctuation">.</span>xhtml<span class="token punctuation">.</span></span><span class="token class-name">XHTMLImporterImpl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>jaxb<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">Docx4JException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>packages<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingMLPackage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">DocumentSettingsPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">FooterPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">HeaderPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">MainDocumentPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">NumberingDefinitionsPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>relationships<span class="token punctuation">.</span></span><span class="token class-name">Relationship</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">CTCompat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">FldChar</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">FooterReference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Ftr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Hdr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">HdrFtrRef</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">HeaderReference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Jc</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">JcEnumeration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">ObjectFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">P</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">PPr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">STFldCharType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">SectPr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Text</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Html2DocxService</span> <span class="token punctuation">{</span>

    <span class="token comment">// Factory for creating WML Object.</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ObjectFactory</span> factory <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token function">getWmlObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * Convert HTML to DOCX(OPENXML).
     * 
     * <span class="token keyword">@param</span> <span class="token parameter">html</span> the source, a HTML file
     * <span class="token keyword">@param</span> <span class="token parameter">docx</span> the target, a DOCX file
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">File</span> html<span class="token punctuation">,</span> <span class="token class-name">File</span> docx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Creates a WordprocessingMLPackage, using default page size and orientation,</span>
            <span class="token comment">// default to A4 portrait.</span>
            <span class="token class-name">WordprocessingMLPackage</span> pack <span class="token operator">=</span> <span class="token class-name">WordprocessingMLPackage</span><span class="token punctuation">.</span><span class="token function">createPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">NumberingDefinitionsPart</span> numDefPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NumberingDefinitionsPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pack<span class="token punctuation">.</span><span class="token function">getMainDocumentPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>numDefPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            numDefPart<span class="token punctuation">.</span><span class="token function">unmarshalDefaultNumbering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Convert XHTML + CSS to WordML content.</span>
            <span class="token comment">// XHTML must be well formed XML.</span>
            <span class="token class-name">XHTMLImporterImpl</span> importer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XHTMLImporterImpl</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Convert the well formed XHTML contained in file to a list of WML objects.</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> importer<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">MainDocumentPart</span> mainPart <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">getMainDocumentPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Add all WML objects to MainDocumentPart.</span>
            mainPart<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// create footer</span>
            <span class="token class-name">Ftr</span> footer <span class="token operator">=</span> <span class="token function">createFooterWithPageNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FooterPart</span> footerPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FooterPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerPart<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerPart<span class="token punctuation">.</span><span class="token function">setJaxbElement</span><span class="token punctuation">(</span>footer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Relationship</span> footerRelation <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>footerPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FooterReference</span> footerRef <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFooterReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerRef<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>footerRelation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerRef<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">HdrFtrRef</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SectPr</span> sectPr <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">getDocumentModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSectPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sectPr<span class="token punctuation">.</span><span class="token function">getEGHdrFtrReferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>footerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// create header</span>
            <span class="token class-name">Hdr</span> header <span class="token operator">=</span> <span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token string">&quot;北京****科技有限公司&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HeaderPart</span> headerPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HeaderPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerPart<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerPart<span class="token punctuation">.</span><span class="token function">setJaxbElement</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Relationship</span> headerRelation <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>headerPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HeaderReference</span> headerRef <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createHeaderReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerRef<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>headerRelation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerRef<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">HdrFtrRef</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sectPr<span class="token punctuation">.</span><span class="token function">getEGHdrFtrReferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>headerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// set compatibilityMode to 15</span>
            <span class="token comment">// to avoid Word 365/2016 saying &quot;Compatibility Mode&quot;</span>
            <span class="token class-name">DocumentSettingsPart</span> settingsPart <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">getDocumentSettingsPart</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CTCompat</span> compat <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token function">getWmlObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createCTCompat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            compat<span class="token punctuation">.</span><span class="token function">setCompatSetting</span><span class="token punctuation">(</span><span class="token string">&quot;compatibilityMode&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://schemas.microsoft.com/office/word&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            settingsPart<span class="token punctuation">.</span><span class="token function">getContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCompat</span><span class="token punctuation">(</span>compat<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// save to a file</span>
            pack<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>docx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Docx4JException</span> <span class="token operator">|</span> <span class="token class-name">JAXBException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token string">&quot;covert html to docx error.&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// create a header</span>
    <span class="token keyword">private</span> <span class="token class-name">Hdr</span> <span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Hdr</span> header <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createHdr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">P</span> paragraph <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PPr</span> ppr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createPPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jc</span> jc <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createJc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jc<span class="token punctuation">.</span><span class="token function">setVal</span><span class="token punctuation">(</span><span class="token class-name">JcEnumeration</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ppr<span class="token punctuation">.</span><span class="token function">setJc</span><span class="token punctuation">(</span>jc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">setPPr</span><span class="token punctuation">(</span>ppr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Text</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
        header<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> header<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// create a header with page number</span>
    <span class="token keyword">private</span> <span class="token class-name">Ftr</span> <span class="token function">createFooterWithPageNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ftr</span> ftr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">P</span> paragraph <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PPr</span> ppr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createPPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jc</span> jc <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createJc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jc<span class="token punctuation">.</span><span class="token function">setVal</span><span class="token punctuation">(</span><span class="token class-name">JcEnumeration</span><span class="token punctuation">.</span><span class="token constant">RIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ppr<span class="token punctuation">.</span><span class="token function">setJc</span><span class="token punctuation">(</span>jc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">setPPr</span><span class="token punctuation">(</span>ppr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addFieldBegin</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addPageNumberField</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addFieldEnd</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ftr<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ftr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addPageNumberField</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Text</span> txt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        txt<span class="token punctuation">.</span><span class="token function">setSpace</span><span class="token punctuation">(</span><span class="token string">&quot;preserve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        txt<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot; PAGE   \* ArabicDash &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span><span class="token function">createRInstrText</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFieldBegin</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FldChar</span> fldChar <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFldChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fldChar<span class="token punctuation">.</span><span class="token function">setFldCharType</span><span class="token punctuation">(</span><span class="token class-name">STFldCharType</span><span class="token punctuation">.</span><span class="token constant">BEGIN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fldChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFieldEnd</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FldChar</span> fldChar <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFldChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fldChar<span class="token punctuation">.</span><span class="token function">setFldCharType</span><span class="token punctuation">(</span><span class="token class-name">STFldCharType</span><span class="token punctuation">.</span><span class="token constant">END</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fldChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HTML2DocxException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">436242367279880231L</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">,</span> <span class="token keyword">boolean</span> enableSuppression<span class="token punctuation">,</span>
                <span class="token keyword">boolean</span> writableStackTrace<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">,</span> enableSuppression<span class="token punctuation">,</span> writableStackTrace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>测试代码：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">HTML_FILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;/xxx/test.html&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DOCX_FILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;/xxx/test.docx&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Html2DocxService</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Html2DocxService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        service<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token constant">HTML_FILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token constant">DOCX_FILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>待转换的示例的HTML，注意该HTML一定要满足XHTML格式，即标签必须正确嵌套，且标签必须被关闭</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Strict//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
&lt;html lang=&quot;zh&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;title&gt;HTML转DOCX测试示例&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
h1 {
	text-align: center;
}
table {
	border-collapse: collapse;
	width: 100%;
}
table th {
	text-align: center;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div&gt;
		&lt;h1&gt;HTML转DOCX测试示例&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;table border=&quot;1&quot;&gt;
			&lt;tr&gt;
				&lt;th width=&quot;20%&quot;&gt;编号：&lt;/th&gt;
				&lt;td&gt;E125800&lt;/td&gt;
				&lt;th width=&quot;20%&quot;&gt;日期：&lt;/th&gt;
				&lt;td&gt;2020-01-10&lt;/td&gt;
			&lt;/tr&gt;
			&lt;tr&gt;
				&lt;th width=&quot;20%&quot;&gt;审核：&lt;/th&gt;
				&lt;td&gt;审核人&lt;/td&gt;
				&lt;th width=&quot;20%&quot;&gt;部门：&lt;/th&gt;
				&lt;td&gt;技术部&lt;/td&gt;
			&lt;/tr&gt;
		&lt;/table&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;以下为示例内容。&lt;/p&gt;
		&lt;h2&gt;醉花阴·薄雾浓云愁永昼&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;李清照&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;薄雾浓云愁永昼，瑞脑销金兽。佳节又重阳，玉枕纱厨，半夜凉初透。&lt;br /&gt;东篱把酒黄昏后，有暗香盈袖。莫道不销魂，帘卷西风，人比黄花瘦。&lt;/p&gt;
		&lt;h2&gt;念奴娇·赤壁怀古&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;苏轼&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;大江东去，浪淘尽，千古风流人物。&lt;br /&gt;故垒西边，人道是，三国周郎赤壁。&lt;br /&gt;乱石穿空，惊涛拍岸，卷起千堆雪。&lt;br /&gt;江山如画，一时多少豪杰。&lt;br /&gt;遥想公瑾当年，小乔初嫁了，雄姿英发。&lt;br /&gt;羽扇纶巾，谈笑间，樯橹灰飞烟灭。&lt;br /&gt;故国神游，多情应笑我，早生华发。&lt;br /&gt;人生如梦，一尊还酹江月。&lt;/p&gt;
		&lt;h2&gt;登飞来峰&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;王安石&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;飞来山上千寻塔，闻说鸡鸣见日升。&lt;br /&gt;不畏浮云遮望眼，只缘身在最高层。&lt;/p&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;网络图片&lt;/p&gt;
		&lt;img src=&quot;https://www.baidu.com/img/flexible/logo/pc/result.png&quot; alt=&quot;百度LOGO&quot; /&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;以下为列表。&lt;/p&gt;
		&lt;p&gt;&lt;strong&gt;无序列表：&lt;/strong&gt;&lt;/p&gt;
		&lt;ul&gt;
			&lt;li&gt;无序列表项一&lt;/li&gt;
			&lt;li&gt;无序列表项二&lt;/li&gt;
			&lt;li&gt;无序列表项三&lt;/li&gt;
			&lt;li&gt;无序列表项四&lt;/li&gt;
			&lt;li&gt;无序列表项五&lt;/li&gt;
		&lt;/ul&gt;
		&lt;p&gt;&lt;strong&gt;有序列表：&lt;/strong&gt;&lt;/p&gt;
		&lt;ol&gt;
			&lt;li&gt;有序列表项一&lt;/li&gt;
			&lt;li&gt;有序列表项二&lt;/li&gt;
			&lt;li&gt;有序列表项三&lt;/li&gt;
			&lt;li&gt;有序列表项四&lt;/li&gt;
			&lt;li&gt;有序列表项五&lt;/li&gt;
		&lt;/ol&gt;
		&lt;p&gt;&lt;strong&gt;嵌套列表：&lt;/strong&gt;&lt;/p&gt;
		&lt;ol&gt;
			&lt;li&gt;有序列表项一&lt;/li&gt;
			&lt;li&gt;有序列表项二&lt;/li&gt;
			&lt;li&gt;有序列表项三
				&lt;ol style=&quot;list-style: lower-alpha;&quot;&gt;
					&lt;li&gt;列表项三的子项1&lt;/li&gt;
					&lt;li&gt;列表项三的子项2&lt;/li&gt;
					&lt;li&gt;列表项三的子项3&lt;/li&gt;
					&lt;li&gt;列表项三的子项4&lt;/li&gt;
					&lt;li&gt;列表项三的子项5&lt;/li&gt;
				&lt;/ol&gt;
			&lt;/li&gt;
			&lt;li&gt;有序列表项四&lt;/li&gt;
			&lt;li&gt;有序列表项五&lt;/li&gt;
		&lt;/ol&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>转化后的Word文档如下：</p><p><img src="/assets/4112b3c1.6d50ed3f.png" alt=""><img src="/assets/8da0ed71.7bf88aa2.png" alt=""><img src="/assets/d34c94c7.c0c12793.png" alt=""></p><p><strong>参考代码2：</strong></p><p>引入依赖</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-ImportXHTML&lt;/artifactId&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码实现：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>StopWatch stopWatch = new StopWatch();
stopWatch.start(&quot;task1&quot;);
WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.createPackage();
MainDocumentPart mdp = wordMLPackage.getMainDocumentPart();
String xhtml = &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;task1&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;长大上课了!&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;;
mdp.addAltChunk(AltChunkType.Xhtml, xhtml.getBytes());
WordprocessingMLPackage pkgOut = mdp.convertAltChunks();
XmlUtils.marshaltoString(pkgOut.getMainDocumentPart().getJaxbElement(), true, true)
pkgOut.save(new java.io.File(System.getProperty(&quot;user.dir&quot;) + &quot;/test.docx&quot;));
System.out.println(stopWatch.currentTaskName());
stopWatch.stop();
System.out.println(stopWatch.getLastTaskTimeMillis());
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="实现方式3-使用openhtmltopdf开源框架-https-github-com-danfickle-openhtmltopdf" tabindex="-1"><a class="header-anchor" href="#实现方式3-使用openhtmltopdf开源框架-https-github-com-danfickle-openhtmltopdf" aria-hidden="true">#</a> 实现方式3：使用openhtmltopdf开源框架（https://github.com/danfickle/openhtmltopdf）</h4><p>pom.xml引入</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- ALWAYS required. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Required for PDF output. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-pdfbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Required for image output only. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-java2d<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need right-to-left or bi-directional text support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-rtl-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need HTML5 parsing support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-jsoup-dom-converter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need logging via slf4j. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need logging via log4j. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need SVG support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-svg-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need MathML support. --&gt;</span>
    <span class="token comment">&lt;!-- Introduced in RC-13. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-mathml-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>代码使用</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class OpenHtmlToPDF {
    public static void main(String[] args) {
        try (OutputStream os = new FileOutputStream(&quot;F://pdf//pdfbox//out3.pdf&quot;)) { // 输出的pdf
            PdfRendererBuilder builder = new PdfRendererBuilder();
            builder.useFastMode();
            //下面这个方法是要自己指定 字体文件   不然转出的pdf文件中 中文会变成####
            builder.useFont(new FSSupplier&lt;InputStream&gt;() {
                @Override
                public InputStream supply() {
                    try {
                        //指定 字体文件
                        return new FileInputStream(&quot;F://pdf//pdfbox//simhei.ttf&quot;);
                    } catch (FileNotFoundException e) {
                        e.printStackTrace();
                    }
                    return null;
                }
            }, &quot;simhei&quot;, 400, BaseRendererBuilder.FontStyle.NORMAL, true); //第二个参数 一定要和文件名一样！！作用在html页面上  
            builder.withHtmlContent(readTxt(&quot;F://pdf//pdfbox//pdf-css3.html&quot;),                              
 
            Surrogate.Generator.class.getResource(&quot;/root.htm&quot;).toExternalForm());
            //第一个参数是html页面  第二个参数 是一个全空的文件 里面什么都没有 但是后缀一定要是。htm  作用类似于一个画板 如果不添加这个参数或者置为null 则html文件中的图片 不会转化 所以一定需要加 
 
 
            builder.toStream(os);
            builder.run();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>html页面注意事项</p><p>1.关于字体 。</p><p>如果自己指定字体文件，那么要在html页面上 加入</p><pre><code>&lt;style&gt;
* {
  font-family: &#39;simhei&#39;;   //value是指定字体时 第二个参数
}
&lt;/style&gt;
</code></pre><p>2.标签一定要有闭合 不然会解析失败</p><h4 id="实现方式4-使用spire-doc-jar" tabindex="-1"><a class="header-anchor" href="#实现方式4-使用spire-doc-jar" aria-hidden="true">#</a> 实现方式4：使用Spire.Doc.jar</h4><p>在编辑代码前，请先在程序中导入Spire.Doc.jar，导入方法如下：</p><p>方法1：将Free Spire.Doc for Java包 下载 到本地，解压，找到lib文件夹下的Spire.Doc.jar文件。然后在IDEA中打开“Project Structure”界面，然后执行如图步骤来手动导入本地路径下的jar文件：</p><p><img src="/assets/0bc3ebcd.6c630f46.png" alt=""></p><p>方法2：通过 Maven仓库 下载导入，如下配置pom.xml：</p><pre><code>&lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;com.e-iceblue&lt;/id&gt;
            &lt;name&gt;e-iceblue&lt;/name&gt;
            &lt;url&gt;https://repo.e-iceblue.cn/repository/maven-public/&lt;/url&gt;
        &lt;/repository&gt;
&lt;/repositories&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;e-iceblue&lt;/groupId&gt;
        &lt;artifactId&gt;spire.doc.free&lt;/artifactId&gt;
        &lt;version&gt;5.2.0&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><p>完成导入后，执行如下代码来转换：</p><p>Java</p><pre><code>import com.spire.doc.*;
import com.spire.doc.documents.XHTMLValidationType;

public class HTMLtoWord {
public static void main(String[] args) {
//加载html文件
Document doc = new Document();
doc.loadFromFile(&quot;F:\\IDEAProject\\Conversion_Doc\\暴雨避险指南.html&quot;, FileFormat.Html, XHTMLValidationType.None);

        //保存为Word格式到指定路径
        doc.saveToFile(&quot;htmltoWord.docx&quot;,FileFormat.Docx_2013);
    }
}
</code></pre><p><img src="/assets/3787b61a.9fadfbb8.png" alt=""><img src="/assets/265896b3.34b648f0.png" alt=""></p><h3 id="方案2-利用xml格式的模板实现-生成的是转换过的xml格式的word文档-不是原生的" tabindex="-1"><a class="header-anchor" href="#方案2-利用xml格式的模板实现-生成的是转换过的xml格式的word文档-不是原生的" aria-hidden="true">#</a> 方案2. 利用xml格式的模板实现(生成的是转换过的xml格式的word文档，不是原生的)</h3><ol><li>创建word模板，另存为xml格式</li><li>在填充的地方设置ftl指令，保存为freemarker格式的文件</li><li>利用模板引擎进行数据填充渲染，返回文件流</li><li>将文件流直接保存为doc或者docx</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>        //加载FTL模板所用到的APi
        Configuration configuration = new Configuration(new Version(&quot;2.3.23&quot;));
        configuration.setDefaultEncoding(&quot;utf-8&quot;);
        configuration.setClassForTemplateLoading(this.getClass(), &quot;/&quot;);
 
 
        //以utf-8的编码读取ftl文件
        Template template = null;
 
        try {
            template = configuration.getTemplate(&quot;学生信息.ftl&quot;, &quot;utf-8&quot;);
        } catch (IOException ex) {
            throw new Exception(&quot;读取ftl文件失败!&quot;, ex);
        }
        Writer writer  = null;
 
 
        // 4.生成 Word文档的全路径名称
        File outFile = new File(&quot;学生信息.docx&quot;);
        writer = new OutputStreamWriter(new FileOutputStream(outFile), &quot;utf-8&quot;);
        // 6.装载数据
        template.process(map, writer);
        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;);
        response.setHeader(&quot;Content-Dispostion&quot;,&quot;attachment;filename=&quot;+&quot;学生信息.docx&quot;);
        // 7.读取生成好的 Word文档
        File file = new File(&quot;学生信息.docx&quot;);
        FileInputStream is = new FileInputStream(file);
        OutputStream os = response.getOutputStream();
        byte[] b = new byte[1024];
        int length;
        while ((length = is.read(b)) &gt; 0) {
            os.write(b, 0, length);
        }
 
        os.flush();
        os.close();
        writer.flush();
        writer.close();
        return null;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>分页符</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;#--Word分页符--&gt;
&lt;w:p &gt;&lt;w:r&gt;&lt;w:br w:type=&quot;page&quot; /&gt;&lt;/w:r&gt;&lt;/w:p&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="方案3-利用xml格式的文件作为模板-新建docx格式的模板-另存为zip-以压缩文件中的document-xml文件制作模板-生成的文件是原生的word" tabindex="-1"><a class="header-anchor" href="#方案3-利用xml格式的文件作为模板-新建docx格式的模板-另存为zip-以压缩文件中的document-xml文件制作模板-生成的文件是原生的word" aria-hidden="true">#</a> 方案3，利用xml格式的文件作为模板(新建docx格式的模板，另存为zip,以压缩文件中的document.xml文件制作模板，生成的文件是原生的word)</h3><p>docx文件模板创建 首先，我们在桌面正常创建一个docx文件 <img src="/assets/bcbe62ac.a6f3caf7.png" alt=""> 然后打开这个docx文件，将你需要的基础模板填入这个文档 <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwUAAAC4CAIAAAA9u9cYAAAPPUlEQVR4Xu3dsW7jSJoHcL+CMI/gdEK9g6PDbeb0cJeMXsHRJB00/AAt4DY3MMFmegJnC+zCgKIdwJ3vQu+gq1OhazlFiaJtUv4o/n5oGBJZpAsUvuK/i6R8swcAmLebegEAwMzIQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3E0mD/3222/1IgBgIoKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg5/Gx8tBvI6h/BwAwEfVJfQj17/iAsfIQAMBUyEMAwNzJQwDA3MlDAMDcTT4P7Xa79PP+/n61WtXrGr5+/Xp3wu3tbd36YLFYvL6+lrdPT08PDw/pxWazSb/u3+1+eH5+Xi6X9dIf0laph7m3AEAoE8tDOaC8vLyk8JEjzs3NTXqbokZ6mxaeyhxfD+qlB2kP9aKDannZQ/otORhV0vLUn/I2tcl5K4WkFK3Si9zDxhYAQAjHo0BYKQ+lbLE8uL293Ww2Of2UsJLyUFrVjkQfyUPpRZ5GSnK+yS+y0r7KQ+n1er1OWa0sOev7Qb0UABjZ8SgQXxU+mnEnzxWVVVla0gwxTWfzUFZ+Rb7y1VyV91PmgZIUg9LPt84G/eWgXgoAjOx4FIivIw8d1dGgyj1pzzk55WmhFHGaazvkC2Tl7dk8tNvtvn371pzKkocA4FNMKQ+VpFJNxtw1LmYV1S3P/fNQttlsmsuPzi2t1+vGFv/fJnXp6ekpv707dLLZPjUol89yGNput//eXh4CgE9yJApczP++RbVtNT/UfNt8KKz4+sbrZavVKi0v18XuGr8rqwJW6kC+sSn9lhyJ0ib5ZqbcIAWgMtV0NAzt5SEA+CRHosDFtFPOKe2WzQCU4kXKQLeHx+bT65RjNpvNH1q/UdpJ2lvOQzkSVRHq7jDZ08xDaUm+Xvby8pI2TP1Jr/MkU74i1nxKP4WhX0+QhwDg8mLlob/97e//9d//k35Wy9stnw9f9vP09HT347rVYrFIySNllOaVso5poUq+tlW2yvNDaYf5Af6yqmjOD+ULeSWi5Qmq/PVFafPcvfSiXErbbrePj4/t+SEA4FMEykP//Ne/Uhj6j//8U/r5j99/b65qtkwhI8egFDhS1ChXx1IMSm9TLjl6vayputZWyY/0p5/N62jNe5Wy5vxQvm2oumaXr47lqFSmrwqRCADiCJSH9odIlPJQFYb2jZYp9KRgkXJPjkTNNmlJSjDVPc7F8+GrGnNU6s5D5auuj95XlK+FVQvbu80zTPl12mHzPusiRyJfOAQAn+7IKf9iSsppBqCUh8rrFI/yi9KyPJ3ezjT5CtfziUfcHx4eSkDJ9z6XmZ7lclk9epZ/S85DaVXzMbH8EH7RvDZXupRvnS49Sb+6eWt2kzAEABF8fh7K9wyVSFTyUL58lu8las8kVfdT50mdzWZTnucqs0G5QX74q71th/b80P1BdeWrKLtNbcr+V4dHzFJP0s+0vPltQwBAEPUp/5Jyysn3DJ36l9aWllmKFCl5rNfrnDmenp7yjUR5bcofd4cHu8rD7fvDHM/d4en3nEjel4dystkf5nuOJpu827Q2336UOpaSU2mZQ9vRC2cAwOf6/DyU54fKpbGz80P5Tuf8cFl6nbJO9TfC8vWpcgksB6Y8V5RW5YzSzkMvB80lOQ+lDfNt2vlBs7wq7Tzts/rVOQ/tDg//50fS2jczpSXtIAUAfK7Pz0P7xn1C+3P3D73V6+F7gJqp5fXwDHz+eqFKdYvPzSEP5ZTTvi0pLzfZAwBXIEQeKv7x++8pDzXjUdZuCQAwlEB5KIWh8v1DVSSShwCA8QTKQ/u3fD81AMBQYuWhU/q3BAB4q0/OQ/3VGwMADOQz89Cb1A+DAQDTUZ/Xg4nevyL+oQQ+Qo3DFYtf4NH7V8Q/lMBHqHG4YvELPHr/iviHEvgINQ5XLH6BR+9fEf9QAh+hxuGKxS/w6P0rhjqUaT/V3ykDIhikxhU4xDRIgY8qev+Ks4cy/5XWttvb22azs/s5a7fb/fUHf5wVhtJdmwocJu1UbTYrrl53Wcf7F9CpQ9m2Wq3af1g+DZp5aOvez2azyX+4vl7RsN1uvx18+fLl0z8/uBrdtVm8u8BTXec/5Jx+dtS4AocxnKrNZsXV6y7reP8COnUo29Jg154wL5uf2k8aTFcHy+WyY6xsSp+f4RKGcqo2K+8r8FTUqbRfX1/T67R5et0OVRUFDgM6VZtFqrh60WWd6V8cZw9llka61LLMpS8Wi7z87HCZBsenp6f0Im3VzkMpLaWPqpo8N1zCgE7VZtO7CzylqM1mU96m12nz8laBw9iatXmq4ppvL+/42BHQqWGucn9/n2NN1h4lz+6nnYfyJ7fdbpsL94ZLGNTZ2twPUeDZ8/NzyUMKHC6g1GZHxVVLLqzX2BFBn2Eu/Z9vuVyWt6+vr/3/+1hUeejUJ7c3XMKgztbmIAWePRzsFThcSq7N7oqrF11Wr7EjgrPDXBor840F6b+PeRauOSXef7is8lD6hH49zXAJQ+muzaEKfH+46JaCVN6JAofLyLXZXXH1Npd1fuwIonuYy/9TLDcApf9EpsEu/f+vJJv+w2WVh1KMfXx8PBpmgQF11OaABZ7CUPOObAUOl5FrM3LFnRk74jg7zDXvzMqPiTVHvf7DZfv+ocifH1yN7tocpMCfn5/bj6cpcLiAUpthK65r7Aile5hry4+flLc9h8v9sTy0//H5ff/+vVoODOVsbTa9o8BTGFosFu1n9fcKHMbXrM2YFXdy7IimY5hry7PrafgrS9r3GZxyNA8l0T45uDJna7N4R4GnTdozQ00KHEZV1WbAijs+dgR0aphr2+12y+UyPzzSdnY/p/IQMKqztZm9r8BTXZ/9AkZgPKdqM47o/St6Hsp8f8BqtapX/HBqP2m4vGmpGwGj6VNx7y7wurYP6kbAaOJXXPT+FWcPZX74NjU7+h/H19fX1ODp6ensfoBP0V2bChwmLX5tRu9fcfZQpqEwDZfNWwqadrvdzeHvOJozh5i6a1yBw6R1F3gE0ftXxD+UwEeocbhi8Qs8ev+K+IcS+Ag1DlcsfoFH718R/1ACH6HG4YrFL/Do/SviH0rgI9Q4XLH4BR69f0X8Qwl8hBqHKxa/wKP3r7gBACarPq8HE71/RfxDCXyEGocrFr/Ao/eviH8ogY9Q43DF4hd49P4V8Q8l8BFqHK5Y/AKP3r8i/qEEPkKNwxWLX+DR+1f0P5SbzWa1Wu12u3oFEFj/GgcmJ36BR+9f0fNQphi0WCzW63V68fXr19vb27s/6rmfDmnPf/1B6oKhvKk2lSFMy6kCb9Zyve6yjvcvoFOHsikd1uVyuVqt6hW9bTabFKdSkKpXNGy3228HX758+fTPD65GnxovlCFMy6kCb9Zyve6yjvcvoFOHsnh5eflIGEpZanWQdtKdh4r0+RmIYShna/woZQiTcLbAUy3Xiy7rTP/iOHsoU4hZr9f5dXrx/Pz8x/VnpE2enp7Si7u7u3YeSmkpfVTVtLyBGAZ0tsaVIUxXs8BP1XLz7eWdGYDiODtWFq+vr4vFYrPZ1Cv6aeeh/Mltt9vmwr2BGAbVXePKECatFHhHLVdLLqxrAAqle6xsSoFmvV6nSFTdSV3c3t62Z4CKuz/moVOf3N5ADIPqqHFlCFOXC7y7lutFl3VyAIqmY6xsyjcA1UsPnp+fU9apl7ZUeSh9Qr+eZiCGoXTUuDKEqcsF3l3L9TaXdXIAiqZjrCxSjsnTQvWKg/floRRjHx8fj4ZZYEAdNa4MYepygUeu5ZMDUDQdY2V2f3+/XC43m82p0PO+PLSP/fnB1eiucWUIk1YKPGwtdw1AoXSPlftD3Nntdh2hp2NVUzsP7X98ft+/f6+WA0M5W+PKEKarWeAxa/nMABTH2bEy6wg9HauajuahJNonB1emT40rQ5ioqsAD1vL5ASiIPmPlvjP0dKxqOpWHgFH1rHFgiuIXePT+FT0PZUfo6Vi1P8Sgm5a6ETAaFQdXLH6BR+9f0fNQHg09zwfr9frdf80DGFvPGgemKH6BR+9f0fNQptzT/v6hh4eHxWJxf3//8vJSrQKC6FnjwBTFL/Do/SviH0rgI9Q4XLH4BR69f0X8Qwl8hBqHKxa/wKP3r4h/KIGPUONwxeIXePT+FfEPJfARahyuWPwCj96/4gYAmKz6vB5M9P4BAFfgz29Rbzy+KeWh+OkSADiqf8rp33JAU0oY8hAATFT/lNO/5YCmlDDkIQCYqP4pp3/LAU0pYchDADBR/VNO/5YDmlLCkIcAYKL6p5z+LQc0pYRxKg99P6iXAgBh9E85/VsO6HjCiOlUHvrLQb0UAAijf8rp33JAxxNGTDkP7Xa7b9++pZ9luTwEAMH1Tzn9Ww5oYnkoh6HtdttcLg8BQHD9U07/lgOaUh766aef2mFoLw8BQHj9U07/lgOaUh765Zdffj1BHgKAyPqnnP4tBzSlPPTzzz8/Pj6254cAgOD6p5z+LQc0pTx0c3OTwpBIBACT0z/l9G85oInlofQzRyJfOAQAE/Lnt6g3Ht/08tD+8AWMf1wDAPB+k8xDAAADmlLCkIcAgDFMKWHIQwDAGKaUMOQhAGAMU0oY8hAAMIYpJQx5CAAYw5QShjwEAIxhSglDHgIAxiBhAABzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBz93+bZb9AsQ33lwAAAABJRU5ErkJggg==" alt=""> 保存文件，并退出word，将刚才的docx文件后缀修改为zip <img src="/assets/f8312906.e27f61c3.png" alt=""> 打开这个压缩包，找到下面word文件夹下的document.xml，并将它复制出来 <img src="/assets/413a28e3.f257ea89.png" alt=""> 打开这个文件，强烈推荐使用Notepad打开</p><p>现在我们需要做的就是要学着读懂DocML了（应该没有DocML这个东西，我跟着HTML编的，还有这个东西也许微软开发者联盟之类的地方有文档吧，反正目前我是没有找到标签文档，全靠猜），比如将原来的w:tr标签进行复制，创建一个新的行，把他的第一个列改成行2，然后我们把这个xml丢回到原来的模板zip中，再把它改回docx用word打开，看一下（同样推荐一下解压工具使用winrar，免费除了有广告火绒能拦截外，都能解压，为什么推荐用winrar呢？因为出现过同事电脑上的杂牌子解压软件不能把这个xml丢回去替换的问题，我就只能推荐一个我用着能成功的软件了） <img src="/assets/b88b4b92.7717729f.png" alt=""><img src="/assets/57c0f2b9.46f5cea9.png" alt=""> 看，这时他就愣生生的多出来了一行，同时我们也验证了，通过这种方式我们只需要利用Freemarker修改这个XML，并替换zip中xml修改后缀为docx，就能得到自己想要的Word文件了</p><p>Freemarker改造模板 改造模板时颇有一种写JSP的既视感，首先我先贴上Freemarker的文档连接，先初步了解一下Freemarker如何编辑模板，当然，这里也会先提供最简单的，也是我在做模板时最常用的Freemarker标签：</p><pre><code>普通插值：使用${xxxxxx}
循环插值：使用标签 &lt;#list xxxxList as xxxx&gt;${xxxx}&lt;/#list&gt;其中xxxxList为List或Array对象
空值判断：${xxxxx!&quot;&quot;}其表示的意思就是如果xxxxx为空，则使用”“,从我使用的经验而言，做Word的模板最好所有的变量都带上这个空值默认填充空，否则会报错的
其他更详尽的Freemarker玩法，就要去看官网的介绍了Freemarker文档
</code></pre><p>最终改造好后，我们将得到一下两个文件： <img src="/assets/35a9a182.f4ea9dfb.png" alt=""> 前者为Freemarker模板，后者为docx源文件更改了文件后缀</p><p>这面分享一些经验，虽然我们也可以在word中将所有的${}提前预制在文档编辑页面，从而减少在编辑XML时替换变量时的工作量，但是从我是用的经验角度讲，就算这样填充好了模板，也不要直接把XML拿出来就用，因为word在一些情况下会将我们的${}标签分成多个Xml标签，从而在Freemarker处理文档时，找不到你想要的那个变量，也就无法正常替换如： <img src="/assets/05c4738c.1b3e5c77.png" alt=""></p><p><strong>由创建好的docx文件模板与Freemarker XML模板创建Docx文件</strong></p><p>好的，各位通过前面的小节，已经可以了解到基本的原理了，从这开始，就要开始有代码层面的东西了，首先，我们要为项目引入Freemarker的maven，我个人使用的是这个Maven版本</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>然后，需要创建一个获取Freemarker文件输入流的工具类，把我们的xml文件填充上我们的数据：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>import cn.hutool.core.io.resource.ClassPathResource;
import freemarker.template.Configuration;
import freemarker.template.Template;
import freemarker.template.TemplateException;

import java.io.*;

public class FreemarkUtils {

    /**
     * 根据指定xml生成文件(默认将文档放在resource/static下)
     * @param orgData 模板所需数据
     * @param buildXml 创建的模板名
     * @param outFilePath 模板输出文件目录与
     * @param outFileName 模板输出文件文件名
     * @throws IOException
     * @throws TemplateException
     */
    public static void createFreemarkFile(Object orgData,String buildXml,String outFilePath,String outFileName) throws IOException, TemplateException {
        Configuration configuration = new Configuration();
        configuration.setDefaultEncoding(&quot;utf-8&quot;);
        configuration.setDirectoryForTemplateLoading(new ClassPathResource(&quot;static/&quot;).getFile());
        //以utf-8的编码读取ftl文件
        Template template =  configuration.getTemplate(buildXml,&quot;utf-8&quot;);
        Writer out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(outFilePath + outFileName), &quot;utf-8&quot;),10240);
        template.process(orgData, out);
        out.close();
    }

    /**
     * 获取模板输入流
     * @param dataMap   参数
     * @param templateName  模板名称
     * @param tempPath  模板路径 classes下的路径 如果是classes/static下的模板  传入 /static即可
     * @return
     */
    public static ByteArrayInputStream getFreemarkerContentInputStream(Object dataMap, String templateName, String tempPath) {
        ByteArrayInputStream in = null;

        try {
            //创建配置实例
            Configuration configuration = new Configuration();

            //设置编码
            configuration.setDefaultEncoding(&quot;UTF-8&quot;);

            //ftl模板文件统一放至 com.lun.template 包下面
            configuration.setClassForTemplateLoading(FreemarkUtils.class, tempPath);
            //获取模板
            Template template = configuration.getTemplate(templateName);

            StringWriter swriter = new StringWriter();
            //生成文件
            template.process(dataMap, swriter);
//            String result = swriter.toString();
in = new ByteArrayInputStream(swriter.toString().getBytes());

        } catch (Exception e) {
            e.printStackTrace();
        }
        return in;
    }

}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个类中还附带了一个createFreemarkFile方法，这个方法就是直接生成一个普通的转换过的xml文档，可以在测试过程中使用这个方法先看一下模板是否制作正常</p><p>我们将模板放在项目的resources下的/static中，这两个文件就是我们所需要的模板（不要慌张，我只是在这改个名，用了个已经做好的更复杂的模板而已） <img src="/assets/d0939ac9.5078855b.png" alt=""> 这个方法就是使用调用上面工具类中根据Freemarker模板生成好的数据，并将其替换到zip文件中，文件输出名是可根据后期个人需要进行修改</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**
* freemark生成word----docx格式(数据源默认放在resources/static)
* @param data 数据源
* @param documentXmlName  document.xml模板的文件名(生成的文本数据)
* @param docxTempName   docx模板的文件名（docx zip文件）
* @return 生成的文件路径
*/
public static File createApplyDocx(Object data,
String documentXmlName,
String docxTempName,
String outFilePath) {
ZipOutputStream zipout = null;//word输出流
File tempPath = null;//docx格式的word文件路径
try {
//freemark根据模板生成内容xml
//================================获取 document.xml 输入流================================
ByteArrayInputStream documentInput = FreemarkUtils.getFreemarkerContentInputStream(data, documentXmlName, File.separator + &quot;static&quot; + File.separator);
//================================获取 document.xml 输入流================================
//获取主模板docx
ClassPathResource resource = new ClassPathResource(&quot;static&quot; + File.separator + docxTempName);
File docxFile = resource.getFile();

            ZipFile zipFile = new ZipFile(docxFile);
            Enumeration&lt;? extends ZipEntry&gt; zipEntrys = zipFile.entries();

            //输出word文件路径和名称
            String fileName = &quot;applyWord_&quot; + System.currentTimeMillis() + &quot;.docx&quot;;
            String outPutWordPath = outFilePath + fileName;

            tempPath = new File(outPutWordPath);
            //如果输出目标文件夹不存在，则创建
            if (!tempPath.getParentFile().exists()) {
                tempPath.mkdirs();
            }
            //docx文件输出流
            zipout = new ZipOutputStream(new FileOutputStream(tempPath));

            //循环遍历主模板docx文件,替换掉主内容区，也就是上面获取的document.xml的内容
            //------------------覆盖文档------------------
            int len = -1;
            byte[] buffer = new byte[1024];
            while (zipEntrys.hasMoreElements()) {
                ZipEntry next = zipEntrys.nextElement();
                InputStream is = zipFile.getInputStream(next);
                if (next.toString().indexOf(&quot;media&quot;) &lt; 0) {
                    zipout.putNextEntry(new ZipEntry(next.getName()));
                    if (&quot;word/document.xml&quot;.equals(next.getName())) {
                        //写入填充数据后的主数据信息
                        if (documentInput != null) {
                            while ((len = documentInput.read(buffer)) != -1) {
                                zipout.write(buffer, 0, len);
                            }
                            documentInput.close();
                        }
                    }else {//不是主数据区的都用主模板的
                        while ((len = is.read(buffer)) != -1) {
                            zipout.write(buffer, 0, len);
                        }
                        is.close();
                    }
                }
            }
            //------------------覆盖文档------------------
            zipout.close();//关闭

        } catch (Exception e) {
            e.printStackTrace();
            try {
                if(zipout!=null){
                    zipout.close();
                }
            }catch (Exception ex){
                ex.printStackTrace();
            }
        }
        return tempPath;
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>File docxFile = DOC2PDFUtils.createApplyDocx(vo,
&quot;项目建议书docx版本.xml&quot;,
&quot;项目建议书.zip&quot;,
&quot;D:/&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当调用这个方法时，我们的docx文件就被生成了</p><p><strong>打包Windows下的ttf字体文件生成ttc字体文件包</strong></p><p>在正式贴入docx转pdf的功能前，首先我要先介绍一下字体包的打包，在我们使用工具类，将进行文件操作的时候，最担心的就是Linux的兼容问题，以前了解过一些类似的工具类，但是很多都是使用office的dll文件做的中间件，到了Linux上。。。。一言难尽。</p><p>这个小节就是为下面docx转pdf时的最后一关，字体，打下基础。</p><p>我已将打包工具上传到CSDN的文件共享中，审核过后，将会附带链接，不用担心，我设置的是0币下载。 fontforge工具下载</p><p>打开工具目录后，我们将看到这样的目录结构 <img src="/assets/3e91e1f5.c46f2471.png" alt=""> 我们选择打开fontforge.bat这个文件，将会看到这样的视窗 <img src="/assets/a4d254ac.0308787b.png" alt=""> 当然，这个东西我们先不要管他，主要的是要先找到我们所需要的字体文件，进入这个目录</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>C:\Windows\Fonts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>我们将看到当前系统下所有的字体文件，这里我们使用等线字体作为范例 <img src="/assets/ac53524c.5842a0ec.png" alt=""> 搜索后，找到所需的字体，选中后CTRL+C进行复制，在fontforge工具文件夹同级目录进行粘贴 <img src="/assets/e9ad4479.55d0e0d3.png" alt=""> 这时我们发现，虽然只复制了一个等线字体，但是实际上却复制出了多个文件，不过没问题，我们把他们进行合并生成所需要的ttc字体集合即可，回到刚才打开的窗口中，选择上面的..返回上一层，我们就可以看到工具已经识别到了这三个小家伙了，CTRL多选他们后，点击左下角的打开 <img src="/assets/7113c146.b1eb1051.png" alt=""> 简单等待后，我们可以看到这三个字体文件就被解析打开了 <img src="/assets/00f7537d.3d264aeb.png" alt=""> 这时我们随便在一个窗口的 文件-&gt;生成ttc <img src="/assets/4b306ed3.d7a906d4.png" alt=""> 为他起一个名字，然后点击Generate静静开始等待 <img src="/assets/ccf93266.80317597.png" alt=""> 当窗口消失，即可找到刚刚生成的ttc文件 <img src="/assets/779aceb2.44432080.png" alt=""> 从属性文件的大小以及双击打开ttc文件的描述上，我们可以知道，所需要的字体已经被整合到一起了，上面有细心的小伙伴应该能看到，在我项目中与模板同级的位置，就放着等线（dengxian.ttc）宋体（simsun.ttc）这两个字体的ttc整合包了 <img src="/assets/17553719.a1096c62.png" alt=""><img src="/assets/7be8de9e.a99023f3.png" alt=""></p><p><strong>将docx文件转换为Pdf</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>经过前面的铺垫，我们最终来到了docx文件转pdf文件的环节，首先我们先引入Maven配置

&lt;dependency&gt;
   &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
    &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
    &lt;version&gt;5.4.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/org.docx4j/docx4j --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j&lt;/artifactId&gt;
    &lt;version&gt;6.0.1&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-export-fo&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-core&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面是实现代码，通过PhysicalFonts.addPhysicalFonts引入我们所导好的字体文件，并使用fontMapper.put创建Word中使用的字体类型与字体文件之间的对照关系</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**
* word（docx）转pdf
* @param wordPath  docx文件路径
* @return  生成的带水印的pdf路径
*/
public static File convertDocx2Pdf(String wordPath,String pdfOutPath) {
String regex=&quot;.*(Courier New|Arial|Times New Roman|Comic Sans|Georgia|Impact|Lucida Console|Lucida Sans Unicode|Palatino Linotype|Tahoma|Trebuchet|Verdana|Symbol|Webdings|Wingdings|Wingdings 2|MS Sans Serif|MS Serif).*&quot;;
Date startDate = new Date();
PhysicalFonts.setRegex(regex);
String pdfNoMarkPath = null;

        OutputStream os = null;
        InputStream is = null;
        try {
            is = new FileInputStream(new File(wordPath));
            WordprocessingMLPackage mlPackage = WordprocessingMLPackage.load(is);
            Mapper fontMapper = new IdentityPlusMapper();

            PhysicalFonts.addPhysicalFonts(&quot;SimSun&quot;, FreemarkUtils.class.getResource(&quot;/static/simsun.ttc&quot;));
            PhysicalFonts.addPhysicalFonts(&quot;DengXian&quot;, FreemarkUtils.class.getResource(&quot;/static/dengxian.ttc&quot;));
            // fontMapper.put(&quot;Helvetica&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;宋体&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;宋体 (中文正文)&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;等线&quot;, PhysicalFonts.get(&quot;DengXian&quot;));
            mlPackage.setFontMapper(fontMapper);
            //输出pdf文件路径和名称
            String fileName = &quot;pdfNoMark_&quot; + System.currentTimeMillis() + &quot;.pdf&quot;;
            // String pdfNoMarkPath = System.getProperty(&quot;java.io.tmpdir&quot;).replaceAll(separator + &quot;$&quot;, &quot;&quot;) + separator + fileName;
            pdfNoMarkPath = pdfOutPath + fileName;

            os = new java.io.FileOutputStream(pdfNoMarkPath);
            //docx4j  docx转pdf
            FOSettings foSettings = Docx4J.createFOSettings();

            foSettings.setWmlPackage(mlPackage);
            Docx4J.toFO(foSettings, os, Docx4J.FLAG_EXPORT_PREFER_XSL);

            is.close();//关闭输入流
            os.close();//关闭输出流

            return new File(pdfNoMarkPath);
        } catch (Exception e) {
            e.printStackTrace();
            try {
                if(is != null){
                    is.close();
                }
                if(os != null){
                    os.close();
                }
            }catch (Exception ex){
                ex.printStackTrace();
            }
        }finally {
        // 这里原本是将word文件进行删除，由于我的业务上不需要对这个文件进行删除，所以就移除了这段代码
//            File file = new File(wordPath);
//            if(file!=null&amp;&amp;file.isFile()&amp;&amp;file.exists()){
//                file.delete();
//            }
}
return null;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>最后调用这个方法即可</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// docxFile为上面生成的Docx文件
File pdfFile = DOC2PDFUtils.convertDocx2Pdf(docxFile.getAbsolutePath(),&quot;D:/&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这里字体要根据个人使用情况进行适当调整，所使用的字体可以在XML模板中看到，如：</p><p>当这个方法运行时，可以根据控制台报错进行字体文件的调整</p><p><a href="https://blog.csdn.net/weixin_33374585/article/details/114719233" target="_blank" rel="noopener noreferrer">参考文章<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="方案4-利用docx4j实现" tabindex="-1"><a class="header-anchor" href="#方案4-利用docx4j实现" aria-hidden="true">#</a> 方案4，利用docx4j实现</h3><p><a href="https://github.com/plutext/docx4j" target="_blank" rel="noopener noreferrer">docx4j开源地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/qq_31905135/article/details/80431042" target="_blank" rel="noopener noreferrer">参考文章-利用docx4j完美导出word文档（标签替换、插入图片、生成表格）<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/weixin_34295316/article/details/86022702" target="_blank" rel="noopener noreferrer">参考文章-【docx4j】docx4j操作docx，实现替换内容、转换pdf、html等操作<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/zhyh1986/article/details/8766131" target="_blank" rel="noopener noreferrer">docx4j -- 使用Java处理word2007（.docx）文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="方案4-通过xdocreport和freemarker模板引擎生成word文档" tabindex="-1"><a class="header-anchor" href="#方案4-通过xdocreport和freemarker模板引擎生成word文档" aria-hidden="true">#</a> 方案4，通过XDocReport和FreeMarker模板引擎生成Word文档</h3><p>准备环境 开发语言：</p><p>Java7及以上的版本。</p><p>开发工具：</p><p>Eclipse/Idea。</p><p>第三方依赖库：</p><p>XDocReport、POI、Freemarker。</p><p>模板语言：</p><p>FreeMarker。</p><p>Word编辑器：</p><p>Microsoft 365或其他版本较高的Word编辑器。</p><p>示例Word模板 <img src="/assets/e3d9b961.493d9c28.png" alt=""></p><p>制作模板 Word模板如上图，可以看到，结构比较简单，包括两个部分，第一部分是纯文字和数字，第二部分主要是表格。我们在实际的开发过程中生成的报表几乎都是动态生成的，所以模板中的数字和表格里的数据都要替换成我们后台的实际数据。</p><p>替换Word模板中的动态变量，我们需要掌握两个知识点：</p><pre><code>1.Word文档中的Word域，word域是引导Word在文档中自动插入文字、图形、页码或其他信息的一组代码。在这里我们可以把         Word域理解成标识符，这个标识符表示Word文档中要被替换的内容；

2.FreeMarker模板下的变量表达式，比如用${city}替换Word示例模板中的北京市。
</code></pre><p>了解了以上两个概念后，我们就可以动手编辑Word模板了，步骤如下：</p><ol><li><p>首先在Word模板中选中要替换的文本，在这儿拿标题中的&quot;北京市&quot;为例，然后键盘使用 Ctrl + F9 组合键将其设置为域，此时文本会被&quot;{}&quot;包围，接着鼠标右键选择【编辑域(E)...】： <img src="/assets/992873fe.097f08b8.png" alt=""></p></li><li><p>在弹出的对话框中，类别选择“邮件合并”，域名选择 &quot;MergeField&quot;，域属性中的域名填入模版表达式${city}，点击【确定】按钮: <img src="/assets/de3a5407.fb0b51db.png" alt=""></p></li><li><p>编辑后的效果如下：</p></li></ol><p><img src="/assets/93e2db3f.b3c81302.png" alt=""></p><ol start="4"><li>掌握替换文本的方法后，我们可以把Word模板第一部分需要替换的内容都替换成模板变量： <img src="/assets/ab3bee0d.23769e55.png" alt=""></li></ol><p>Word模板中表格数据的处理 表格中的数据实质上就是对集合的遍历。</p><p>表格数据的处理其实和上面对文本内容的处理是类似的，只不过要在Word模板中加上集合的变量，Java代码中也要有对集合进行特对的处理(这个在后面的代码展示部分会说)。</p><p>具体操作步骤如下：</p><ol><li><p>选定表格中要替换的文本，然后键盘使用 Ctrl + F9 组合键将其设置为域，接着鼠标右键选择【编辑域(E)...】： <img src="/assets/0f9c4618.3d88c1e8.png" alt=""></p></li><li><p>在弹出的对话框中，类别选择“邮件合并”，域名选择 &quot;MergeField&quot;，域属性中的域名填入模版表达式${goods.num}，点击【确定】按钮；</p></li><li><p>重复步骤2，替换表格中的其他文本内容： <img src="/assets/6df8b41c.481675a0.png" alt=""></p></li></ol><p><strong>后台代码</strong></p><p>添加依赖到pom.xml文件</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls&lt;/artifactId&gt;
    &lt;version&gt;2.6.0&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls-poi&lt;/artifactId&gt;
    &lt;version&gt;1.2.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.core&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document.docx&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template.freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.3.23&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>编写Java代码</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>renren<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Goods</span></span><span class="token punctuation">;</span>
 
<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/word&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordTest</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//获取Word模板，模板存放路径在项目的resources目录下</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/模板.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//注册xdocreport实例并加载FreeMarker模板引擎</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span>     
                               <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//创建xdocreport上下文对象</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//创建要替换的文本变量</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;北京市&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;startDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2020-09-17&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;endDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2020-10-16&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;totCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">3638763</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;totAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;6521&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;onCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">2874036</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;onAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4768&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;offCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">764727</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;offAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1753&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;typeCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> goodsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;臭美毁肤&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">675512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;589&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;女装&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">602145</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;651&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;手机&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">587737</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;866&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;家具家装&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">551193</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;783&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;食物饮品&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">528604</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;405&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> goodsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//创建字段元数据</span>
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Word模板中的表格数据对应的集合类型</span>
        fm<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Goods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
        <span class="token comment">//输出到本地目录</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://商品销售报表.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Word模板中生成序号 给表格数据添加序号是通过后台代码生成的，比如上面的&quot;goods1.setNum(1)&quot;这段代码，其实也可以在Word模板中设置对应的域变量来实现序号的填充。</p><p>语法如下：</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@before-row[#list sequence as item]
item?index
@after-row[/#list]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在表格中添加上面的表达式，XDocReport就会自动解析并生成序号，表格中的其他字段也需要进行相应的改动:</p><p><img src="/assets/da12427e.9d165b1e.png" alt=""></p><p>提示：</p><ol><li>序号的表达式要拆成三个域，如下图，要把这三部分分别设置成域；</li></ol><p><img src="/assets/c7756d0c.37ac0e1e.png" alt=""></p><pre><code> 设置完成的结果参考上面表格中的序号表达式，表达式中&quot;item?index+1&quot;是因为序号是从0开始的，所以要加1；
</code></pre><ol start="2"><li><p>表格中除序号的列需要改成item.xxx而不是之前的goods.xxx: <img src="/assets/d8537bb3.9f45231a.png" alt=""></p></li><li><p>生成效果如下: <img src="/assets/8711d414.94bafaf6.png" alt=""></p></li></ol><p>建议：序号最好在后台生成，用序号表达式生成的序号列会占用比较大的空间，对资源有所浪费。</p><p>补充</p><ol><li>JavaWeb项目中通常是通过浏览器下载的方式来下载Word文档，此时只需要把之前下载到本地的代码改成浏览器端下载的代码即可：</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>//输出到本地目录
//FileOutputStream out = new FileOutputStream(new File(&quot;D://商品销售报表.docx&quot;));
//report.process(context, out);
 
//浏览器端下载
response.setCharacterEncoding(&quot;utf-8&quot;);  
response.setContentType(&quot;application/msword&quot;);  
String fileName = &quot;商品销售报表.docx&quot;;  
response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot;  
				    .concat(String.valueOf(URLEncoder.encode(fileName, &quot;UTF-8&quot;))));  
report.process(context, response.getOutputStream());
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Word模板中的表格的长度最好充满Word文档的左右两边，否则如果表格下面还有其他文本内容，下面的文本内容会自动填充到表格的缝隙处，而且会对下面的文本内容进行覆盖。</li></ol><p><strong>加餐</strong> 其实，导出Word模板，上面的模板和代码已经够用了，但也有少数模板需要添加图片和图形(比如饼状图)。</p><p><strong>制作图片</strong></p><p>图片的生成不使用编辑域，使用模板图片和Word的书签功能，而且需要在元数据中加入图片类型的代码，以下为具体步骤：</p><ol><li>在Word模版中需要插入图片的位置插入一张模版图片，然后鼠标单击模板图片插入一个书签，设置书签名称，比如img1， 最后点击【添加】按钮:</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>![](../../images/.生成word_images/19b0a592.png)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>如果需要插入多个图片，就在需要插入图片的位置插入多个模板图片并插入书签设置对应的书签名称即可，后台代码如下：</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImgTest</span> <span class="token punctuation">{</span>
 
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWordForImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWordForImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//获取Word模板，模板存放路径在项目的resources目录下</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/图片.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//注册xdocreport实例并加载FreeMarker模板引擎</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> 
                               <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//创建xdocreport上下文对象</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//元数据中加入图片</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;img1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;img2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//获取图片</span>
        <span class="token class-name">InputStream</span> img1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/11.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> img2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/33.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//把图片添加到上下文对象</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;img1&quot;</span><span class="token punctuation">,</span> img1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;img2&quot;</span><span class="token punctuation">,</span> img2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//输出到本地目录</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://图片报表.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>导出效果如下：</li></ol><p>制作图形 <img src="/assets/bd56e760.db8a8d32.png" alt=""> 要在Word文档中生成柱状图、饼状图等图形，需要在项目中引入第三方绘图工具，在这里使用xchart来演示在Word中生成饼状图图形。</p><p>生成饼状图和生成图片的方法很类似，具体步骤如下：</p><ol><li><p>在Word模版中需要插入图片的位置插入一张模版图片，然后鼠标单击模板图片插入一个书签，设置书签名称，比如chart，最后点击【添加】按钮: <img src="/assets/c9fa7e24.a8347be1.png" alt=""></p></li><li><p>编写代码:</p></li></ol><p>2.1 在pom.xml文件中添加xchart的依赖:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;org.knowm.xchart&lt;/groupId&gt;
	&lt;artifactId&gt;xchart&lt;/artifactId&gt;
	&lt;version&gt;3.5.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.2 后台代码:</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">BitmapEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">PieChart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">PieChartBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>images<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayImageProvider</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChartTest</span> <span class="token punctuation">{</span>
 
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWordForChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWordForChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//获取Word模板，模板存放路径在项目的resources目录下</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/饼图.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//注册xdocreport实例并加载FreeMarker模板引擎</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span>                 
                                 <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//创建xdocreport上下文对象</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//元数据中加入图片</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;chart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">PieChart</span> chart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PieChartBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">620</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&quot;销售饼图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//给饼图设置对应的值</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;臭美毁肤&quot;</span><span class="token punctuation">,</span> <span class="token number">589</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;女装&quot;</span><span class="token punctuation">,</span> <span class="token number">651</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;手机&quot;</span><span class="token punctuation">,</span> <span class="token number">866</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;家居家装&quot;</span><span class="token punctuation">,</span> <span class="token number">783</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;食物饮品&quot;</span><span class="token punctuation">,</span> <span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//生成饼图</span>
        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BitmapEncoder</span><span class="token punctuation">.</span><span class="token function">saveBitmap</span><span class="token punctuation">(</span>chart<span class="token punctuation">,</span> baos<span class="token punctuation">,</span> <span class="token class-name">BitmapEncoder<span class="token punctuation">.</span>BitmapFormat</span><span class="token punctuation">.</span><span class="token constant">JPG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//把饼图添加到上下文对象</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;chart&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayImageProvider</span><span class="token punctuation">(</span>baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//输出到本地目录</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://饼图报表.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>导出效果如下:</li></ol><p><img src="/assets/6a2c9661.e3612376.png" alt=""></p><p>总结 这就是用Java语言实现，结合XDocReport和FreeMarker模板引擎生成Word文档的方法。希望能给致力于开发的小伙伴带来一丝丝帮助。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/easywhx/learning/edit/main/note/Java/方案/生成word.md" rel="noopener noreferrer" target="_blank" aria-label="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><!----></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: wanhx@xports.cn">wanhx</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/note/Java/%E6%96%B9%E6%A1%88/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7.html" class="nav-link prev" aria-label="接口幂等"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->接口幂等</div></a><!----></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.4d667c68.js" defer></script>
  </body>
</html>
