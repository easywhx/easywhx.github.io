<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.51" />
    <meta name="theme" content="VuePress Theme Hope" />
    <title>ç”Ÿæˆword | HONGXU</title><meta name="description" content="ä¸ªäººåšå®¢">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.4e4a549b.css">
    <link rel="modulepreload" href="/assets/app.4d667c68.js"><link rel="modulepreload" href="/assets/ç”Ÿæˆword.html.bcdae325.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/ç”Ÿæˆword.html.95aed98d.js"><link rel="prefetch" href="/assets/index.html.a2ae31da.js"><link rel="prefetch" href="/assets/fafwfw.html.fb19f8c1.js"><link rel="prefetch" href="/assets/index.html.dced8a1d.js"><link rel="prefetch" href="/assets/FAQ.html.b3df9f36.js"><link rel="prefetch" href="/assets/ã€Markdownç¼–è¾‘å™¨å¿«æ·é”®ã€‘æ±‡æ€».html.ba090e64.js"><link rel="prefetch" href="/assets/test.html.ece31899.js"><link rel="prefetch" href="/assets/åŸºæœ¬å‘½ä»¤ä½¿ç”¨.html.9fcbb84f.js"><link rel="prefetch" href="/assets/ç®—æ³•é¢˜æ•´ç†.html.fca170e3.js"><link rel="prefetch" href="/assets/eså’Œkibanaå®‰è£…é…ç½®.html.656faf72.js"><link rel="prefetch" href="/assets/esçš„åŸºæœ¬ä½¿ç”¨.html.b4c6df75.js"><link rel="prefetch" href="/assets/htmlçŸ¥è¯†ç‚¹æ•´ç†.html.83a414aa.js"><link rel="prefetch" href="/assets/mavené—®é¢˜æ•´ç†.html.364b8f73.js"><link rel="prefetch" href="/assets/oauth2çš„å…¨æµç¨‹.html.f1fb6e2c.js"><link rel="prefetch" href="/assets/é™æ€æ–¹æ³•è°ƒç”¨æ³¨å…¥bean.html.19bfd7e1.js"><link rel="prefetch" href="/assets/sharding-jdbc.html.87f28d8c.js"><link rel="prefetch" href="/assets/dockeræ­å»ºç¯å¢ƒ.html.6f21238d.js"><link rel="prefetch" href="/assets/ä½¿ç”¨Flywayè¿›è¡Œæ•°æ®åº“è¿ç§».html.97fd1d2d.js"><link rel="prefetch" href="/assets/Mavenå®ç°ä¸€é”®æ‰“åŒ…éƒ¨ç½².html.4ea59e9a.js"><link rel="prefetch" href="/assets/åŸºäºjenkins_dockerçš„æŒç»­é›†æˆç¯å¢ƒéƒ¨ç½².html.00a505a8.js"><link rel="prefetch" href="/assets/Quartzä»»åŠ¡è°ƒåº¦æ¡†æ¶åŸç†.html.80dc9ee9.js"><link rel="prefetch" href="/assets/Spring MVCä¹‹RequestContextHolderå’ŒLocaleContextHolderçš„ä½¿ç”¨è¯¦è§£ä»¥åŠä½¿ç”¨è¯¯åŒº.html.d3371f6b.js"><link rel="prefetch" href="/assets/QueryWrapperå¸¸ç”¨æ–¹æ³•.html.67081961.js"><link rel="prefetch" href="/assets/fastjsonçš„ä½¿ç”¨â€”â€”JSONå­—ç¬¦ä¸²ã€JSONå¯¹è±¡ã€Javaå¯¹è±¡çš„äº’è½¬.html.6ed95081.js"><link rel="prefetch" href="/assets/æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´.html.6114dd35.js"><link rel="prefetch" href="/assets/é›†åˆstreamç›¸å…³æ“ä½œ.html.de0ba4d9.js"><link rel="prefetch" href="/assets/é™æ€æ–¹æ³•å’Œæ³›å‹.html.27f3703b.js"><link rel="prefetch" href="/assets/docxå’Œdocäº’è½¬.html.4c3623e4.js"><link rel="prefetch" href="/assets/wordè½¬html.html.28971dfa.js"><link rel="prefetch" href="/assets/wordè½¬pdf.html.8acedd9b.js"><link rel="prefetch" href="/assets/å¦‚ä½•å®ç°å®šæ—¶ä»»åŠ¡è°ƒåº¦.html.ec30ee6d.js"><link rel="prefetch" href="/assets/å¦‚ä½•å®ç°æ¥å£å¹‚ç­‰æ€§.html.b5f98a8f.js"><link rel="prefetch" href="/assets/æ—¥å¿—é…ç½®æ–‡ä»¶.html.ab910729.js"><link rel="prefetch" href="/assets/mysql.html.00d7bf11.js"><link rel="prefetch" href="/assets/mysql8.0å®‰è£…æ•™ç¨‹(è§£å‹ç‰ˆ).html.c693637b.js"><link rel="prefetch" href="/assets/Oracleå…³äºdateç±»å‹çš„æŸ¥è¯¢æ–¹å¼åŠæ•ˆç‡æµ…æ.html.e1d4b7ab.js"><link rel="prefetch" href="/assets/Oracleç›¸å…³.html.6269a6be.js"><link rel="prefetch" href="/assets/idè‡ªå¢é•¿æ–¹æ¡ˆ.html.75f7ae19.js"><link rel="prefetch" href="/assets/oracleæ—¶é—´æˆ³å‡½æ•°åŠç›¸å…³æ“ä½œ.html.290edae3.js"><link rel="prefetch" href="/assets/sequence.html.01913139.js"><link rel="prefetch" href="/assets/æ‰¹é‡æ’å…¥æ•°æ®.html.24a0fa38.js"><link rel="prefetch" href="/assets/dubbo.html.55360f99.js"><link rel="prefetch" href="/assets/gateway.html.f4adc050.js"><link rel="prefetch" href="/assets/nacos.html.a19ee52c.js"><link rel="prefetch" href="/assets/sentinel.html.6cfa5ca1.js"><link rel="prefetch" href="/assets/securityä½¿ç”¨.html.8c0e1d31.js"><link rel="prefetch" href="/assets/securityåŸç†.html.a3199eaa.js"><link rel="prefetch" href="/assets/æ•´åˆelk.html.2f62cad0.js"><link rel="prefetch" href="/assets/æ•´åˆes.html.1dc0e47d.js"><link rel="prefetch" href="/assets/æ•´åˆminioå®ç°æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½.html.1ebaa1f9.js"><link rel="prefetch" href="/assets/kafkaä½¿ç”¨.html.668032c1.js"><link rel="prefetch" href="/assets/rabbitå®‰è£….html.6245e078.js"><link rel="prefetch" href="/assets/QueryWrapperã€LambdaQueryWrapperå’ŒLambdaQueryChainWrapperçš„ç”¨æ³•(äºŒ).html.3126dc49.js"><link rel="prefetch" href="/assets/UpdateWrapper.html.f21aa8bd.js"><link rel="prefetch" href="/assets/åˆ†é¡µ.html.7f44a976.js"><link rel="prefetch" href="/assets/åŸºç¡€ç”¨æ³•.html.53bfaf7d.js"><link rel="prefetch" href="/assets/æ‰¹é‡æ’å…¥.html.204f7f52.js"><link rel="prefetch" href="/assets/404.html.c5de7dd9.js"><link rel="prefetch" href="/assets/index.html.2f713335.js"><link rel="prefetch" href="/assets/index.html.1a811f74.js"><link rel="prefetch" href="/assets/index.html.79fe6d6e.js"><link rel="prefetch" href="/assets/index.html.dcd15e89.js"><link rel="prefetch" href="/assets/index.html.e8952663.js"><link rel="prefetch" href="/assets/index.html.5ad7ff00.js"><link rel="prefetch" href="/assets/index.html.92637d35.js"><link rel="prefetch" href="/assets/index.html.7e924de7.js"><link rel="prefetch" href="/assets/index.html.5b971275.js"><link rel="prefetch" href="/assets/index.html.a99d180d.js"><link rel="prefetch" href="/assets/index.html.fb16b232.js"><link rel="prefetch" href="/assets/index.html.0f8c6f75.js"><link rel="prefetch" href="/assets/fafwfw.html.9418a6e5.js"><link rel="prefetch" href="/assets/index.html.67148146.js"><link rel="prefetch" href="/assets/FAQ.html.be7774a6.js"><link rel="prefetch" href="/assets/ã€Markdownç¼–è¾‘å™¨å¿«æ·é”®ã€‘æ±‡æ€».html.a3551968.js"><link rel="prefetch" href="/assets/test.html.c0403a27.js"><link rel="prefetch" href="/assets/åŸºæœ¬å‘½ä»¤ä½¿ç”¨.html.403e251d.js"><link rel="prefetch" href="/assets/ç®—æ³•é¢˜æ•´ç†.html.facf7e00.js"><link rel="prefetch" href="/assets/eså’Œkibanaå®‰è£…é…ç½®.html.dfb75cf7.js"><link rel="prefetch" href="/assets/esçš„åŸºæœ¬ä½¿ç”¨.html.78444edf.js"><link rel="prefetch" href="/assets/htmlçŸ¥è¯†ç‚¹æ•´ç†.html.f1b5256a.js"><link rel="prefetch" href="/assets/mavené—®é¢˜æ•´ç†.html.30f07f85.js"><link rel="prefetch" href="/assets/oauth2çš„å…¨æµç¨‹.html.7e9aec60.js"><link rel="prefetch" href="/assets/é™æ€æ–¹æ³•è°ƒç”¨æ³¨å…¥bean.html.1879f8c9.js"><link rel="prefetch" href="/assets/sharding-jdbc.html.545194d8.js"><link rel="prefetch" href="/assets/dockeræ­å»ºç¯å¢ƒ.html.0090b063.js"><link rel="prefetch" href="/assets/ä½¿ç”¨Flywayè¿›è¡Œæ•°æ®åº“è¿ç§».html.7969cb27.js"><link rel="prefetch" href="/assets/Mavenå®ç°ä¸€é”®æ‰“åŒ…éƒ¨ç½².html.d3916189.js"><link rel="prefetch" href="/assets/åŸºäºjenkins_dockerçš„æŒç»­é›†æˆç¯å¢ƒéƒ¨ç½².html.4fefae77.js"><link rel="prefetch" href="/assets/Quartzä»»åŠ¡è°ƒåº¦æ¡†æ¶åŸç†.html.983d8374.js"><link rel="prefetch" href="/assets/Spring MVCä¹‹RequestContextHolderå’ŒLocaleContextHolderçš„ä½¿ç”¨è¯¦è§£ä»¥åŠä½¿ç”¨è¯¯åŒº.html.d0e7a91a.js"><link rel="prefetch" href="/assets/QueryWrapperå¸¸ç”¨æ–¹æ³•.html.1d04aeaa.js"><link rel="prefetch" href="/assets/fastjsonçš„ä½¿ç”¨â€”â€”JSONå­—ç¬¦ä¸²ã€JSONå¯¹è±¡ã€Javaå¯¹è±¡çš„äº’è½¬.html.f7aedb9d.js"><link rel="prefetch" href="/assets/æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´.html.bd9e24ed.js"><link rel="prefetch" href="/assets/é›†åˆstreamç›¸å…³æ“ä½œ.html.5d829b4f.js"><link rel="prefetch" href="/assets/é™æ€æ–¹æ³•å’Œæ³›å‹.html.7d92d90f.js"><link rel="prefetch" href="/assets/docxå’Œdocäº’è½¬.html.027e2780.js"><link rel="prefetch" href="/assets/wordè½¬html.html.b8c060cf.js"><link rel="prefetch" href="/assets/wordè½¬pdf.html.208c3faa.js"><link rel="prefetch" href="/assets/å¦‚ä½•å®ç°å®šæ—¶ä»»åŠ¡è°ƒåº¦.html.90e39dd1.js"><link rel="prefetch" href="/assets/å¦‚ä½•å®ç°æ¥å£å¹‚ç­‰æ€§.html.b4c7cc49.js"><link rel="prefetch" href="/assets/æ—¥å¿—é…ç½®æ–‡ä»¶.html.23ba4e84.js"><link rel="prefetch" href="/assets/mysql.html.53f21f6e.js"><link rel="prefetch" href="/assets/mysql8.0å®‰è£…æ•™ç¨‹(è§£å‹ç‰ˆ).html.0b7ed189.js"><link rel="prefetch" href="/assets/Oracleå…³äºdateç±»å‹çš„æŸ¥è¯¢æ–¹å¼åŠæ•ˆç‡æµ…æ.html.f034dc09.js"><link rel="prefetch" href="/assets/Oracleç›¸å…³.html.21feb8c9.js"><link rel="prefetch" href="/assets/idè‡ªå¢é•¿æ–¹æ¡ˆ.html.b87477b7.js"><link rel="prefetch" href="/assets/oracleæ—¶é—´æˆ³å‡½æ•°åŠç›¸å…³æ“ä½œ.html.e3d7b56b.js"><link rel="prefetch" href="/assets/sequence.html.e2a339bc.js"><link rel="prefetch" href="/assets/æ‰¹é‡æ’å…¥æ•°æ®.html.0a289a1e.js"><link rel="prefetch" href="/assets/dubbo.html.316b69fc.js"><link rel="prefetch" href="/assets/gateway.html.5f6eb9b8.js"><link rel="prefetch" href="/assets/nacos.html.81ce69c5.js"><link rel="prefetch" href="/assets/sentinel.html.a994e5f2.js"><link rel="prefetch" href="/assets/securityä½¿ç”¨.html.840423d8.js"><link rel="prefetch" href="/assets/securityåŸç†.html.2cb58ad2.js"><link rel="prefetch" href="/assets/æ•´åˆelk.html.5ea6e37a.js"><link rel="prefetch" href="/assets/æ•´åˆes.html.78aba307.js"><link rel="prefetch" href="/assets/æ•´åˆminioå®ç°æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½.html.90252f2b.js"><link rel="prefetch" href="/assets/kafkaä½¿ç”¨.html.7941cb77.js"><link rel="prefetch" href="/assets/rabbitå®‰è£….html.085e5255.js"><link rel="prefetch" href="/assets/QueryWrapperã€LambdaQueryWrapperå’ŒLambdaQueryChainWrapperçš„ç”¨æ³•(äºŒ).html.34b4322d.js"><link rel="prefetch" href="/assets/UpdateWrapper.html.92cf4e7c.js"><link rel="prefetch" href="/assets/åˆ†é¡µ.html.76fcd1e0.js"><link rel="prefetch" href="/assets/åŸºç¡€ç”¨æ³•.html.3ce5c230.js"><link rel="prefetch" href="/assets/æ‰¹é‡æ’å…¥.html.895d4ad1.js"><link rel="prefetch" href="/assets/404.html.ec44aeb3.js"><link rel="prefetch" href="/assets/index.html.9191a9cd.js"><link rel="prefetch" href="/assets/index.html.c40b2015.js"><link rel="prefetch" href="/assets/index.html.2e16174c.js"><link rel="prefetch" href="/assets/index.html.e8b4d9fb.js"><link rel="prefetch" href="/assets/index.html.915b6ad9.js"><link rel="prefetch" href="/assets/index.html.195f978b.js"><link rel="prefetch" href="/assets/index.html.6fa4b8e4.js"><link rel="prefetch" href="/assets/index.html.0cce01dd.js"><link rel="prefetch" href="/assets/index.html.2ec3a18a.js"><link rel="prefetch" href="/assets/index.html.b142fe4a.js"><link rel="prefetch" href="/assets/index.html.f86f5ce1.js"><link rel="prefetch" href="/assets/mermaid.core.5ea15c44.js"><link rel="prefetch" href="/assets/photoswipe.esm.720e8656.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/images/logo.jpeg" alt="HONGXU"><!----><span class="site-name hide-in-pad">HONGXU</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="ä¸»é¡µ"><!---->ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/guide/fafwfw.html" class="nav-link" aria-label="å‘å¯¼"><!---->å‘å¯¼<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/easywhx/learning" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/note/FAQ.html" class="nav-link sidebar-link sidebar-page" aria-label="FAQ"><!---->FAQ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/%E3%80%90Markdown%E7%BC%96%E8%BE%91%E5%99%A8%E5%BF%AB%E6%8D%B7%E9%94%AE%E3%80%91%E6%B1%87%E6%80%BB.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdownå¿«æ·é”®"><!---->Markdownå¿«æ·é”®<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">database</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">elasticsearch</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">algorithm</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">html</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">JAVA</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">åŸç†</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">åŸºç¡€çŸ¥è¯†æ•´ç†</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">æ–¹æ¡ˆ</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/docx%E5%92%8Cdoc%E4%BA%92%E8%BD%AC.html" class="nav-link sidebar-link sidebar-page" aria-label="docxå’Œdocäº’è½¬"><!---->docxå’Œdocäº’è½¬<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/word%E8%BD%AChtml.html" class="nav-link sidebar-link sidebar-page" aria-label="wordè½¬html"><!---->wordè½¬html<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/word%E8%BD%ACpdf.html" class="nav-link sidebar-link sidebar-page" aria-label="wordè½¬pdf"><!---->wordè½¬pdf<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6.html" class="nav-link sidebar-link sidebar-page" aria-label="å®šæ—¶ä»»åŠ¡"><!---->å®šæ—¶ä»»åŠ¡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/note/Java/%E6%96%B9%E6%A1%88/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7.html" class="nav-link sidebar-link sidebar-page" aria-label="æ¥å£å¹‚ç­‰"><!---->æ¥å£å¹‚ç­‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="ç”Ÿæˆword"><!---->ç”Ÿæˆword<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ1-åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–¹æ¡ˆ1. åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°"><!---->æ–¹æ¡ˆ1. åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ2-åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°-ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£-ä¸æ˜¯åŸç”Ÿçš„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–¹æ¡ˆ2. åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°(ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£ï¼Œä¸æ˜¯åŸç”Ÿçš„)"><!---->æ–¹æ¡ˆ2. åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°(ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£ï¼Œä¸æ˜¯åŸç”Ÿçš„)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ3-åˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿-æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿-å¦å­˜ä¸ºzip-ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document-xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿-ç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–¹æ¡ˆ3ï¼Œåˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿(æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿ï¼Œå¦å­˜ä¸ºzip,ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document.xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word)"><!---->æ–¹æ¡ˆ3ï¼Œåˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿(æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿ï¼Œå¦å­˜ä¸ºzip,ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document.xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word)<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ4-åˆ©ç”¨docx4jå®ç°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–¹æ¡ˆ4ï¼Œåˆ©ç”¨docx4jå®ç°"><!---->æ–¹æ¡ˆ4ï¼Œåˆ©ç”¨docx4jå®ç°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ4-é€šè¿‡xdocreportå’Œfreemarkeræ¨¡æ¿å¼•æ“ç”Ÿæˆwordæ–‡æ¡£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ–¹æ¡ˆ4ï¼Œé€šè¿‡XDocReportå’ŒFreeMarkeræ¨¡æ¿å¼•æ“ç”ŸæˆWordæ–‡æ¡£"><!---->æ–¹æ¡ˆ4ï¼Œé€šè¿‡XDocReportå’ŒFreeMarkeræ¨¡æ¿å¼•æ“ç”ŸæˆWordæ–‡æ¡£<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æ—¥å¿—</span><span class="arrow right"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Linux</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">maven</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Oauth2</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Spring</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æ¶ˆæ¯ä¸­é—´ä»¶</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ç¯å¢ƒæ­å»º</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">åˆ†åº“åˆ†è¡¨</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">è¿ç§»</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">é¡¹ç›®éƒ¨ç½²</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">go</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">web</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ä¸­é—´ä»¶</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å‰ç«¯</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">åº”ç”¨æ–¹æ¡ˆ</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æ•°æ®åº“</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æœåŠ¡å™¨ç¯å¢ƒ</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">æ¶æ„</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">ç½‘ç»œé€šä¿¡</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->ç”Ÿæˆword</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">HONGXU</span></span><span property="author" content="HONGXU"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´12æœˆ25æ—¥</span><meta property="datePublished" content="2022-12-25T15:22:16.000Z"></span><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 29 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT29M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ1-åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°" class="router-link-active router-link-exact-active toc-link level3">æ–¹æ¡ˆ1. åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ2-åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°-ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£-ä¸æ˜¯åŸç”Ÿçš„" class="router-link-active router-link-exact-active toc-link level3">æ–¹æ¡ˆ2. åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°(ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£ï¼Œä¸æ˜¯åŸç”Ÿçš„)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ3-åˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿-æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿-å¦å­˜ä¸ºzip-ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document-xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿-ç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word" class="router-link-active router-link-exact-active toc-link level3">æ–¹æ¡ˆ3ï¼Œåˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿(æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿ï¼Œå¦å­˜ä¸ºzip,ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document.xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ4-åˆ©ç”¨docx4jå®ç°" class="router-link-active router-link-exact-active toc-link level3">æ–¹æ¡ˆ4ï¼Œåˆ©ç”¨docx4jå®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/note/Java/%E6%96%B9%E6%A1%88/%E7%94%9F%E6%88%90word.html#æ–¹æ¡ˆ4-é€šè¿‡xdocreportå’Œfreemarkeræ¨¡æ¿å¼•æ“ç”Ÿæˆwordæ–‡æ¡£" class="router-link-active router-link-exact-active toc-link level3">æ–¹æ¡ˆ4ï¼Œé€šè¿‡XDocReportå’ŒFreeMarkeræ¨¡æ¿å¼•æ“ç”ŸæˆWordæ–‡æ¡£</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="ç”Ÿæˆword" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆword" aria-hidden="true">#</a> ç”Ÿæˆword</h1><h3 id="æ–¹æ¡ˆ1-åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ1-åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°" aria-hidden="true">#</a> æ–¹æ¡ˆ1. åˆ©ç”¨htmlæ ¼å¼çš„æ¨¡æ¿å®ç°</h3><ol><li>åˆ›å»ºwordæ¨¡æ¿ï¼Œå¦å­˜ä¸ºhtmlæ ¼å¼çš„æ–‡ä»¶</li><li>è®¾ç½®ftlæ¨¡æ¿çš„æŒ‡ä»¤ï¼Œä¿å­˜ä¸ºfreemarkeræ ¼å¼çš„æ–‡ä»¶</li><li>åˆ©ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ•°æ®å¡«å……æ¸²æŸ“ï¼Œè¿”å›æ–‡ä»¶æµ</li><li>å°†å¡«å……å¥½æ•°æ®çš„htmlæ ¼å¼çš„æ–‡ä»¶æµå¤„ç†è½¬æ¢ä¸ºwordæ–‡ä»¶</li></ol><p><a href="https://blog.csdn.net/gaojie_csdn/article/details/122244262" target="_blank" rel="noopener noreferrer">å‚è€ƒè¿æ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h4 id="å®ç°æ–¹å¼1-ä½¿ç”¨apache-poiçš„poifs-apiæ¥å®ç°" tabindex="-1"><a class="header-anchor" href="#å®ç°æ–¹å¼1-ä½¿ç”¨apache-poiçš„poifs-apiæ¥å®ç°" aria-hidden="true">#</a> å®ç°æ–¹å¼1 ä½¿ç”¨Apache POIçš„POIFS APIæ¥å®ç°ï¼š</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>xxx<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>common<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">Template</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">freemarker<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>commons<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">StringEscapeUtils</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>poifs<span class="token punctuation">.</span>filesystem<span class="token punctuation">.</span></span><span class="token class-name">DirectoryEntry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>poi<span class="token punctuation">.</span>poifs<span class="token punctuation">.</span>filesystem<span class="token punctuation">.</span></span><span class="token class-name">POIFSFileSystem</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>core<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ClassPathResource</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HtmlUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordUtils</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * htmlå­—ç¬¦ä¸²ç”Ÿæˆword
     * <span class="token keyword">@param</span> <span class="token parameter">content</span> htmlå­—ç¬¦ä¸²
     * <span class="token keyword">@param</span> <span class="token parameter">filePath</span> ç”Ÿæˆæ–‡ä»¶çš„è·¯å¾„
     * <span class="token keyword">@param</span> <span class="token parameter">fileName</span> æ–‡ä»¶åç§°
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createWord</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">,</span> <span class="token class-name">String</span> filePath<span class="token punctuation">,</span> <span class="token class-name">String</span> fileName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">ClassPathResource</span> resource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ClassPathResource</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è¾“å‡ºæ–‡ä»¶</span>
            <span class="token class-name">String</span> dir <span class="token operator">=</span> resource<span class="token punctuation">.</span><span class="token function">getURI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> fileAbsolutePath <span class="token operator">=</span> dir <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> fileName <span class="token operator">+</span> <span class="token string">&quot;_&quot;</span> <span class="token operator">+</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fileAbsolutePath<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                fileAbsolutePath <span class="token operator">+=</span> <span class="token string">&quot;.docx&quot;</span><span class="token punctuation">;</span>
            <span class="token class-name">File</span> outFile <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>fileAbsolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//å¦‚æœè¾“å‡ºç›®æ ‡æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>outFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                outFile<span class="token punctuation">.</span><span class="token function">getParentFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            content <span class="token operator">=</span> <span class="token class-name">HtmlUtils</span><span class="token punctuation">.</span><span class="token function">htmlUnescape</span><span class="token punctuation">(</span><span class="token class-name">StringEscapeUtils</span><span class="token punctuation">.</span><span class="token function">unescapeHtml</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//æ ¼å¼åŒ–html</span>
            <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> by <span class="token operator">=</span> content<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">ByteArrayInputStream</span> byteArrayInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayInputStream</span><span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">POIFSFileSystem</span> poifsFileSystem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">POIFSFileSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">DirectoryEntry</span> directory <span class="token operator">=</span> poifsFileSystem<span class="token punctuation">.</span><span class="token function">getRoot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            directory<span class="token punctuation">.</span><span class="token function">createDocument</span><span class="token punctuation">(</span><span class="token string">&quot;WordDocument&quot;</span><span class="token punctuation">,</span> byteArrayInputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FileOutputStream</span> fileOutputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span>fileAbsolutePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            poifsFileSystem<span class="token punctuation">.</span><span class="token function">writeFilesystem</span><span class="token punctuation">(</span>fileOutputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            byteArrayInputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            fileOutputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> fileAbsolutePath<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ç”Ÿæˆhtmlå­—ç¬¦ä¸²
     * <span class="token keyword">@param</span> <span class="token parameter">dataMap</span> æ•°æ®é›†
     * <span class="token keyword">@param</span> <span class="token parameter">templateName</span> æ¨¡æ¿åç§°
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createHtml</span><span class="token punctuation">(</span><span class="token class-name">Map</span> dataMap<span class="token punctuation">,</span> <span class="token class-name">String</span> templatePath<span class="token punctuation">,</span> <span class="token class-name">String</span> templateName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">TemplateException</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>templateName<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">&quot;.ftl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                templateName <span class="token operator">+=</span> <span class="token string">&quot;.ftl&quot;</span><span class="token punctuation">;</span>
            <span class="token comment">//åˆ›å»ºé…ç½®å®ä¾‹ </span>
            <span class="token class-name">Configuration</span> configuration <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è®¾ç½®ç¼–ç </span>
            configuration<span class="token punctuation">.</span><span class="token function">setDefaultEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            configuration<span class="token punctuation">.</span><span class="token function">setClassForTemplateLoading</span><span class="token punctuation">(</span><span class="token class-name">WordUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> templatePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è·å–æ¨¡æ¿ </span>
            <span class="token class-name">Template</span> template <span class="token operator">=</span> configuration<span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>templateName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//å°†æ¨¡æ¿å’Œæ•°æ®æ¨¡å‹åˆå¹¶ç”Ÿæˆæ–‡ä»¶</span>
            <span class="token class-name">StringWriter</span> stringWriter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//ç”Ÿæˆhtml</span>
            template<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> stringWriter<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> stringWriter<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> ie<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">TemplateException</span> te<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> te<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span> dataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åç§°&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> dataList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Map</span> dataItem1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç¬¬ä¸€è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;11&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem1<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;13&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span> dataItem2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç¬¬äºŒè¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;21&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;22&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem2<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;23&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Map</span> dataItem3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ç¬¬ä¸‰è¡Œ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;31&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;32&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataItem3<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;three&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;33&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dataItem3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;dataList&quot;</span><span class="token punctuation">,</span> dataList<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">String</span> html <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            html <span class="token operator">=</span> <span class="token function">createHtml</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">,</span> <span class="token string">&quot;/word-templates&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test.ftl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token function">createWord</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">&quot;/word-templates&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°æ–¹å¼2-docx4jå®ç°htmlè½¬word" tabindex="-1"><a class="header-anchor" href="#å®ç°æ–¹å¼2-docx4jå®ç°htmlè½¬word" aria-hidden="true">#</a> å®ç°æ–¹å¼2ï¼šdocx4jå®ç°htmlè½¬word</h4><p><strong>å‚è€ƒä»£ç 1ï¼š</strong></p><p>åœ¨pom.xmlé‡Œï¼Œæ·»åŠ docx4jçš„mavenä¾èµ–</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-JAXB-ReferenceImpl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.docx4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>docx4j-ImportXHTML<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>8.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>xml<span class="token punctuation">.</span>bind<span class="token punctuation">.</span></span><span class="token class-name">JAXBException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>convert<span class="token punctuation">.</span>in<span class="token punctuation">.</span>xhtml<span class="token punctuation">.</span></span><span class="token class-name">XHTMLImporterImpl</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>jaxb<span class="token punctuation">.</span></span><span class="token class-name">Context</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span></span><span class="token class-name">Docx4JException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>packages<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingMLPackage</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">DocumentSettingsPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">FooterPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">HeaderPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">MainDocumentPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>openpackaging<span class="token punctuation">.</span>parts<span class="token punctuation">.</span></span><span class="token class-name">WordprocessingML</span><span class="token punctuation">.</span><span class="token class-name">NumberingDefinitionsPart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>relationships<span class="token punctuation">.</span></span><span class="token class-name">Relationship</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">CTCompat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">FldChar</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">FooterReference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Ftr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Hdr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">HdrFtrRef</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">HeaderReference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Jc</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">JcEnumeration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">ObjectFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">P</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">PPr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">R</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">STFldCharType</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">SectPr</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>docx4j<span class="token punctuation">.</span>wml<span class="token punctuation">.</span></span><span class="token class-name">Text</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Html2DocxService</span> <span class="token punctuation">{</span>

    <span class="token comment">// Factory for creating WML Object.</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">ObjectFactory</span> factory <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token function">getWmlObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * Convert HTML to DOCX(OPENXML).
     * 
     * <span class="token keyword">@param</span> <span class="token parameter">html</span> the source, a HTML file
     * <span class="token keyword">@param</span> <span class="token parameter">docx</span> the target, a DOCX file
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">convert</span><span class="token punctuation">(</span><span class="token class-name">File</span> html<span class="token punctuation">,</span> <span class="token class-name">File</span> docx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// Creates a WordprocessingMLPackage, using default page size and orientation,</span>
            <span class="token comment">// default to A4 portrait.</span>
            <span class="token class-name">WordprocessingMLPackage</span> pack <span class="token operator">=</span> <span class="token class-name">WordprocessingMLPackage</span><span class="token punctuation">.</span><span class="token function">createPackage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">NumberingDefinitionsPart</span> numDefPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NumberingDefinitionsPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            pack<span class="token punctuation">.</span><span class="token function">getMainDocumentPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>numDefPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            numDefPart<span class="token punctuation">.</span><span class="token function">unmarshalDefaultNumbering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Convert XHTML + CSS to WordML content.</span>
            <span class="token comment">// XHTML must be well formed XML.</span>
            <span class="token class-name">XHTMLImporterImpl</span> importer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XHTMLImporterImpl</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Convert the well formed XHTML contained in file to a list of WML objects.</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> importer<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">MainDocumentPart</span> mainPart <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">getMainDocumentPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Add all WML objects to MainDocumentPart.</span>
            mainPart<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// create footer</span>
            <span class="token class-name">Ftr</span> footer <span class="token operator">=</span> <span class="token function">createFooterWithPageNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FooterPart</span> footerPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FooterPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerPart<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerPart<span class="token punctuation">.</span><span class="token function">setJaxbElement</span><span class="token punctuation">(</span>footer<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Relationship</span> footerRelation <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>footerPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">FooterReference</span> footerRef <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFooterReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerRef<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>footerRelation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            footerRef<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">HdrFtrRef</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">SectPr</span> sectPr <span class="token operator">=</span> pack<span class="token punctuation">.</span><span class="token function">getDocumentModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSections</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSectPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sectPr<span class="token punctuation">.</span><span class="token function">getEGHdrFtrReferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>footerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// create header</span>
            <span class="token class-name">Hdr</span> header <span class="token operator">=</span> <span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token string">&quot;åŒ—äº¬****ç§‘æŠ€æœ‰é™å…¬å¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HeaderPart</span> headerPart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HeaderPart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerPart<span class="token punctuation">.</span><span class="token function">setPackage</span><span class="token punctuation">(</span>pack<span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerPart<span class="token punctuation">.</span><span class="token function">setJaxbElement</span><span class="token punctuation">(</span>header<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Relationship</span> headerRelation <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">addTargetPart</span><span class="token punctuation">(</span>headerPart<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HeaderReference</span> headerRef <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createHeaderReference</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerRef<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>headerRelation<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            headerRef<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token class-name">HdrFtrRef</span><span class="token punctuation">.</span><span class="token constant">DEFAULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sectPr<span class="token punctuation">.</span><span class="token function">getEGHdrFtrReferences</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>headerRef<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// set compatibilityMode to 15</span>
            <span class="token comment">// to avoid Word 365/2016 saying &quot;Compatibility Mode&quot;</span>
            <span class="token class-name">DocumentSettingsPart</span> settingsPart <span class="token operator">=</span> mainPart<span class="token punctuation">.</span><span class="token function">getDocumentSettingsPart</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CTCompat</span> compat <span class="token operator">=</span> <span class="token class-name">Context</span><span class="token punctuation">.</span><span class="token function">getWmlObjectFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createCTCompat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            compat<span class="token punctuation">.</span><span class="token function">setCompatSetting</span><span class="token punctuation">(</span><span class="token string">&quot;compatibilityMode&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://schemas.microsoft.com/office/word&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            settingsPart<span class="token punctuation">.</span><span class="token function">getContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setCompat</span><span class="token punctuation">(</span>compat<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// save to a file</span>
            pack<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>docx<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Docx4JException</span> <span class="token operator">|</span> <span class="token class-name">JAXBException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token string">&quot;covert html to docx error.&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// create a header</span>
    <span class="token keyword">private</span> <span class="token class-name">Hdr</span> <span class="token function">createHeader</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Hdr</span> header <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createHdr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">P</span> paragraph <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PPr</span> ppr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createPPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jc</span> jc <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createJc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jc<span class="token punctuation">.</span><span class="token function">setVal</span><span class="token punctuation">(</span><span class="token class-name">JcEnumeration</span><span class="token punctuation">.</span><span class="token constant">CENTER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ppr<span class="token punctuation">.</span><span class="token function">setJc</span><span class="token punctuation">(</span>jc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">setPPr</span><span class="token punctuation">(</span>ppr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Text</span> text <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
        header<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> header<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// create a header with page number</span>
    <span class="token keyword">private</span> <span class="token class-name">Ftr</span> <span class="token function">createFooterWithPageNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ftr</span> ftr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFtr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">P</span> paragraph <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">PPr</span> ppr <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createPPr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jc</span> jc <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createJc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jc<span class="token punctuation">.</span><span class="token function">setVal</span><span class="token punctuation">(</span><span class="token class-name">JcEnumeration</span><span class="token punctuation">.</span><span class="token constant">RIGHT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ppr<span class="token punctuation">.</span><span class="token function">setJc</span><span class="token punctuation">(</span>jc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">setPPr</span><span class="token punctuation">(</span>ppr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addFieldBegin</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addPageNumberField</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addFieldEnd</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        ftr<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>paragraph<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> ftr<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addPageNumberField</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Text</span> txt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        txt<span class="token punctuation">.</span><span class="token function">setSpace</span><span class="token punctuation">(</span><span class="token string">&quot;preserve&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        txt<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">&quot; PAGE   \* ArabicDash &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span><span class="token function">createRInstrText</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFieldBegin</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FldChar</span> fldChar <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFldChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fldChar<span class="token punctuation">.</span><span class="token function">setFldCharType</span><span class="token punctuation">(</span><span class="token class-name">STFldCharType</span><span class="token punctuation">.</span><span class="token constant">BEGIN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fldChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addFieldEnd</span><span class="token punctuation">(</span><span class="token class-name">P</span> paragraph<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FldChar</span> fldChar <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createFldChar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fldChar<span class="token punctuation">.</span><span class="token function">setFldCharType</span><span class="token punctuation">(</span><span class="token class-name">STFldCharType</span><span class="token punctuation">.</span><span class="token constant">END</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">R</span> run <span class="token operator">=</span> factory<span class="token punctuation">.</span><span class="token function">createR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        run<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>fldChar<span class="token punctuation">)</span><span class="token punctuation">;</span>
        paragraph<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>run<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HTML2DocxException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">436242367279880231L</span><span class="token punctuation">;</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">,</span> <span class="token keyword">boolean</span> enableSuppression<span class="token punctuation">,</span>
                <span class="token keyword">boolean</span> writableStackTrace<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">,</span> enableSuppression<span class="token punctuation">,</span> writableStackTrace<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span> <span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">public</span> <span class="token class-name">HTML2DocxException</span><span class="token punctuation">(</span><span class="token class-name">Throwable</span> cause<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>cause<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æµ‹è¯•ä»£ç ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">HTML_FILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;/xxx/test.html&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">DOCX_FILE_NAME</span> <span class="token operator">=</span> <span class="token string">&quot;/xxx/test.docx&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Html2DocxService</span> service <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Html2DocxService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        service<span class="token punctuation">.</span><span class="token function">convert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token constant">HTML_FILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token constant">DOCX_FILE_NAME</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¾…è½¬æ¢çš„ç¤ºä¾‹çš„HTMLï¼Œæ³¨æ„è¯¥HTMLä¸€å®šè¦æ»¡è¶³XHTMLæ ¼å¼ï¼Œå³æ ‡ç­¾å¿…é¡»æ­£ç¡®åµŒå¥—ï¼Œä¸”æ ‡ç­¾å¿…é¡»è¢«å…³é—­</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Strict//EN&quot; &quot;http://www.w3.org/TR/html4/strict.dtd&quot;&gt;
&lt;html lang=&quot;zh&quot;&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
&lt;title&gt;HTMLè½¬DOCXæµ‹è¯•ç¤ºä¾‹&lt;/title&gt;
&lt;style type=&quot;text/css&quot;&gt;
h1 {
	text-align: center;
}
table {
	border-collapse: collapse;
	width: 100%;
}
table th {
	text-align: center;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;div&gt;
		&lt;h1&gt;HTMLè½¬DOCXæµ‹è¯•ç¤ºä¾‹&lt;/h1&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;table border=&quot;1&quot;&gt;
			&lt;tr&gt;
				&lt;th width=&quot;20%&quot;&gt;ç¼–å·ï¼š&lt;/th&gt;
				&lt;td&gt;E125800&lt;/td&gt;
				&lt;th width=&quot;20%&quot;&gt;æ—¥æœŸï¼š&lt;/th&gt;
				&lt;td&gt;2020-01-10&lt;/td&gt;
			&lt;/tr&gt;
			&lt;tr&gt;
				&lt;th width=&quot;20%&quot;&gt;å®¡æ ¸ï¼š&lt;/th&gt;
				&lt;td&gt;å®¡æ ¸äºº&lt;/td&gt;
				&lt;th width=&quot;20%&quot;&gt;éƒ¨é—¨ï¼š&lt;/th&gt;
				&lt;td&gt;æŠ€æœ¯éƒ¨&lt;/td&gt;
			&lt;/tr&gt;
		&lt;/table&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;ä»¥ä¸‹ä¸ºç¤ºä¾‹å†…å®¹ã€‚&lt;/p&gt;
		&lt;h2&gt;é†‰èŠ±é˜´Â·è–„é›¾æµ“äº‘æ„æ°¸æ˜¼&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;ææ¸…ç…§&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;è–„é›¾æµ“äº‘æ„æ°¸æ˜¼ï¼Œç‘è„‘é”€é‡‘å…½ã€‚ä½³èŠ‚åˆé‡é˜³ï¼Œç‰æ•çº±å¨ï¼ŒåŠå¤œå‡‰åˆé€ã€‚&lt;br /&gt;ä¸œç¯±æŠŠé…’é»„æ˜åï¼Œæœ‰æš—é¦™ç›ˆè¢–ã€‚è«é“ä¸é”€é­‚ï¼Œå¸˜å·è¥¿é£ï¼Œäººæ¯”é»„èŠ±ç˜¦ã€‚&lt;/p&gt;
		&lt;h2&gt;å¿µå¥´å¨‡Â·èµ¤å£æ€€å¤&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;è‹è½¼&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;å¤§æ±Ÿä¸œå»ï¼Œæµªæ·˜å°½ï¼Œåƒå¤é£æµäººç‰©ã€‚&lt;br /&gt;æ•…å’è¥¿è¾¹ï¼Œäººé“æ˜¯ï¼Œä¸‰å›½å‘¨éƒèµ¤å£ã€‚&lt;br /&gt;ä¹±çŸ³ç©¿ç©ºï¼ŒæƒŠæ¶›æ‹å²¸ï¼Œå·èµ·åƒå †é›ªã€‚&lt;br /&gt;æ±Ÿå±±å¦‚ç”»ï¼Œä¸€æ—¶å¤šå°‘è±ªæ°ã€‚&lt;br /&gt;é¥æƒ³å…¬ç‘¾å½“å¹´ï¼Œå°ä¹”åˆå«äº†ï¼Œé›„å§¿è‹±å‘ã€‚&lt;br /&gt;ç¾½æ‰‡çº¶å·¾ï¼Œè°ˆç¬‘é—´ï¼Œæ¨¯æ©¹ç°é£çƒŸç­ã€‚&lt;br /&gt;æ•…å›½ç¥æ¸¸ï¼Œå¤šæƒ…åº”ç¬‘æˆ‘ï¼Œæ—©ç”Ÿåå‘ã€‚&lt;br /&gt;äººç”Ÿå¦‚æ¢¦ï¼Œä¸€å°Šè¿˜é…¹æ±Ÿæœˆã€‚&lt;/p&gt;
		&lt;h2&gt;ç™»é£æ¥å³°&lt;/h2&gt;
		&lt;p&gt;&lt;em&gt;ç‹å®‰çŸ³&lt;/em&gt;&lt;/p&gt;
		&lt;p&gt;é£æ¥å±±ä¸Šåƒå¯»å¡”ï¼Œé—»è¯´é¸¡é¸£è§æ—¥å‡ã€‚&lt;br /&gt;ä¸ç•æµ®äº‘é®æœ›çœ¼ï¼Œåªç¼˜èº«åœ¨æœ€é«˜å±‚ã€‚&lt;/p&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;ç½‘ç»œå›¾ç‰‡&lt;/p&gt;
		&lt;img src=&quot;https://www.baidu.com/img/flexible/logo/pc/result.png&quot; alt=&quot;ç™¾åº¦LOGO&quot; /&gt;
	&lt;/div&gt;
	&lt;div&gt;
		&lt;p&gt;ä»¥ä¸‹ä¸ºåˆ—è¡¨ã€‚&lt;/p&gt;
		&lt;p&gt;&lt;strong&gt;æ— åºåˆ—è¡¨ï¼š&lt;/strong&gt;&lt;/p&gt;
		&lt;ul&gt;
			&lt;li&gt;æ— åºåˆ—è¡¨é¡¹ä¸€&lt;/li&gt;
			&lt;li&gt;æ— åºåˆ—è¡¨é¡¹äºŒ&lt;/li&gt;
			&lt;li&gt;æ— åºåˆ—è¡¨é¡¹ä¸‰&lt;/li&gt;
			&lt;li&gt;æ— åºåˆ—è¡¨é¡¹å››&lt;/li&gt;
			&lt;li&gt;æ— åºåˆ—è¡¨é¡¹äº”&lt;/li&gt;
		&lt;/ul&gt;
		&lt;p&gt;&lt;strong&gt;æœ‰åºåˆ—è¡¨ï¼š&lt;/strong&gt;&lt;/p&gt;
		&lt;ol&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹ä¸€&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹äºŒ&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹ä¸‰&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹å››&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹äº”&lt;/li&gt;
		&lt;/ol&gt;
		&lt;p&gt;&lt;strong&gt;åµŒå¥—åˆ—è¡¨ï¼š&lt;/strong&gt;&lt;/p&gt;
		&lt;ol&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹ä¸€&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹äºŒ&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹ä¸‰
				&lt;ol style=&quot;list-style: lower-alpha;&quot;&gt;
					&lt;li&gt;åˆ—è¡¨é¡¹ä¸‰çš„å­é¡¹1&lt;/li&gt;
					&lt;li&gt;åˆ—è¡¨é¡¹ä¸‰çš„å­é¡¹2&lt;/li&gt;
					&lt;li&gt;åˆ—è¡¨é¡¹ä¸‰çš„å­é¡¹3&lt;/li&gt;
					&lt;li&gt;åˆ—è¡¨é¡¹ä¸‰çš„å­é¡¹4&lt;/li&gt;
					&lt;li&gt;åˆ—è¡¨é¡¹ä¸‰çš„å­é¡¹5&lt;/li&gt;
				&lt;/ol&gt;
			&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹å››&lt;/li&gt;
			&lt;li&gt;æœ‰åºåˆ—è¡¨é¡¹äº”&lt;/li&gt;
		&lt;/ol&gt;
	&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è½¬åŒ–åçš„Wordæ–‡æ¡£å¦‚ä¸‹ï¼š</p><p><img src="/assets/4112b3c1.6d50ed3f.png" alt=""><img src="/assets/8da0ed71.7bf88aa2.png" alt=""><img src="/assets/d34c94c7.c0c12793.png" alt=""></p><p><strong>å‚è€ƒä»£ç 2ï¼š</strong></p><p>å¼•å…¥ä¾èµ–</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-ImportXHTML&lt;/artifactId&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»£ç å®ç°ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>StopWatch stopWatch = new StopWatch();
stopWatch.start(&quot;task1&quot;);
WordprocessingMLPackage wordMLPackage = WordprocessingMLPackage.createPackage();
MainDocumentPart mdp = wordMLPackage.getMainDocumentPart();
String xhtml = &quot;&lt;html&gt;&lt;head&gt;&lt;title&gt;task1&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;p&gt;é•¿å¤§ä¸Šè¯¾äº†!&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;;
mdp.addAltChunk(AltChunkType.Xhtml, xhtml.getBytes());
WordprocessingMLPackage pkgOut = mdp.convertAltChunks();
XmlUtils.marshaltoString(pkgOut.getMainDocumentPart().getJaxbElement(), true, true)
pkgOut.save(new java.io.File(System.getProperty(&quot;user.dir&quot;) + &quot;/test.docx&quot;));
System.out.println(stopWatch.currentTaskName());
stopWatch.stop();
System.out.println(stopWatch.getLastTaskTimeMillis());
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å®ç°æ–¹å¼3-ä½¿ç”¨openhtmltopdfå¼€æºæ¡†æ¶-https-github-com-danfickle-openhtmltopdf" tabindex="-1"><a class="header-anchor" href="#å®ç°æ–¹å¼3-ä½¿ç”¨openhtmltopdfå¼€æºæ¡†æ¶-https-github-com-danfickle-openhtmltopdf" aria-hidden="true">#</a> å®ç°æ–¹å¼3ï¼šä½¿ç”¨openhtmltopdfå¼€æºæ¡†æ¶ï¼ˆhttps://github.com/danfickle/openhtmltopdfï¼‰</h4><p>pom.xmlå¼•å…¥</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- ALWAYS required. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Required for PDF output. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-pdfbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Required for image output only. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-java2d<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need right-to-left or bi-directional text support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-rtl-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need HTML5 parsing support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-jsoup-dom-converter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need logging via slf4j. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need logging via log4j. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need SVG support. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-svg-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- Optional, leave out if you do not need MathML support. --&gt;</span>
    <span class="token comment">&lt;!-- Introduced in RC-13. --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.openhtmltopdf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>openhtmltopdf-mathml-support<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${openhtml.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»£ç ä½¿ç”¨</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>public class OpenHtmlToPDF {
    public static void main(String[] args) {
        try (OutputStream os = new FileOutputStream(&quot;F://pdf//pdfbox//out3.pdf&quot;)) { // è¾“å‡ºçš„pdf
            PdfRendererBuilder builder = new PdfRendererBuilder();
            builder.useFastMode();
            //ä¸‹é¢è¿™ä¸ªæ–¹æ³•æ˜¯è¦è‡ªå·±æŒ‡å®š å­—ä½“æ–‡ä»¶   ä¸ç„¶è½¬å‡ºçš„pdfæ–‡ä»¶ä¸­ ä¸­æ–‡ä¼šå˜æˆ####
            builder.useFont(new FSSupplier&lt;InputStream&gt;() {
                @Override
                public InputStream supply() {
                    try {
                        //æŒ‡å®š å­—ä½“æ–‡ä»¶
                        return new FileInputStream(&quot;F://pdf//pdfbox//simhei.ttf&quot;);
                    } catch (FileNotFoundException e) {
                        e.printStackTrace();
                    }
                    return null;
                }
            }, &quot;simhei&quot;, 400, BaseRendererBuilder.FontStyle.NORMAL, true); //ç¬¬äºŒä¸ªå‚æ•° ä¸€å®šè¦å’Œæ–‡ä»¶åä¸€æ ·ï¼ï¼ä½œç”¨åœ¨htmlé¡µé¢ä¸Š  
            builder.withHtmlContent(readTxt(&quot;F://pdf//pdfbox//pdf-css3.html&quot;),                              
 
            Surrogate.Generator.class.getResource(&quot;/root.htm&quot;).toExternalForm());
            //ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯htmlé¡µé¢  ç¬¬äºŒä¸ªå‚æ•° æ˜¯ä¸€ä¸ªå…¨ç©ºçš„æ–‡ä»¶ é‡Œé¢ä»€ä¹ˆéƒ½æ²¡æœ‰ ä½†æ˜¯åç¼€ä¸€å®šè¦æ˜¯ã€‚htm  ä½œç”¨ç±»ä¼¼äºä¸€ä¸ªç”»æ¿ å¦‚æœä¸æ·»åŠ è¿™ä¸ªå‚æ•°æˆ–è€…ç½®ä¸ºnull åˆ™htmlæ–‡ä»¶ä¸­çš„å›¾ç‰‡ ä¸ä¼šè½¬åŒ– æ‰€ä»¥ä¸€å®šéœ€è¦åŠ  
 
 
            builder.toStream(os);
            builder.run();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>htmlé¡µé¢æ³¨æ„äº‹é¡¹</p><p>1.å…³äºå­—ä½“ ã€‚</p><p>å¦‚æœè‡ªå·±æŒ‡å®šå­—ä½“æ–‡ä»¶ï¼Œé‚£ä¹ˆè¦åœ¨htmlé¡µé¢ä¸Š åŠ å…¥</p><pre><code>&lt;style&gt;
* {
  font-family: &#39;simhei&#39;;   //valueæ˜¯æŒ‡å®šå­—ä½“æ—¶ ç¬¬äºŒä¸ªå‚æ•°
}
&lt;/style&gt;
</code></pre><p>2.æ ‡ç­¾ä¸€å®šè¦æœ‰é—­åˆ ä¸ç„¶ä¼šè§£æå¤±è´¥</p><h4 id="å®ç°æ–¹å¼4-ä½¿ç”¨spire-doc-jar" tabindex="-1"><a class="header-anchor" href="#å®ç°æ–¹å¼4-ä½¿ç”¨spire-doc-jar" aria-hidden="true">#</a> å®ç°æ–¹å¼4ï¼šä½¿ç”¨Spire.Doc.jar</h4><p>åœ¨ç¼–è¾‘ä»£ç å‰ï¼Œè¯·å…ˆåœ¨ç¨‹åºä¸­å¯¼å…¥Spire.Doc.jarï¼Œå¯¼å…¥æ–¹æ³•å¦‚ä¸‹ï¼š</p><p>æ–¹æ³•1ï¼šå°†Free Spire.Doc for JavaåŒ… ä¸‹è½½ åˆ°æœ¬åœ°ï¼Œè§£å‹ï¼Œæ‰¾åˆ°libæ–‡ä»¶å¤¹ä¸‹çš„Spire.Doc.jaræ–‡ä»¶ã€‚ç„¶ååœ¨IDEAä¸­æ‰“å¼€â€œProject Structureâ€ç•Œé¢ï¼Œç„¶åæ‰§è¡Œå¦‚å›¾æ­¥éª¤æ¥æ‰‹åŠ¨å¯¼å…¥æœ¬åœ°è·¯å¾„ä¸‹çš„jaræ–‡ä»¶ï¼š</p><p><img src="/assets/0bc3ebcd.6c630f46.png" alt=""></p><p>æ–¹æ³•2ï¼šé€šè¿‡ Mavenä»“åº“ ä¸‹è½½å¯¼å…¥ï¼Œå¦‚ä¸‹é…ç½®pom.xmlï¼š</p><pre><code>&lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;com.e-iceblue&lt;/id&gt;
            &lt;name&gt;e-iceblue&lt;/name&gt;
            &lt;url&gt;https://repo.e-iceblue.cn/repository/maven-public/&lt;/url&gt;
        &lt;/repository&gt;
&lt;/repositories&gt;
&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;e-iceblue&lt;/groupId&gt;
        &lt;artifactId&gt;spire.doc.free&lt;/artifactId&gt;
        &lt;version&gt;5.2.0&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre><p>å®Œæˆå¯¼å…¥åï¼Œæ‰§è¡Œå¦‚ä¸‹ä»£ç æ¥è½¬æ¢ï¼š</p><p>Java</p><pre><code>import com.spire.doc.*;
import com.spire.doc.documents.XHTMLValidationType;

public class HTMLtoWord {
public static void main(String[] args) {
//åŠ è½½htmlæ–‡ä»¶
Document doc = new Document();
doc.loadFromFile(&quot;F:\\IDEAProject\\Conversion_Doc\\æš´é›¨é¿é™©æŒ‡å—.html&quot;, FileFormat.Html, XHTMLValidationType.None);

        //ä¿å­˜ä¸ºWordæ ¼å¼åˆ°æŒ‡å®šè·¯å¾„
        doc.saveToFile(&quot;htmltoWord.docx&quot;,FileFormat.Docx_2013);
    }
}
</code></pre><p><img src="/assets/3787b61a.9fadfbb8.png" alt=""><img src="/assets/265896b3.34b648f0.png" alt=""></p><h3 id="æ–¹æ¡ˆ2-åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°-ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£-ä¸æ˜¯åŸç”Ÿçš„" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ2-åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°-ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£-ä¸æ˜¯åŸç”Ÿçš„" aria-hidden="true">#</a> æ–¹æ¡ˆ2. åˆ©ç”¨xmlæ ¼å¼çš„æ¨¡æ¿å®ç°(ç”Ÿæˆçš„æ˜¯è½¬æ¢è¿‡çš„xmlæ ¼å¼çš„wordæ–‡æ¡£ï¼Œä¸æ˜¯åŸç”Ÿçš„)</h3><ol><li>åˆ›å»ºwordæ¨¡æ¿ï¼Œå¦å­˜ä¸ºxmlæ ¼å¼</li><li>åœ¨å¡«å……çš„åœ°æ–¹è®¾ç½®ftlæŒ‡ä»¤ï¼Œä¿å­˜ä¸ºfreemarkeræ ¼å¼çš„æ–‡ä»¶</li><li>åˆ©ç”¨æ¨¡æ¿å¼•æ“è¿›è¡Œæ•°æ®å¡«å……æ¸²æŸ“ï¼Œè¿”å›æ–‡ä»¶æµ</li><li>å°†æ–‡ä»¶æµç›´æ¥ä¿å­˜ä¸ºdocæˆ–è€…docx</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>        //åŠ è½½FTLæ¨¡æ¿æ‰€ç”¨åˆ°çš„APi
        Configuration configuration = new Configuration(new Version(&quot;2.3.23&quot;));
        configuration.setDefaultEncoding(&quot;utf-8&quot;);
        configuration.setClassForTemplateLoading(this.getClass(), &quot;/&quot;);
 
 
        //ä»¥utf-8çš„ç¼–ç è¯»å–ftlæ–‡ä»¶
        Template template = null;
 
        try {
            template = configuration.getTemplate(&quot;å­¦ç”Ÿä¿¡æ¯.ftl&quot;, &quot;utf-8&quot;);
        } catch (IOException ex) {
            throw new Exception(&quot;è¯»å–ftlæ–‡ä»¶å¤±è´¥!&quot;, ex);
        }
        Writer writer  = null;
 
 
        // 4.ç”Ÿæˆ Wordæ–‡æ¡£çš„å…¨è·¯å¾„åç§°
        File outFile = new File(&quot;å­¦ç”Ÿä¿¡æ¯.docx&quot;);
        writer = new OutputStreamWriter(new FileOutputStream(outFile), &quot;utf-8&quot;);
        // 6.è£…è½½æ•°æ®
        template.process(map, writer);
        response.setContentType(&quot;application/vnd.openxmlformats-officedocument.wordprocessingml.document&quot;);
        response.setHeader(&quot;Content-Dispostion&quot;,&quot;attachment;filename=&quot;+&quot;å­¦ç”Ÿä¿¡æ¯.docx&quot;);
        // 7.è¯»å–ç”Ÿæˆå¥½çš„ Wordæ–‡æ¡£
        File file = new File(&quot;å­¦ç”Ÿä¿¡æ¯.docx&quot;);
        FileInputStream is = new FileInputStream(file);
        OutputStream os = response.getOutputStream();
        byte[] b = new byte[1024];
        int length;
        while ((length = is.read(b)) &gt; 0) {
            os.write(b, 0, length);
        }
 
        os.flush();
        os.close();
        writer.flush();
        writer.close();
        return null;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ†é¡µç¬¦</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;#--Wordåˆ†é¡µç¬¦--&gt;
&lt;w:p &gt;&lt;w:r&gt;&lt;w:br w:type=&quot;page&quot; /&gt;&lt;/w:r&gt;&lt;/w:p&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ–¹æ¡ˆ3-åˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿-æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿-å¦å­˜ä¸ºzip-ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document-xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿-ç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ3-åˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿-æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿-å¦å­˜ä¸ºzip-ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document-xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿-ç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word" aria-hidden="true">#</a> æ–¹æ¡ˆ3ï¼Œåˆ©ç”¨xmlæ ¼å¼çš„æ–‡ä»¶ä½œä¸ºæ¨¡æ¿(æ–°å»ºdocxæ ¼å¼çš„æ¨¡æ¿ï¼Œå¦å­˜ä¸ºzip,ä»¥å‹ç¼©æ–‡ä»¶ä¸­çš„document.xmlæ–‡ä»¶åˆ¶ä½œæ¨¡æ¿ï¼Œç”Ÿæˆçš„æ–‡ä»¶æ˜¯åŸç”Ÿçš„word)</h3><p>docxæ–‡ä»¶æ¨¡æ¿åˆ›å»º é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨æ¡Œé¢æ­£å¸¸åˆ›å»ºä¸€ä¸ªdocxæ–‡ä»¶ <img src="/assets/bcbe62ac.a6f3caf7.png" alt=""> ç„¶åæ‰“å¼€è¿™ä¸ªdocxæ–‡ä»¶ï¼Œå°†ä½ éœ€è¦çš„åŸºç¡€æ¨¡æ¿å¡«å…¥è¿™ä¸ªæ–‡æ¡£ <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwUAAAC4CAIAAAA9u9cYAAAPPUlEQVR4Xu3dsW7jSJoHcL+CMI/gdEK9g6PDbeb0cJeMXsHRJB00/AAt4DY3MMFmegJnC+zCgKIdwJ3vQu+gq1OhazlFiaJtUv4o/n5oGBJZpAsUvuK/i6R8swcAmLebegEAwMzIQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3MlDAMDcyUMAwNzJQwDA3E0mD/3222/1IgBgIoKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg53F5CAAYXfDzuDwEAIwu+HlcHgIARhf8PC4PAQCjC34el4cAgNEFP4/LQwDA6IKfx+UhAGB0wc/j8hAAMLrg5/Gx8tBvI6h/BwAwEfVJfQj17/iAsfIQAMBUyEMAwNzJQwDA3MlDAMDcTT4P7Xa79PP+/n61WtXrGr5+/Xp3wu3tbd36YLFYvL6+lrdPT08PDw/pxWazSb/u3+1+eH5+Xi6X9dIf0laph7m3AEAoE8tDOaC8vLyk8JEjzs3NTXqbokZ6mxaeyhxfD+qlB2kP9aKDannZQ/otORhV0vLUn/I2tcl5K4WkFK3Si9zDxhYAQAjHo0BYKQ+lbLE8uL293Ww2Of2UsJLyUFrVjkQfyUPpRZ5GSnK+yS+y0r7KQ+n1er1OWa0sOev7Qb0UABjZ8SgQXxU+mnEnzxWVVVla0gwxTWfzUFZ+Rb7y1VyV91PmgZIUg9LPt84G/eWgXgoAjOx4FIivIw8d1dGgyj1pzzk55WmhFHGaazvkC2Tl7dk8tNvtvn371pzKkocA4FNMKQ+VpFJNxtw1LmYV1S3P/fNQttlsmsuPzi2t1+vGFv/fJnXp6ekpv707dLLZPjUol89yGNput//eXh4CgE9yJApczP++RbVtNT/UfNt8KKz4+sbrZavVKi0v18XuGr8rqwJW6kC+sSn9lhyJ0ib5ZqbcIAWgMtV0NAzt5SEA+CRHosDFtFPOKe2WzQCU4kXKQLeHx+bT65RjNpvNH1q/UdpJ2lvOQzkSVRHq7jDZ08xDaUm+Xvby8pI2TP1Jr/MkU74i1nxKP4WhX0+QhwDg8mLlob/97e//9d//k35Wy9stnw9f9vP09HT347rVYrFIySNllOaVso5poUq+tlW2yvNDaYf5Af6yqmjOD+ULeSWi5Qmq/PVFafPcvfSiXErbbrePj4/t+SEA4FMEykP//Ne/Uhj6j//8U/r5j99/b65qtkwhI8egFDhS1ChXx1IMSm9TLjl6vayputZWyY/0p5/N62jNe5Wy5vxQvm2oumaXr47lqFSmrwqRCADiCJSH9odIlPJQFYb2jZYp9KRgkXJPjkTNNmlJSjDVPc7F8+GrGnNU6s5D5auuj95XlK+FVQvbu80zTPl12mHzPusiRyJfOAQAn+7IKf9iSsppBqCUh8rrFI/yi9KyPJ3ezjT5CtfziUfcHx4eSkDJ9z6XmZ7lclk9epZ/S85DaVXzMbH8EH7RvDZXupRvnS49Sb+6eWt2kzAEABF8fh7K9wyVSFTyUL58lu8las8kVfdT50mdzWZTnucqs0G5QX74q71th/b80P1BdeWrKLtNbcr+V4dHzFJP0s+0vPltQwBAEPUp/5Jyysn3DJ36l9aWllmKFCl5rNfrnDmenp7yjUR5bcofd4cHu8rD7fvDHM/d4en3nEjel4dystkf5nuOJpu827Q2336UOpaSU2mZQ9vRC2cAwOf6/DyU54fKpbGz80P5Tuf8cFl6nbJO9TfC8vWpcgksB6Y8V5RW5YzSzkMvB80lOQ+lDfNt2vlBs7wq7Tzts/rVOQ/tDg//50fS2jczpSXtIAUAfK7Pz0P7xn1C+3P3D73V6+F7gJqp5fXwDHz+eqFKdYvPzSEP5ZTTvi0pLzfZAwBXIEQeKv7x++8pDzXjUdZuCQAwlEB5KIWh8v1DVSSShwCA8QTKQ/u3fD81AMBQYuWhU/q3BAB4q0/OQ/3VGwMADOQz89Cb1A+DAQDTUZ/Xg4nevyL+oQQ+Qo3DFYtf4NH7V8Q/lMBHqHG4YvELPHr/iviHEvgINQ5XLH6BR+9fEf9QAh+hxuGKxS/w6P0rhjqUaT/V3ykDIhikxhU4xDRIgY8qev+Ks4cy/5XWttvb22azs/s5a7fb/fUHf5wVhtJdmwocJu1UbTYrrl53Wcf7F9CpQ9m2Wq3af1g+DZp5aOvez2azyX+4vl7RsN1uvx18+fLl0z8/uBrdtVm8u8BTXec/5Jx+dtS4AocxnKrNZsXV6y7reP8COnUo29Jg154wL5uf2k8aTFcHy+WyY6xsSp+f4RKGcqo2K+8r8FTUqbRfX1/T67R5et0OVRUFDgM6VZtFqrh60WWd6V8cZw9llka61LLMpS8Wi7z87HCZBsenp6f0Im3VzkMpLaWPqpo8N1zCgE7VZtO7CzylqM1mU96m12nz8laBw9iatXmq4ppvL+/42BHQqWGucn9/n2NN1h4lz+6nnYfyJ7fdbpsL94ZLGNTZ2twPUeDZ8/NzyUMKHC6g1GZHxVVLLqzX2BFBn2Eu/Z9vuVyWt6+vr/3/+1hUeejUJ7c3XMKgztbmIAWePRzsFThcSq7N7oqrF11Wr7EjgrPDXBor840F6b+PeRauOSXef7is8lD6hH49zXAJQ+muzaEKfH+46JaCVN6JAofLyLXZXXH1Npd1fuwIonuYy/9TLDcApf9EpsEu/f+vJJv+w2WVh1KMfXx8PBpmgQF11OaABZ7CUPOObAUOl5FrM3LFnRk74jg7zDXvzMqPiTVHvf7DZfv+ocifH1yN7tocpMCfn5/bj6cpcLiAUpthK65r7Aile5hry4+flLc9h8v9sTy0//H5ff/+vVoODOVsbTa9o8BTGFosFu1n9fcKHMbXrM2YFXdy7IimY5hry7PrafgrS9r3GZxyNA8l0T45uDJna7N4R4GnTdozQ00KHEZV1WbAijs+dgR0aphr2+12y+UyPzzSdnY/p/IQMKqztZm9r8BTXZ/9AkZgPKdqM47o/St6Hsp8f8BqtapX/HBqP2m4vGmpGwGj6VNx7y7wurYP6kbAaOJXXPT+FWcPZX74NjU7+h/H19fX1ODp6ensfoBP0V2bChwmLX5tRu9fcfZQpqEwDZfNWwqadrvdzeHvOJozh5i6a1yBw6R1F3gE0ftXxD+UwEeocbhi8Qs8ev+K+IcS+Ag1DlcsfoFH718R/1ACH6HG4YrFL/Do/SviH0rgI9Q4XLH4BR69f0X8Qwl8hBqHKxa/wKP3r7gBACarPq8HE71/RfxDCXyEGocrFr/Ao/eviH8ogY9Q43DF4hd49P4V8Q8l8BFqHK5Y/AKP3r8i/qEEPkKNwxWLX+DR+1f0P5SbzWa1Wu12u3oFEFj/GgcmJ36BR+9f0fNQphi0WCzW63V68fXr19vb27s/6rmfDmnPf/1B6oKhvKk2lSFMy6kCb9Zyve6yjvcvoFOHsikd1uVyuVqt6hW9bTabFKdSkKpXNGy3228HX758+fTPD65GnxovlCFMy6kCb9Zyve6yjvcvoFOHsnh5eflIGEpZanWQdtKdh4r0+RmIYShna/woZQiTcLbAUy3Xiy7rTP/iOHsoU4hZr9f5dXrx/Pz8x/VnpE2enp7Si7u7u3YeSmkpfVTVtLyBGAZ0tsaVIUxXs8BP1XLz7eWdGYDiODtWFq+vr4vFYrPZ1Cv6aeeh/Mltt9vmwr2BGAbVXePKECatFHhHLVdLLqxrAAqle6xsSoFmvV6nSFTdSV3c3t62Z4CKuz/moVOf3N5ADIPqqHFlCFOXC7y7lutFl3VyAIqmY6xsyjcA1UsPnp+fU9apl7ZUeSh9Qr+eZiCGoXTUuDKEqcsF3l3L9TaXdXIAiqZjrCxSjsnTQvWKg/floRRjHx8fj4ZZYEAdNa4MYepygUeu5ZMDUDQdY2V2f3+/XC43m82p0PO+PLSP/fnB1eiucWUIk1YKPGwtdw1AoXSPlftD3Nntdh2hp2NVUzsP7X98ft+/f6+WA0M5W+PKEKarWeAxa/nMABTH2bEy6wg9HauajuahJNonB1emT40rQ5ioqsAD1vL5ASiIPmPlvjP0dKxqOpWHgFH1rHFgiuIXePT+FT0PZUfo6Vi1P8Sgm5a6ETAaFQdXLH6BR+9f0fNQHg09zwfr9frdf80DGFvPGgemKH6BR+9f0fNQptzT/v6hh4eHxWJxf3//8vJSrQKC6FnjwBTFL/Do/SviH0rgI9Q4XLH4BR69f0X8Qwl8hBqHKxa/wKP3r4h/KIGPUONwxeIXePT+FfEPJfARahyuWPwCj96/4gYAmKz6vB5M9P4BAFfgz29Rbzy+KeWh+OkSADiqf8rp33JAU0oY8hAATFT/lNO/5YCmlDDkIQCYqP4pp3/LAU0pYchDADBR/VNO/5YDmlLCkIcAYKL6p5z+LQc0pYRxKg99P6iXAgBh9E85/VsO6HjCiOlUHvrLQb0UAAijf8rp33JAxxNGTDkP7Xa7b9++pZ9luTwEAMH1Tzn9Ww5oYnkoh6HtdttcLg8BQHD9U07/lgOaUh766aef2mFoLw8BQHj9U07/lgOaUh765Zdffj1BHgKAyPqnnP4tBzSlPPTzzz8/Pj6254cAgOD6p5z+LQc0pTx0c3OTwpBIBACT0z/l9G85oInlofQzRyJfOAQAE/Lnt6g3Ht/08tD+8AWMf1wDAPB+k8xDAAADmlLCkIcAgDFMKWHIQwDAGKaUMOQhAGAMU0oY8hAAMIYpJQx5CAAYw5QShjwEAIxhSglDHgIAxiBhAABzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBzJw8BAHMnDwEAcycPAQBz93+bZb9AsQ33lwAAAABJRU5ErkJggg==" alt=""> ä¿å­˜æ–‡ä»¶ï¼Œå¹¶é€€å‡ºwordï¼Œå°†åˆšæ‰çš„docxæ–‡ä»¶åç¼€ä¿®æ”¹ä¸ºzip <img src="/assets/f8312906.e27f61c3.png" alt=""> æ‰“å¼€è¿™ä¸ªå‹ç¼©åŒ…ï¼Œæ‰¾åˆ°ä¸‹é¢wordæ–‡ä»¶å¤¹ä¸‹çš„document.xmlï¼Œå¹¶å°†å®ƒå¤åˆ¶å‡ºæ¥ <img src="/assets/413a28e3.f257ea89.png" alt=""> æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨Notepadæ‰“å¼€</p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯è¦å­¦ç€è¯»æ‡‚DocMLäº†ï¼ˆåº”è¯¥æ²¡æœ‰DocMLè¿™ä¸ªä¸œè¥¿ï¼Œæˆ‘è·Ÿç€HTMLç¼–çš„ï¼Œè¿˜æœ‰è¿™ä¸ªä¸œè¥¿ä¹Ÿè®¸å¾®è½¯å¼€å‘è€…è”ç›Ÿä¹‹ç±»çš„åœ°æ–¹æœ‰æ–‡æ¡£å§ï¼Œåæ­£ç›®å‰æˆ‘æ˜¯æ²¡æœ‰æ‰¾åˆ°æ ‡ç­¾æ–‡æ¡£ï¼Œå…¨é çŒœï¼‰ï¼Œæ¯”å¦‚å°†åŸæ¥çš„w:træ ‡ç­¾è¿›è¡Œå¤åˆ¶ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„è¡Œï¼ŒæŠŠä»–çš„ç¬¬ä¸€ä¸ªåˆ—æ”¹æˆè¡Œ2ï¼Œç„¶åæˆ‘ä»¬æŠŠè¿™ä¸ªxmlä¸¢å›åˆ°åŸæ¥çš„æ¨¡æ¿zipä¸­ï¼Œå†æŠŠå®ƒæ”¹å›docxç”¨wordæ‰“å¼€ï¼Œçœ‹ä¸€ä¸‹ï¼ˆåŒæ ·æ¨èä¸€ä¸‹è§£å‹å·¥å…·ä½¿ç”¨winrarï¼Œå…è´¹é™¤äº†æœ‰å¹¿å‘Šç«ç»’èƒ½æ‹¦æˆªå¤–ï¼Œéƒ½èƒ½è§£å‹ï¼Œä¸ºä»€ä¹ˆæ¨èç”¨winrarå‘¢ï¼Ÿå› ä¸ºå‡ºç°è¿‡åŒäº‹ç”µè„‘ä¸Šçš„æ‚ç‰Œå­è§£å‹è½¯ä»¶ä¸èƒ½æŠŠè¿™ä¸ªxmlä¸¢å›å»æ›¿æ¢çš„é—®é¢˜ï¼Œæˆ‘å°±åªèƒ½æ¨èä¸€ä¸ªæˆ‘ç”¨ç€èƒ½æˆåŠŸçš„è½¯ä»¶äº†ï¼‰ <img src="/assets/b88b4b92.7717729f.png" alt=""><img src="/assets/57c0f2b9.46f5cea9.png" alt=""> çœ‹ï¼Œè¿™æ—¶ä»–å°±æ„£ç”Ÿç”Ÿçš„å¤šå‡ºæ¥äº†ä¸€è¡Œï¼ŒåŒæ—¶æˆ‘ä»¬ä¹ŸéªŒè¯äº†ï¼Œé€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬åªéœ€è¦åˆ©ç”¨Freemarkerä¿®æ”¹è¿™ä¸ªXMLï¼Œå¹¶æ›¿æ¢zipä¸­xmlä¿®æ”¹åç¼€ä¸ºdocxï¼Œå°±èƒ½å¾—åˆ°è‡ªå·±æƒ³è¦çš„Wordæ–‡ä»¶äº†</p><p>Freemarkeræ”¹é€ æ¨¡æ¿ æ”¹é€ æ¨¡æ¿æ—¶é¢‡æœ‰ä¸€ç§å†™JSPçš„æ—¢è§†æ„Ÿï¼Œé¦–å…ˆæˆ‘å…ˆè´´ä¸ŠFreemarkerçš„æ–‡æ¡£è¿æ¥ï¼Œå…ˆåˆæ­¥äº†è§£ä¸€ä¸‹Freemarkerå¦‚ä½•ç¼–è¾‘æ¨¡æ¿ï¼Œå½“ç„¶ï¼Œè¿™é‡Œä¹Ÿä¼šå…ˆæä¾›æœ€ç®€å•çš„ï¼Œä¹Ÿæ˜¯æˆ‘åœ¨åšæ¨¡æ¿æ—¶æœ€å¸¸ç”¨çš„Freemarkeræ ‡ç­¾ï¼š</p><pre><code>æ™®é€šæ’å€¼ï¼šä½¿ç”¨${xxxxxx}
å¾ªç¯æ’å€¼ï¼šä½¿ç”¨æ ‡ç­¾ &lt;#list xxxxList as xxxx&gt;${xxxx}&lt;/#list&gt;å…¶ä¸­xxxxListä¸ºListæˆ–Arrayå¯¹è±¡
ç©ºå€¼åˆ¤æ–­ï¼š${xxxxx!&quot;&quot;}å…¶è¡¨ç¤ºçš„æ„æ€å°±æ˜¯å¦‚æœxxxxxä¸ºç©ºï¼Œåˆ™ä½¿ç”¨â€â€œ,ä»æˆ‘ä½¿ç”¨çš„ç»éªŒè€Œè¨€ï¼ŒåšWordçš„æ¨¡æ¿æœ€å¥½æ‰€æœ‰çš„å˜é‡éƒ½å¸¦ä¸Šè¿™ä¸ªç©ºå€¼é»˜è®¤å¡«å……ç©ºï¼Œå¦åˆ™ä¼šæŠ¥é”™çš„
å…¶ä»–æ›´è¯¦å°½çš„Freemarkerç©æ³•ï¼Œå°±è¦å»çœ‹å®˜ç½‘çš„ä»‹ç»äº†Freemarkeræ–‡æ¡£
</code></pre><p>æœ€ç»ˆæ”¹é€ å¥½åï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š <img src="/assets/35a9a182.f4ea9dfb.png" alt=""> å‰è€…ä¸ºFreemarkeræ¨¡æ¿ï¼Œåè€…ä¸ºdocxæºæ–‡ä»¶æ›´æ”¹äº†æ–‡ä»¶åç¼€</p><p>è¿™é¢åˆ†äº«ä¸€äº›ç»éªŒï¼Œè™½ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨wordä¸­å°†æ‰€æœ‰çš„${}æå‰é¢„åˆ¶åœ¨æ–‡æ¡£ç¼–è¾‘é¡µé¢ï¼Œä»è€Œå‡å°‘åœ¨ç¼–è¾‘XMLæ—¶æ›¿æ¢å˜é‡æ—¶çš„å·¥ä½œé‡ï¼Œä½†æ˜¯ä»æˆ‘æ˜¯ç”¨çš„ç»éªŒè§’åº¦è®²ï¼Œå°±ç®—è¿™æ ·å¡«å……å¥½äº†æ¨¡æ¿ï¼Œä¹Ÿä¸è¦ç›´æ¥æŠŠXMLæ‹¿å‡ºæ¥å°±ç”¨ï¼Œå› ä¸ºwordåœ¨ä¸€äº›æƒ…å†µä¸‹ä¼šå°†æˆ‘ä»¬çš„${}æ ‡ç­¾åˆ†æˆå¤šä¸ªXmlæ ‡ç­¾ï¼Œä»è€Œåœ¨Freemarkerå¤„ç†æ–‡æ¡£æ—¶ï¼Œæ‰¾ä¸åˆ°ä½ æƒ³è¦çš„é‚£ä¸ªå˜é‡ï¼Œä¹Ÿå°±æ— æ³•æ­£å¸¸æ›¿æ¢å¦‚ï¼š <img src="/assets/05c4738c.1b3e5c77.png" alt=""></p><p><strong>ç”±åˆ›å»ºå¥½çš„docxæ–‡ä»¶æ¨¡æ¿ä¸Freemarker XMLæ¨¡æ¿åˆ›å»ºDocxæ–‡ä»¶</strong></p><p>å¥½çš„ï¼Œå„ä½é€šè¿‡å‰é¢çš„å°èŠ‚ï¼Œå·²ç»å¯ä»¥äº†è§£åˆ°åŸºæœ¬çš„åŸç†äº†ï¼Œä»è¿™å¼€å§‹ï¼Œå°±è¦å¼€å§‹æœ‰ä»£ç å±‚é¢çš„ä¸œè¥¿äº†ï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬è¦ä¸ºé¡¹ç›®å¼•å…¥Freemarkerçš„mavenï¼Œæˆ‘ä¸ªäººä½¿ç”¨çš„æ˜¯è¿™ä¸ªMavenç‰ˆæœ¬</p><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>freemarker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.3.31<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªè·å–Freemarkeræ–‡ä»¶è¾“å…¥æµçš„å·¥å…·ç±»ï¼ŒæŠŠæˆ‘ä»¬çš„xmlæ–‡ä»¶å¡«å……ä¸Šæˆ‘ä»¬çš„æ•°æ®ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>import cn.hutool.core.io.resource.ClassPathResource;
import freemarker.template.Configuration;
import freemarker.template.Template;
import freemarker.template.TemplateException;

import java.io.*;

public class FreemarkUtils {

    /**
     * æ ¹æ®æŒ‡å®šxmlç”Ÿæˆæ–‡ä»¶(é»˜è®¤å°†æ–‡æ¡£æ”¾åœ¨resource/staticä¸‹)
     * @param orgData æ¨¡æ¿æ‰€éœ€æ•°æ®
     * @param buildXml åˆ›å»ºçš„æ¨¡æ¿å
     * @param outFilePath æ¨¡æ¿è¾“å‡ºæ–‡ä»¶ç›®å½•ä¸
     * @param outFileName æ¨¡æ¿è¾“å‡ºæ–‡ä»¶æ–‡ä»¶å
     * @throws IOException
     * @throws TemplateException
     */
    public static void createFreemarkFile(Object orgData,String buildXml,String outFilePath,String outFileName) throws IOException, TemplateException {
        Configuration configuration = new Configuration();
        configuration.setDefaultEncoding(&quot;utf-8&quot;);
        configuration.setDirectoryForTemplateLoading(new ClassPathResource(&quot;static/&quot;).getFile());
        //ä»¥utf-8çš„ç¼–ç è¯»å–ftlæ–‡ä»¶
        Template template =  configuration.getTemplate(buildXml,&quot;utf-8&quot;);
        Writer out = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(outFilePath + outFileName), &quot;utf-8&quot;),10240);
        template.process(orgData, out);
        out.close();
    }

    /**
     * è·å–æ¨¡æ¿è¾“å…¥æµ
     * @param dataMap   å‚æ•°
     * @param templateName  æ¨¡æ¿åç§°
     * @param tempPath  æ¨¡æ¿è·¯å¾„ classesä¸‹çš„è·¯å¾„ å¦‚æœæ˜¯classes/staticä¸‹çš„æ¨¡æ¿  ä¼ å…¥ /staticå³å¯
     * @return
     */
    public static ByteArrayInputStream getFreemarkerContentInputStream(Object dataMap, String templateName, String tempPath) {
        ByteArrayInputStream in = null;

        try {
            //åˆ›å»ºé…ç½®å®ä¾‹
            Configuration configuration = new Configuration();

            //è®¾ç½®ç¼–ç 
            configuration.setDefaultEncoding(&quot;UTF-8&quot;);

            //ftlæ¨¡æ¿æ–‡ä»¶ç»Ÿä¸€æ”¾è‡³ com.lun.template åŒ…ä¸‹é¢
            configuration.setClassForTemplateLoading(FreemarkUtils.class, tempPath);
            //è·å–æ¨¡æ¿
            Template template = configuration.getTemplate(templateName);

            StringWriter swriter = new StringWriter();
            //ç”Ÿæˆæ–‡ä»¶
            template.process(dataMap, swriter);
//            String result = swriter.toString();
in = new ByteArrayInputStream(swriter.toString().getBytes());

        } catch (Exception e) {
            e.printStackTrace();
        }
        return in;
    }

}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªç±»ä¸­è¿˜é™„å¸¦äº†ä¸€ä¸ªcreateFreemarkFileæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯ç›´æ¥ç”Ÿæˆä¸€ä¸ªæ™®é€šçš„è½¬æ¢è¿‡çš„xmlæ–‡æ¡£ï¼Œå¯ä»¥åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å…ˆçœ‹ä¸€ä¸‹æ¨¡æ¿æ˜¯å¦åˆ¶ä½œæ­£å¸¸</p><p>æˆ‘ä»¬å°†æ¨¡æ¿æ”¾åœ¨é¡¹ç›®çš„resourcesä¸‹çš„/staticä¸­ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„æ¨¡æ¿ï¼ˆä¸è¦æ…Œå¼ ï¼Œæˆ‘åªæ˜¯åœ¨è¿™æ”¹ä¸ªåï¼Œç”¨äº†ä¸ªå·²ç»åšå¥½çš„æ›´å¤æ‚çš„æ¨¡æ¿è€Œå·²ï¼‰ <img src="/assets/d0939ac9.5078855b.png" alt=""> è¿™ä¸ªæ–¹æ³•å°±æ˜¯ä½¿ç”¨è°ƒç”¨ä¸Šé¢å·¥å…·ç±»ä¸­æ ¹æ®Freemarkeræ¨¡æ¿ç”Ÿæˆå¥½çš„æ•°æ®ï¼Œå¹¶å°†å…¶æ›¿æ¢åˆ°zipæ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶è¾“å‡ºåæ˜¯å¯æ ¹æ®åæœŸä¸ªäººéœ€è¦è¿›è¡Œä¿®æ”¹</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**
* freemarkç”Ÿæˆword----docxæ ¼å¼(æ•°æ®æºé»˜è®¤æ”¾åœ¨resources/static)
* @param data æ•°æ®æº
* @param documentXmlName  document.xmlæ¨¡æ¿çš„æ–‡ä»¶å(ç”Ÿæˆçš„æ–‡æœ¬æ•°æ®)
* @param docxTempName   docxæ¨¡æ¿çš„æ–‡ä»¶åï¼ˆdocx zipæ–‡ä»¶ï¼‰
* @return ç”Ÿæˆçš„æ–‡ä»¶è·¯å¾„
*/
public static File createApplyDocx(Object data,
String documentXmlName,
String docxTempName,
String outFilePath) {
ZipOutputStream zipout = null;//wordè¾“å‡ºæµ
File tempPath = null;//docxæ ¼å¼çš„wordæ–‡ä»¶è·¯å¾„
try {
//freemarkæ ¹æ®æ¨¡æ¿ç”Ÿæˆå†…å®¹xml
//================================è·å– document.xml è¾“å…¥æµ================================
ByteArrayInputStream documentInput = FreemarkUtils.getFreemarkerContentInputStream(data, documentXmlName, File.separator + &quot;static&quot; + File.separator);
//================================è·å– document.xml è¾“å…¥æµ================================
//è·å–ä¸»æ¨¡æ¿docx
ClassPathResource resource = new ClassPathResource(&quot;static&quot; + File.separator + docxTempName);
File docxFile = resource.getFile();

            ZipFile zipFile = new ZipFile(docxFile);
            Enumeration&lt;? extends ZipEntry&gt; zipEntrys = zipFile.entries();

            //è¾“å‡ºwordæ–‡ä»¶è·¯å¾„å’Œåç§°
            String fileName = &quot;applyWord_&quot; + System.currentTimeMillis() + &quot;.docx&quot;;
            String outPutWordPath = outFilePath + fileName;

            tempPath = new File(outPutWordPath);
            //å¦‚æœè¾“å‡ºç›®æ ‡æ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º
            if (!tempPath.getParentFile().exists()) {
                tempPath.mkdirs();
            }
            //docxæ–‡ä»¶è¾“å‡ºæµ
            zipout = new ZipOutputStream(new FileOutputStream(tempPath));

            //å¾ªç¯éå†ä¸»æ¨¡æ¿docxæ–‡ä»¶,æ›¿æ¢æ‰ä¸»å†…å®¹åŒºï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è·å–çš„document.xmlçš„å†…å®¹
            //------------------è¦†ç›–æ–‡æ¡£------------------
            int len = -1;
            byte[] buffer = new byte[1024];
            while (zipEntrys.hasMoreElements()) {
                ZipEntry next = zipEntrys.nextElement();
                InputStream is = zipFile.getInputStream(next);
                if (next.toString().indexOf(&quot;media&quot;) &lt; 0) {
                    zipout.putNextEntry(new ZipEntry(next.getName()));
                    if (&quot;word/document.xml&quot;.equals(next.getName())) {
                        //å†™å…¥å¡«å……æ•°æ®åçš„ä¸»æ•°æ®ä¿¡æ¯
                        if (documentInput != null) {
                            while ((len = documentInput.read(buffer)) != -1) {
                                zipout.write(buffer, 0, len);
                            }
                            documentInput.close();
                        }
                    }else {//ä¸æ˜¯ä¸»æ•°æ®åŒºçš„éƒ½ç”¨ä¸»æ¨¡æ¿çš„
                        while ((len = is.read(buffer)) != -1) {
                            zipout.write(buffer, 0, len);
                        }
                        is.close();
                    }
                }
            }
            //------------------è¦†ç›–æ–‡æ¡£------------------
            zipout.close();//å…³é—­

        } catch (Exception e) {
            e.printStackTrace();
            try {
                if(zipout!=null){
                    zipout.close();
                }
            }catch (Exception ex){
                ex.printStackTrace();
            }
        }
        return tempPath;
    }
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>File docxFile = DOC2PDFUtils.createApplyDocx(vo,
&quot;é¡¹ç›®å»ºè®®ä¹¦docxç‰ˆæœ¬.xml&quot;,
&quot;é¡¹ç›®å»ºè®®ä¹¦.zip&quot;,
&quot;D:/&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å½“è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬çš„docxæ–‡ä»¶å°±è¢«ç”Ÿæˆäº†</p><p><strong>æ‰“åŒ…Windowsä¸‹çš„ttfå­—ä½“æ–‡ä»¶ç”Ÿæˆttcå­—ä½“æ–‡ä»¶åŒ…</strong></p><p>åœ¨æ­£å¼è´´å…¥docxè½¬pdfçš„åŠŸèƒ½å‰ï¼Œé¦–å…ˆæˆ‘è¦å…ˆä»‹ç»ä¸€ä¸‹å­—ä½“åŒ…çš„æ‰“åŒ…ï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨å·¥å…·ç±»ï¼Œå°†è¿›è¡Œæ–‡ä»¶æ“ä½œçš„æ—¶å€™ï¼Œæœ€æ‹…å¿ƒçš„å°±æ˜¯Linuxçš„å…¼å®¹é—®é¢˜ï¼Œä»¥å‰äº†è§£è¿‡ä¸€äº›ç±»ä¼¼çš„å·¥å…·ç±»ï¼Œä½†æ˜¯å¾ˆå¤šéƒ½æ˜¯ä½¿ç”¨officeçš„dllæ–‡ä»¶åšçš„ä¸­é—´ä»¶ï¼Œåˆ°äº†Linuxä¸Šã€‚ã€‚ã€‚ã€‚ä¸€è¨€éš¾å°½ã€‚</p><p>è¿™ä¸ªå°èŠ‚å°±æ˜¯ä¸ºä¸‹é¢docxè½¬pdfæ—¶çš„æœ€åä¸€å…³ï¼Œå­—ä½“ï¼Œæ‰“ä¸‹åŸºç¡€ã€‚</p><p>æˆ‘å·²å°†æ‰“åŒ…å·¥å…·ä¸Šä¼ åˆ°CSDNçš„æ–‡ä»¶å…±äº«ä¸­ï¼Œå®¡æ ¸è¿‡åï¼Œå°†ä¼šé™„å¸¦é“¾æ¥ï¼Œä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘è®¾ç½®çš„æ˜¯0å¸ä¸‹è½½ã€‚ fontforgeå·¥å…·ä¸‹è½½</p><p>æ‰“å¼€å·¥å…·ç›®å½•åï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¿™æ ·çš„ç›®å½•ç»“æ„ <img src="/assets/3e91e1f5.c46f2471.png" alt=""> æˆ‘ä»¬é€‰æ‹©æ‰“å¼€fontforge.batè¿™ä¸ªæ–‡ä»¶ï¼Œå°†ä¼šçœ‹åˆ°è¿™æ ·çš„è§†çª— <img src="/assets/a4d254ac.0308787b.png" alt=""> å½“ç„¶ï¼Œè¿™ä¸ªä¸œè¥¿æˆ‘ä»¬å…ˆä¸è¦ç®¡ä»–ï¼Œä¸»è¦çš„æ˜¯è¦å…ˆæ‰¾åˆ°æˆ‘ä»¬æ‰€éœ€è¦çš„å­—ä½“æ–‡ä»¶ï¼Œè¿›å…¥è¿™ä¸ªç›®å½•</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>C:\Windows\Fonts
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ‘ä»¬å°†çœ‹åˆ°å½“å‰ç³»ç»Ÿä¸‹æ‰€æœ‰çš„å­—ä½“æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ç­‰çº¿å­—ä½“ä½œä¸ºèŒƒä¾‹ <img src="/assets/ac53524c.5842a0ec.png" alt=""> æœç´¢åï¼Œæ‰¾åˆ°æ‰€éœ€çš„å­—ä½“ï¼Œé€‰ä¸­åCTRL+Cè¿›è¡Œå¤åˆ¶ï¼Œåœ¨fontforgeå·¥å…·æ–‡ä»¶å¤¹åŒçº§ç›®å½•è¿›è¡Œç²˜è´´ <img src="/assets/e9ad4479.55d0e0d3.png" alt=""> è¿™æ—¶æˆ‘ä»¬å‘ç°ï¼Œè™½ç„¶åªå¤åˆ¶äº†ä¸€ä¸ªç­‰çº¿å­—ä½“ï¼Œä½†æ˜¯å®é™…ä¸Šå´å¤åˆ¶å‡ºäº†å¤šä¸ªæ–‡ä»¶ï¼Œä¸è¿‡æ²¡é—®é¢˜ï¼Œæˆ‘ä»¬æŠŠä»–ä»¬è¿›è¡Œåˆå¹¶ç”Ÿæˆæ‰€éœ€è¦çš„ttcå­—ä½“é›†åˆå³å¯ï¼Œå›åˆ°åˆšæ‰æ‰“å¼€çš„çª—å£ä¸­ï¼Œé€‰æ‹©ä¸Šé¢çš„..è¿”å›ä¸Šä¸€å±‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°å·¥å…·å·²ç»è¯†åˆ«åˆ°äº†è¿™ä¸‰ä¸ªå°å®¶ä¼™äº†ï¼ŒCTRLå¤šé€‰ä»–ä»¬åï¼Œç‚¹å‡»å·¦ä¸‹è§’çš„æ‰“å¼€ <img src="/assets/7113c146.b1eb1051.png" alt=""> ç®€å•ç­‰å¾…åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸‰ä¸ªå­—ä½“æ–‡ä»¶å°±è¢«è§£ææ‰“å¼€äº† <img src="/assets/00f7537d.3d264aeb.png" alt=""> è¿™æ—¶æˆ‘ä»¬éšä¾¿åœ¨ä¸€ä¸ªçª—å£çš„ æ–‡ä»¶-&gt;ç”Ÿæˆttc <img src="/assets/4b306ed3.d7a906d4.png" alt=""> ä¸ºä»–èµ·ä¸€ä¸ªåå­—ï¼Œç„¶åç‚¹å‡»Generateé™é™å¼€å§‹ç­‰å¾… <img src="/assets/ccf93266.80317597.png" alt=""> å½“çª—å£æ¶ˆå¤±ï¼Œå³å¯æ‰¾åˆ°åˆšåˆšç”Ÿæˆçš„ttcæ–‡ä»¶ <img src="/assets/779aceb2.44432080.png" alt=""> ä»å±æ€§æ–‡ä»¶çš„å¤§å°ä»¥åŠåŒå‡»æ‰“å¼€ttcæ–‡ä»¶çš„æè¿°ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ‰€éœ€è¦çš„å­—ä½“å·²ç»è¢«æ•´åˆåˆ°ä¸€èµ·äº†ï¼Œä¸Šé¢æœ‰ç»†å¿ƒçš„å°ä¼™ä¼´åº”è¯¥èƒ½çœ‹åˆ°ï¼Œåœ¨æˆ‘é¡¹ç›®ä¸­ä¸æ¨¡æ¿åŒçº§çš„ä½ç½®ï¼Œå°±æ”¾ç€ç­‰çº¿ï¼ˆdengxian.ttcï¼‰å®‹ä½“ï¼ˆsimsun.ttcï¼‰è¿™ä¸¤ä¸ªå­—ä½“çš„ttcæ•´åˆåŒ…äº† <img src="/assets/17553719.a1096c62.png" alt=""><img src="/assets/7be8de9e.a99023f3.png" alt=""></p><p><strong>å°†docxæ–‡ä»¶è½¬æ¢ä¸ºPdf</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ç»è¿‡å‰é¢çš„é“ºå«ï¼Œæˆ‘ä»¬æœ€ç»ˆæ¥åˆ°äº†docxæ–‡ä»¶è½¬pdfæ–‡ä»¶çš„ç¯èŠ‚ï¼Œé¦–å…ˆæˆ‘ä»¬å…ˆå¼•å…¥Mavené…ç½®

&lt;dependency&gt;
   &lt;groupId&gt;com.itextpdf&lt;/groupId&gt;
    &lt;artifactId&gt;itextpdf&lt;/artifactId&gt;
    &lt;version&gt;5.4.3&lt;/version&gt;
&lt;/dependency&gt;
&lt;!-- https://mvnrepository.com/artifact/org.docx4j/docx4j --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j&lt;/artifactId&gt;
    &lt;version&gt;6.0.1&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
        &lt;/exclusion&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-export-fo&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-core&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.docx4j&lt;/groupId&gt;
    &lt;artifactId&gt;docx4j-JAXB-ReferenceImpl&lt;/artifactId&gt;
    &lt;version&gt;8.1.6&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸‹é¢æ˜¯å®ç°ä»£ç ï¼Œé€šè¿‡PhysicalFonts.addPhysicalFontså¼•å…¥æˆ‘ä»¬æ‰€å¯¼å¥½çš„å­—ä½“æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨fontMapper.putåˆ›å»ºWordä¸­ä½¿ç”¨çš„å­—ä½“ç±»å‹ä¸å­—ä½“æ–‡ä»¶ä¹‹é—´çš„å¯¹ç…§å…³ç³»</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>/**
* wordï¼ˆdocxï¼‰è½¬pdf
* @param wordPath  docxæ–‡ä»¶è·¯å¾„
* @return  ç”Ÿæˆçš„å¸¦æ°´å°çš„pdfè·¯å¾„
*/
public static File convertDocx2Pdf(String wordPath,String pdfOutPath) {
String regex=&quot;.*(Courier New|Arial|Times New Roman|Comic Sans|Georgia|Impact|Lucida Console|Lucida Sans Unicode|Palatino Linotype|Tahoma|Trebuchet|Verdana|Symbol|Webdings|Wingdings|Wingdings 2|MS Sans Serif|MS Serif).*&quot;;
Date startDate = new Date();
PhysicalFonts.setRegex(regex);
String pdfNoMarkPath = null;

        OutputStream os = null;
        InputStream is = null;
        try {
            is = new FileInputStream(new File(wordPath));
            WordprocessingMLPackage mlPackage = WordprocessingMLPackage.load(is);
            Mapper fontMapper = new IdentityPlusMapper();

            PhysicalFonts.addPhysicalFonts(&quot;SimSun&quot;, FreemarkUtils.class.getResource(&quot;/static/simsun.ttc&quot;));
            PhysicalFonts.addPhysicalFonts(&quot;DengXian&quot;, FreemarkUtils.class.getResource(&quot;/static/dengxian.ttc&quot;));
            // fontMapper.put(&quot;Helvetica&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;å®‹ä½“&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;å®‹ä½“ (ä¸­æ–‡æ­£æ–‡)&quot;, PhysicalFonts.get(&quot;SimSun&quot;));
            fontMapper.put(&quot;ç­‰çº¿&quot;, PhysicalFonts.get(&quot;DengXian&quot;));
            mlPackage.setFontMapper(fontMapper);
            //è¾“å‡ºpdfæ–‡ä»¶è·¯å¾„å’Œåç§°
            String fileName = &quot;pdfNoMark_&quot; + System.currentTimeMillis() + &quot;.pdf&quot;;
            // String pdfNoMarkPath = System.getProperty(&quot;java.io.tmpdir&quot;).replaceAll(separator + &quot;$&quot;, &quot;&quot;) + separator + fileName;
            pdfNoMarkPath = pdfOutPath + fileName;

            os = new java.io.FileOutputStream(pdfNoMarkPath);
            //docx4j  docxè½¬pdf
            FOSettings foSettings = Docx4J.createFOSettings();

            foSettings.setWmlPackage(mlPackage);
            Docx4J.toFO(foSettings, os, Docx4J.FLAG_EXPORT_PREFER_XSL);

            is.close();//å…³é—­è¾“å…¥æµ
            os.close();//å…³é—­è¾“å‡ºæµ

            return new File(pdfNoMarkPath);
        } catch (Exception e) {
            e.printStackTrace();
            try {
                if(is != null){
                    is.close();
                }
                if(os != null){
                    os.close();
                }
            }catch (Exception ex){
                ex.printStackTrace();
            }
        }finally {
        // è¿™é‡ŒåŸæœ¬æ˜¯å°†wordæ–‡ä»¶è¿›è¡Œåˆ é™¤ï¼Œç”±äºæˆ‘çš„ä¸šåŠ¡ä¸Šä¸éœ€è¦å¯¹è¿™ä¸ªæ–‡ä»¶è¿›è¡Œåˆ é™¤ï¼Œæ‰€ä»¥å°±ç§»é™¤äº†è¿™æ®µä»£ç 
//            File file = new File(wordPath);
//            if(file!=null&amp;&amp;file.isFile()&amp;&amp;file.exists()){
//                file.delete();
//            }
}
return null;
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€åè°ƒç”¨è¿™ä¸ªæ–¹æ³•å³å¯</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// docxFileä¸ºä¸Šé¢ç”Ÿæˆçš„Docxæ–‡ä»¶
File pdfFile = DOC2PDFUtils.convertDocx2Pdf(docxFile.getAbsolutePath(),&quot;D:/&quot;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œå­—ä½“è¦æ ¹æ®ä¸ªäººä½¿ç”¨æƒ…å†µè¿›è¡Œé€‚å½“è°ƒæ•´ï¼Œæ‰€ä½¿ç”¨çš„å­—ä½“å¯ä»¥åœ¨XMLæ¨¡æ¿ä¸­çœ‹åˆ°ï¼Œå¦‚ï¼š</p><p>å½“è¿™ä¸ªæ–¹æ³•è¿è¡Œæ—¶ï¼Œå¯ä»¥æ ¹æ®æ§åˆ¶å°æŠ¥é”™è¿›è¡Œå­—ä½“æ–‡ä»¶çš„è°ƒæ•´</p><p><a href="https://blog.csdn.net/weixin_33374585/article/details/114719233" target="_blank" rel="noopener noreferrer">å‚è€ƒæ–‡ç« <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="æ–¹æ¡ˆ4-åˆ©ç”¨docx4jå®ç°" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ4-åˆ©ç”¨docx4jå®ç°" aria-hidden="true">#</a> æ–¹æ¡ˆ4ï¼Œåˆ©ç”¨docx4jå®ç°</h3><p><a href="https://github.com/plutext/docx4j" target="_blank" rel="noopener noreferrer">docx4jå¼€æºåœ°å€<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/qq_31905135/article/details/80431042" target="_blank" rel="noopener noreferrer">å‚è€ƒæ–‡ç« -åˆ©ç”¨docx4jå®Œç¾å¯¼å‡ºwordæ–‡æ¡£ï¼ˆæ ‡ç­¾æ›¿æ¢ã€æ’å…¥å›¾ç‰‡ã€ç”Ÿæˆè¡¨æ ¼ï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/weixin_34295316/article/details/86022702" target="_blank" rel="noopener noreferrer">å‚è€ƒæ–‡ç« -ã€docx4jã€‘docx4jæ“ä½œdocxï¼Œå®ç°æ›¿æ¢å†…å®¹ã€è½¬æ¢pdfã€htmlç­‰æ“ä½œ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://blog.csdn.net/zhyh1986/article/details/8766131" target="_blank" rel="noopener noreferrer">docx4j -- ä½¿ç”¨Javaå¤„ç†word2007ï¼ˆ.docxï¼‰æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="æ–¹æ¡ˆ4-é€šè¿‡xdocreportå’Œfreemarkeræ¨¡æ¿å¼•æ“ç”Ÿæˆwordæ–‡æ¡£" tabindex="-1"><a class="header-anchor" href="#æ–¹æ¡ˆ4-é€šè¿‡xdocreportå’Œfreemarkeræ¨¡æ¿å¼•æ“ç”Ÿæˆwordæ–‡æ¡£" aria-hidden="true">#</a> æ–¹æ¡ˆ4ï¼Œé€šè¿‡XDocReportå’ŒFreeMarkeræ¨¡æ¿å¼•æ“ç”ŸæˆWordæ–‡æ¡£</h3><p>å‡†å¤‡ç¯å¢ƒ å¼€å‘è¯­è¨€ï¼š</p><p>Java7åŠä»¥ä¸Šçš„ç‰ˆæœ¬ã€‚</p><p>å¼€å‘å·¥å…·ï¼š</p><p>Eclipse/Ideaã€‚</p><p>ç¬¬ä¸‰æ–¹ä¾èµ–åº“ï¼š</p><p>XDocReportã€POIã€Freemarkerã€‚</p><p>æ¨¡æ¿è¯­è¨€ï¼š</p><p>FreeMarkerã€‚</p><p>Wordç¼–è¾‘å™¨ï¼š</p><p>Microsoft 365æˆ–å…¶ä»–ç‰ˆæœ¬è¾ƒé«˜çš„Wordç¼–è¾‘å™¨ã€‚</p><p>ç¤ºä¾‹Wordæ¨¡æ¿ <img src="/assets/e3d9b961.493d9c28.png" alt=""></p><p>åˆ¶ä½œæ¨¡æ¿ Wordæ¨¡æ¿å¦‚ä¸Šå›¾ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œç»“æ„æ¯”è¾ƒç®€å•ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯çº¯æ–‡å­—å’Œæ•°å­—ï¼Œç¬¬äºŒéƒ¨åˆ†ä¸»è¦æ˜¯è¡¨æ ¼ã€‚æˆ‘ä»¬åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ç”Ÿæˆçš„æŠ¥è¡¨å‡ ä¹éƒ½æ˜¯åŠ¨æ€ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æ¨¡æ¿ä¸­çš„æ•°å­—å’Œè¡¨æ ¼é‡Œçš„æ•°æ®éƒ½è¦æ›¿æ¢æˆæˆ‘ä»¬åå°çš„å®é™…æ•°æ®ã€‚</p><p>æ›¿æ¢Wordæ¨¡æ¿ä¸­çš„åŠ¨æ€å˜é‡ï¼Œæˆ‘ä»¬éœ€è¦æŒæ¡ä¸¤ä¸ªçŸ¥è¯†ç‚¹ï¼š</p><pre><code>1.Wordæ–‡æ¡£ä¸­çš„WordåŸŸï¼ŒwordåŸŸæ˜¯å¼•å¯¼Wordåœ¨æ–‡æ¡£ä¸­è‡ªåŠ¨æ’å…¥æ–‡å­—ã€å›¾å½¢ã€é¡µç æˆ–å…¶ä»–ä¿¡æ¯çš„ä¸€ç»„ä»£ç ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥æŠŠ         WordåŸŸç†è§£æˆæ ‡è¯†ç¬¦ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦è¡¨ç¤ºWordæ–‡æ¡£ä¸­è¦è¢«æ›¿æ¢çš„å†…å®¹ï¼›

2.FreeMarkeræ¨¡æ¿ä¸‹çš„å˜é‡è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ç”¨${city}æ›¿æ¢Wordç¤ºä¾‹æ¨¡æ¿ä¸­çš„åŒ—äº¬å¸‚ã€‚
</code></pre><p>äº†è§£äº†ä»¥ä¸Šä¸¤ä¸ªæ¦‚å¿µåï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ¨æ‰‹ç¼–è¾‘Wordæ¨¡æ¿äº†ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>é¦–å…ˆåœ¨Wordæ¨¡æ¿ä¸­é€‰ä¸­è¦æ›¿æ¢çš„æ–‡æœ¬ï¼Œåœ¨è¿™å„¿æ‹¿æ ‡é¢˜ä¸­çš„&quot;åŒ—äº¬å¸‚&quot;ä¸ºä¾‹ï¼Œç„¶åé”®ç›˜ä½¿ç”¨ Ctrl + F9 ç»„åˆé”®å°†å…¶è®¾ç½®ä¸ºåŸŸï¼Œæ­¤æ—¶æ–‡æœ¬ä¼šè¢«&quot;{}&quot;åŒ…å›´ï¼Œæ¥ç€é¼ æ ‡å³é”®é€‰æ‹©ã€ç¼–è¾‘åŸŸ(E)...ã€‘ï¼š <img src="/assets/992873fe.097f08b8.png" alt=""></p></li><li><p>åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œç±»åˆ«é€‰æ‹©â€œé‚®ä»¶åˆå¹¶â€ï¼ŒåŸŸåé€‰æ‹© &quot;MergeField&quot;ï¼ŒåŸŸå±æ€§ä¸­çš„åŸŸåå¡«å…¥æ¨¡ç‰ˆè¡¨è¾¾å¼${city}ï¼Œç‚¹å‡»ã€ç¡®å®šã€‘æŒ‰é’®: <img src="/assets/de3a5407.fb0b51db.png" alt=""></p></li><li><p>ç¼–è¾‘åçš„æ•ˆæœå¦‚ä¸‹ï¼š</p></li></ol><p><img src="/assets/93e2db3f.b3c81302.png" alt=""></p><ol start="4"><li>æŒæ¡æ›¿æ¢æ–‡æœ¬çš„æ–¹æ³•åï¼Œæˆ‘ä»¬å¯ä»¥æŠŠWordæ¨¡æ¿ç¬¬ä¸€éƒ¨åˆ†éœ€è¦æ›¿æ¢çš„å†…å®¹éƒ½æ›¿æ¢æˆæ¨¡æ¿å˜é‡ï¼š <img src="/assets/ab3bee0d.23769e55.png" alt=""></li></ol><p>Wordæ¨¡æ¿ä¸­è¡¨æ ¼æ•°æ®çš„å¤„ç† è¡¨æ ¼ä¸­çš„æ•°æ®å®è´¨ä¸Šå°±æ˜¯å¯¹é›†åˆçš„éå†ã€‚</p><p>è¡¨æ ¼æ•°æ®çš„å¤„ç†å…¶å®å’Œä¸Šé¢å¯¹æ–‡æœ¬å†…å®¹çš„å¤„ç†æ˜¯ç±»ä¼¼çš„ï¼Œåªä¸è¿‡è¦åœ¨Wordæ¨¡æ¿ä¸­åŠ ä¸Šé›†åˆçš„å˜é‡ï¼ŒJavaä»£ç ä¸­ä¹Ÿè¦æœ‰å¯¹é›†åˆè¿›è¡Œç‰¹å¯¹çš„å¤„ç†(è¿™ä¸ªåœ¨åé¢çš„ä»£ç å±•ç¤ºéƒ¨åˆ†ä¼šè¯´)ã€‚</p><p>å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>é€‰å®šè¡¨æ ¼ä¸­è¦æ›¿æ¢çš„æ–‡æœ¬ï¼Œç„¶åé”®ç›˜ä½¿ç”¨ Ctrl + F9 ç»„åˆé”®å°†å…¶è®¾ç½®ä¸ºåŸŸï¼Œæ¥ç€é¼ æ ‡å³é”®é€‰æ‹©ã€ç¼–è¾‘åŸŸ(E)...ã€‘ï¼š <img src="/assets/0f9c4618.3d88c1e8.png" alt=""></p></li><li><p>åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ï¼Œç±»åˆ«é€‰æ‹©â€œé‚®ä»¶åˆå¹¶â€ï¼ŒåŸŸåé€‰æ‹© &quot;MergeField&quot;ï¼ŒåŸŸå±æ€§ä¸­çš„åŸŸåå¡«å…¥æ¨¡ç‰ˆè¡¨è¾¾å¼${goods.num}ï¼Œç‚¹å‡»ã€ç¡®å®šã€‘æŒ‰é’®ï¼›</p></li><li><p>é‡å¤æ­¥éª¤2ï¼Œæ›¿æ¢è¡¨æ ¼ä¸­çš„å…¶ä»–æ–‡æœ¬å†…å®¹ï¼š <img src="/assets/6df8b41c.481675a0.png" alt=""></p></li></ol><p><strong>åå°ä»£ç </strong></p><p>æ·»åŠ ä¾èµ–åˆ°pom.xmlæ–‡ä»¶</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;
    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;
    &lt;version&gt;4.1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls&lt;/artifactId&gt;
    &lt;version&gt;2.6.0&lt;/version&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
            &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.jxls&lt;/groupId&gt;
    &lt;artifactId&gt;jxls-poi&lt;/artifactId&gt;
    &lt;version&gt;1.2.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.core&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.document.docx&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;
    &lt;artifactId&gt;fr.opensagres.xdocreport.template.freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.0.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;
    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;
    &lt;version&gt;2.3.23&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-io&lt;/groupId&gt;
    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;
    &lt;version&gt;2.5&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¼–å†™Javaä»£ç </p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Controller</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RequestMapping</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>renren<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">Goods</span></span><span class="token punctuation">;</span>
 
<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/word&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WordTest</span> <span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//è·å–Wordæ¨¡æ¿ï¼Œæ¨¡æ¿å­˜æ”¾è·¯å¾„åœ¨é¡¹ç›®çš„resourcesç›®å½•ä¸‹</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/æ¨¡æ¿.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ³¨å†Œxdocreportå®ä¾‹å¹¶åŠ è½½FreeMarkeræ¨¡æ¿å¼•æ“</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span>     
                               <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºxdocreportä¸Šä¸‹æ–‡å¯¹è±¡</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//åˆ›å»ºè¦æ›¿æ¢çš„æ–‡æœ¬å˜é‡</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;city&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;åŒ—äº¬å¸‚&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;startDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2020-09-17&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;endDate&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;2020-10-16&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;totCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">3638763</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;totAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;6521&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;onCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">2874036</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;onAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4768&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;offCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">764727</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;offAmt&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;1753&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;typeCnt&quot;</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> goodsList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;è‡­ç¾æ¯è‚¤&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">675512</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;589&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;å¥³è£…&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">602145</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;651&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">587737</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods3<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;866&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;å®¶å…·å®¶è£…&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">551193</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods4<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;783&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setNum</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setType</span><span class="token punctuation">(</span><span class="token string">&quot;é£Ÿç‰©é¥®å“&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setSv</span><span class="token punctuation">(</span><span class="token number">528604</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods5<span class="token punctuation">.</span><span class="token function">setSa</span><span class="token punctuation">(</span><span class="token string">&quot;405&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods3<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods4<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>goods5<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> goodsList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//åˆ›å»ºå­—æ®µå…ƒæ•°æ®</span>
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//Wordæ¨¡æ¿ä¸­çš„è¡¨æ ¼æ•°æ®å¯¹åº”çš„é›†åˆç±»å‹</span>
        fm<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Goods</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       
        <span class="token comment">//è¾“å‡ºåˆ°æœ¬åœ°ç›®å½•</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://å•†å“é”€å”®æŠ¥è¡¨.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Wordæ¨¡æ¿ä¸­ç”Ÿæˆåºå· ç»™è¡¨æ ¼æ•°æ®æ·»åŠ åºå·æ˜¯é€šè¿‡åå°ä»£ç ç”Ÿæˆçš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„&quot;goods1.setNum(1)&quot;è¿™æ®µä»£ç ï¼Œå…¶å®ä¹Ÿå¯ä»¥åœ¨Wordæ¨¡æ¿ä¸­è®¾ç½®å¯¹åº”çš„åŸŸå˜é‡æ¥å®ç°åºå·çš„å¡«å……ã€‚</p><p>è¯­æ³•å¦‚ä¸‹ï¼š</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>@before-row[#list sequence as item]
item?index
@after-row[/#list]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åœ¨è¡¨æ ¼ä¸­æ·»åŠ ä¸Šé¢çš„è¡¨è¾¾å¼ï¼ŒXDocReportå°±ä¼šè‡ªåŠ¨è§£æå¹¶ç”Ÿæˆåºå·ï¼Œè¡¨æ ¼ä¸­çš„å…¶ä»–å­—æ®µä¹Ÿéœ€è¦è¿›è¡Œç›¸åº”çš„æ”¹åŠ¨:</p><p><img src="/assets/da12427e.9d165b1e.png" alt=""></p><p>æç¤ºï¼š</p><ol><li>åºå·çš„è¡¨è¾¾å¼è¦æ‹†æˆä¸‰ä¸ªåŸŸï¼Œå¦‚ä¸‹å›¾ï¼Œè¦æŠŠè¿™ä¸‰éƒ¨åˆ†åˆ†åˆ«è®¾ç½®æˆåŸŸï¼›</li></ol><p><img src="/assets/c7756d0c.37ac0e1e.png" alt=""></p><pre><code> è®¾ç½®å®Œæˆçš„ç»“æœå‚è€ƒä¸Šé¢è¡¨æ ¼ä¸­çš„åºå·è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼ä¸­&quot;item?index+1&quot;æ˜¯å› ä¸ºåºå·æ˜¯ä»0å¼€å§‹çš„ï¼Œæ‰€ä»¥è¦åŠ 1ï¼›
</code></pre><ol start="2"><li><p>è¡¨æ ¼ä¸­é™¤åºå·çš„åˆ—éœ€è¦æ”¹æˆitem.xxxè€Œä¸æ˜¯ä¹‹å‰çš„goods.xxx: <img src="/assets/d8537bb3.9f45231a.png" alt=""></p></li><li><p>ç”Ÿæˆæ•ˆæœå¦‚ä¸‹: <img src="/assets/8711d414.94bafaf6.png" alt=""></p></li></ol><p>å»ºè®®ï¼šåºå·æœ€å¥½åœ¨åå°ç”Ÿæˆï¼Œç”¨åºå·è¡¨è¾¾å¼ç”Ÿæˆçš„åºå·åˆ—ä¼šå ç”¨æ¯”è¾ƒå¤§çš„ç©ºé—´ï¼Œå¯¹èµ„æºæœ‰æ‰€æµªè´¹ã€‚</p><p>è¡¥å……</p><ol><li>JavaWebé¡¹ç›®ä¸­é€šå¸¸æ˜¯é€šè¿‡æµè§ˆå™¨ä¸‹è½½çš„æ–¹å¼æ¥ä¸‹è½½Wordæ–‡æ¡£ï¼Œæ­¤æ—¶åªéœ€è¦æŠŠä¹‹å‰ä¸‹è½½åˆ°æœ¬åœ°çš„ä»£ç æ”¹æˆæµè§ˆå™¨ç«¯ä¸‹è½½çš„ä»£ç å³å¯ï¼š</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>//è¾“å‡ºåˆ°æœ¬åœ°ç›®å½•
//FileOutputStream out = new FileOutputStream(new File(&quot;D://å•†å“é”€å”®æŠ¥è¡¨.docx&quot;));
//report.process(context, out);
 
//æµè§ˆå™¨ç«¯ä¸‹è½½
response.setCharacterEncoding(&quot;utf-8&quot;);  
response.setContentType(&quot;application/msword&quot;);  
String fileName = &quot;å•†å“é”€å”®æŠ¥è¡¨.docx&quot;;  
response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;filename=&quot;  
				    .concat(String.valueOf(URLEncoder.encode(fileName, &quot;UTF-8&quot;))));  
report.process(context, response.getOutputStream());
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>Wordæ¨¡æ¿ä¸­çš„è¡¨æ ¼çš„é•¿åº¦æœ€å¥½å……æ»¡Wordæ–‡æ¡£çš„å·¦å³ä¸¤è¾¹ï¼Œå¦åˆ™å¦‚æœè¡¨æ ¼ä¸‹é¢è¿˜æœ‰å…¶ä»–æ–‡æœ¬å†…å®¹ï¼Œä¸‹é¢çš„æ–‡æœ¬å†…å®¹ä¼šè‡ªåŠ¨å¡«å……åˆ°è¡¨æ ¼çš„ç¼éš™å¤„ï¼Œè€Œä¸”ä¼šå¯¹ä¸‹é¢çš„æ–‡æœ¬å†…å®¹è¿›è¡Œè¦†ç›–ã€‚</li></ol><p><strong>åŠ é¤</strong> å…¶å®ï¼Œå¯¼å‡ºWordæ¨¡æ¿ï¼Œä¸Šé¢çš„æ¨¡æ¿å’Œä»£ç å·²ç»å¤Ÿç”¨äº†ï¼Œä½†ä¹Ÿæœ‰å°‘æ•°æ¨¡æ¿éœ€è¦æ·»åŠ å›¾ç‰‡å’Œå›¾å½¢(æ¯”å¦‚é¥¼çŠ¶å›¾)ã€‚</p><p><strong>åˆ¶ä½œå›¾ç‰‡</strong></p><p>å›¾ç‰‡çš„ç”Ÿæˆä¸ä½¿ç”¨ç¼–è¾‘åŸŸï¼Œä½¿ç”¨æ¨¡æ¿å›¾ç‰‡å’ŒWordçš„ä¹¦ç­¾åŠŸèƒ½ï¼Œè€Œä¸”éœ€è¦åœ¨å…ƒæ•°æ®ä¸­åŠ å…¥å›¾ç‰‡ç±»å‹çš„ä»£ç ï¼Œä»¥ä¸‹ä¸ºå…·ä½“æ­¥éª¤ï¼š</p><ol><li>åœ¨Wordæ¨¡ç‰ˆä¸­éœ€è¦æ’å…¥å›¾ç‰‡çš„ä½ç½®æ’å…¥ä¸€å¼ æ¨¡ç‰ˆå›¾ç‰‡ï¼Œç„¶åé¼ æ ‡å•å‡»æ¨¡æ¿å›¾ç‰‡æ’å…¥ä¸€ä¸ªä¹¦ç­¾ï¼Œè®¾ç½®ä¹¦ç­¾åç§°ï¼Œæ¯”å¦‚img1ï¼Œ æœ€åç‚¹å‡»ã€æ·»åŠ ã€‘æŒ‰é’®:</li></ol><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>![](../../images/.ç”Ÿæˆword_images/19b0a592.png)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>å¦‚æœéœ€è¦æ’å…¥å¤šä¸ªå›¾ç‰‡ï¼Œå°±åœ¨éœ€è¦æ’å…¥å›¾ç‰‡çš„ä½ç½®æ’å…¥å¤šä¸ªæ¨¡æ¿å›¾ç‰‡å¹¶æ’å…¥ä¹¦ç­¾è®¾ç½®å¯¹åº”çš„ä¹¦ç­¾åç§°å³å¯ï¼Œåå°ä»£ç å¦‚ä¸‹ï¼š</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ImgTest</span> <span class="token punctuation">{</span>
 
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWordForImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWordForImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//è·å–Wordæ¨¡æ¿ï¼Œæ¨¡æ¿å­˜æ”¾è·¯å¾„åœ¨é¡¹ç›®çš„resourcesç›®å½•ä¸‹</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/å›¾ç‰‡.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ³¨å†Œxdocreportå®ä¾‹å¹¶åŠ è½½FreeMarkeræ¨¡æ¿å¼•æ“</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span> 
                               <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºxdocreportä¸Šä¸‹æ–‡å¯¹è±¡</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å…ƒæ•°æ®ä¸­åŠ å…¥å›¾ç‰‡</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;img1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;img2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//è·å–å›¾ç‰‡</span>
        <span class="token class-name">InputStream</span> img1 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/11.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">InputStream</span> img2 <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/33.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//æŠŠå›¾ç‰‡æ·»åŠ åˆ°ä¸Šä¸‹æ–‡å¯¹è±¡</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;img1&quot;</span><span class="token punctuation">,</span> img1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;img2&quot;</span><span class="token punctuation">,</span> img2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//è¾“å‡ºåˆ°æœ¬åœ°ç›®å½•</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://å›¾ç‰‡æŠ¥è¡¨.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>å¯¼å‡ºæ•ˆæœå¦‚ä¸‹ï¼š</li></ol><p>åˆ¶ä½œå›¾å½¢ <img src="/assets/bd56e760.db8a8d32.png" alt=""> è¦åœ¨Wordæ–‡æ¡£ä¸­ç”ŸæˆæŸ±çŠ¶å›¾ã€é¥¼çŠ¶å›¾ç­‰å›¾å½¢ï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­å¼•å…¥ç¬¬ä¸‰æ–¹ç»˜å›¾å·¥å…·ï¼Œåœ¨è¿™é‡Œä½¿ç”¨xchartæ¥æ¼”ç¤ºåœ¨Wordä¸­ç”Ÿæˆé¥¼çŠ¶å›¾å›¾å½¢ã€‚</p><p>ç”Ÿæˆé¥¼çŠ¶å›¾å’Œç”Ÿæˆå›¾ç‰‡çš„æ–¹æ³•å¾ˆç±»ä¼¼ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>åœ¨Wordæ¨¡ç‰ˆä¸­éœ€è¦æ’å…¥å›¾ç‰‡çš„ä½ç½®æ’å…¥ä¸€å¼ æ¨¡ç‰ˆå›¾ç‰‡ï¼Œç„¶åé¼ æ ‡å•å‡»æ¨¡æ¿å›¾ç‰‡æ’å…¥ä¸€ä¸ªä¹¦ç­¾ï¼Œè®¾ç½®ä¹¦ç­¾åç§°ï¼Œæ¯”å¦‚chartï¼Œæœ€åç‚¹å‡»ã€æ·»åŠ ã€‘æŒ‰é’®: <img src="/assets/c9fa7e24.a8347be1.png" alt=""></p></li><li><p>ç¼–å†™ä»£ç :</p></li></ol><p>2.1 åœ¨pom.xmlæ–‡ä»¶ä¸­æ·»åŠ xchartçš„ä¾èµ–:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>&lt;dependency&gt;
	&lt;groupId&gt;org.knowm.xchart&lt;/groupId&gt;
	&lt;artifactId&gt;xchart&lt;/artifactId&gt;
	&lt;version&gt;3.5.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.2 åå°ä»£ç :</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>tzsj<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
 
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">File</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FileOutputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">InputStream</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">BitmapEncoder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">PieChart</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>knowm<span class="token punctuation">.</span>xchart<span class="token punctuation">.</span></span><span class="token class-name">PieChartBuilder</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">XDocReportException</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span></span><span class="token class-name">IXDocReport</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>images<span class="token punctuation">.</span></span><span class="token class-name">ByteArrayImageProvider</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>document<span class="token punctuation">.</span>registry<span class="token punctuation">.</span></span><span class="token class-name">XDocReportRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">IContext</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span></span><span class="token class-name">TemplateEngineKind</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">fr<span class="token punctuation">.</span>opensagres<span class="token punctuation">.</span>xdocreport<span class="token punctuation">.</span>template<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span></span><span class="token class-name">FieldsMetadata</span></span><span class="token punctuation">;</span>
 
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ChartTest</span> <span class="token punctuation">{</span>
 
	<span class="token annotation punctuation">@Test</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token function">generateWordForChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generateWordForChart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">XDocReportException</span> <span class="token punctuation">{</span>
		<span class="token comment">//è·å–Wordæ¨¡æ¿ï¼Œæ¨¡æ¿å­˜æ”¾è·¯å¾„åœ¨é¡¹ç›®çš„resourcesç›®å½•ä¸‹</span>
	    <span class="token class-name">InputStream</span> ins <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;/é¥¼å›¾.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æ³¨å†Œxdocreportå®ä¾‹å¹¶åŠ è½½FreeMarkeræ¨¡æ¿å¼•æ“</span>
        <span class="token class-name">IXDocReport</span> report <span class="token operator">=</span> <span class="token class-name">XDocReportRegistry</span><span class="token punctuation">.</span><span class="token function">getRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">loadReport</span><span class="token punctuation">(</span>ins<span class="token punctuation">,</span>                 
                                 <span class="token class-name">TemplateEngineKind<span class="token punctuation">.</span>Freemarker</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//åˆ›å»ºxdocreportä¸Šä¸‹æ–‡å¯¹è±¡</span>
        <span class="token class-name">IContext</span> context <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">FieldsMetadata</span> fm <span class="token operator">=</span> report<span class="token punctuation">.</span><span class="token function">createFieldsMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å…ƒæ•°æ®ä¸­åŠ å…¥å›¾ç‰‡</span>
        fm<span class="token punctuation">.</span><span class="token function">addFieldAsImage</span><span class="token punctuation">(</span><span class="token string">&quot;chart&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">PieChart</span> chart <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PieChartBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token number">800</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token number">620</span><span class="token punctuation">)</span>
                                <span class="token punctuation">.</span><span class="token function">title</span><span class="token punctuation">(</span><span class="token string">&quot;é”€å”®é¥¼å›¾&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//ç»™é¥¼å›¾è®¾ç½®å¯¹åº”çš„å€¼</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;è‡­ç¾æ¯è‚¤&quot;</span><span class="token punctuation">,</span> <span class="token number">589</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;å¥³è£…&quot;</span><span class="token punctuation">,</span> <span class="token number">651</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰‹æœº&quot;</span><span class="token punctuation">,</span> <span class="token number">866</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;å®¶å±…å®¶è£…&quot;</span><span class="token punctuation">,</span> <span class="token number">783</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chart<span class="token punctuation">.</span><span class="token function">addSeries</span><span class="token punctuation">(</span><span class="token string">&quot;é£Ÿç‰©é¥®å“&quot;</span><span class="token punctuation">,</span> <span class="token number">405</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//ç”Ÿæˆé¥¼å›¾</span>
        <span class="token class-name">ByteArrayOutputStream</span> baos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">BitmapEncoder</span><span class="token punctuation">.</span><span class="token function">saveBitmap</span><span class="token punctuation">(</span>chart<span class="token punctuation">,</span> baos<span class="token punctuation">,</span> <span class="token class-name">BitmapEncoder<span class="token punctuation">.</span>BitmapFormat</span><span class="token punctuation">.</span><span class="token constant">JPG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//æŠŠé¥¼å›¾æ·»åŠ åˆ°ä¸Šä¸‹æ–‡å¯¹è±¡</span>
        context<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;chart&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayImageProvider</span><span class="token punctuation">(</span>baos<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">//è¾“å‡ºåˆ°æœ¬åœ°ç›®å½•</span>
        <span class="token class-name">FileOutputStream</span> out <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D://é¥¼å›¾æŠ¥è¡¨.docx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        report<span class="token punctuation">.</span><span class="token function">process</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> out<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
 
 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>å¯¼å‡ºæ•ˆæœå¦‚ä¸‹:</li></ol><p><img src="/assets/6a2c9661.e3612376.png" alt=""></p><p>æ€»ç»“ è¿™å°±æ˜¯ç”¨Javaè¯­è¨€å®ç°ï¼Œç»“åˆXDocReportå’ŒFreeMarkeræ¨¡æ¿å¼•æ“ç”ŸæˆWordæ–‡æ¡£çš„æ–¹æ³•ã€‚å¸Œæœ›èƒ½ç»™è‡´åŠ›äºå¼€å‘çš„å°ä¼™ä¼´å¸¦æ¥ä¸€ä¸ä¸å¸®åŠ©ã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/easywhx/learning/edit/main/note/Java/æ–¹æ¡ˆ/ç”Ÿæˆword.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: wanhx@xports.cn">wanhx</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/note/Java/%E6%96%B9%E6%A1%88/%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8E%A5%E5%8F%A3%E5%B9%82%E7%AD%89%E6%80%A7.html" class="nav-link prev" aria-label="æ¥å£å¹‚ç­‰"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->æ¥å£å¹‚ç­‰</div></a><!----></nav><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.4d667c68.js" defer></script>
  </body>
</html>
